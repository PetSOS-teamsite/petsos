import{r as O,j as e,ar as te,as as ie,at as I,aC as $,s as E,a as z,h as R,g as M,B as p,F as V,w as o,x,y as h,z as u,I as b,A as j,a1 as B,a2 as q,a3 as F,a4 as Z,a5 as c,C as ae,b as re,a7 as Q,G as S,H as P}from"./index-DwyYRZ5p.js";import{u as A}from"./useMutation-qDWMbsfK.js";import{D as G,f as U,a as J,b as W,c as X}from"./dialog-DiajIIgm.js";import{T as Y,a as _,b as K,c as d,d as ee,e as l}from"./table-DnuG7NNe.js";import{a as de,b as le,c as ce}from"./schema-CJxOeGTw.js";import{P as se}from"./plus-n-JqKbGd.js";import{S as H}from"./square-pen-ByPSUV_e.js";import{T as k}from"./trash-2-CJDXV07h.js";import"./index-mUsBoYTb.js";const oe=de.extend({code:E().min(1,"Country code is required").max(3),nameEn:E().min(1,"English name is required"),phonePrefix:E().min(1,"Phone prefix is required")}),xe=le.extend({code:E().min(1,"Region code is required"),nameEn:E().min(1,"English name is required"),nameZh:E().min(1,"Chinese name is required"),countryCode:E().min(1,"Country is required")}),he=ce.extend({species:E().min(1,"Species is required"),breedEn:E().min(1,"Breed name is required")});function Se(){const[a,T]=O.useState("countries");return e.jsxs("div",{className:"container mx-auto p-6 max-w-7xl","data-testid":"page-admin-config",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-red-600","data-testid":"text-page-title",children:"Configuration Management"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Manage countries, regions, and pet breeds"})]}),e.jsxs(te,{value:a,onValueChange:T,children:[e.jsxs(ie,{className:"mb-6",children:[e.jsx(I,{value:"countries","data-testid":"tab-countries",children:"Countries"}),e.jsx(I,{value:"regions","data-testid":"tab-regions",children:"Regions"}),e.jsx(I,{value:"breeds","data-testid":"tab-breeds",children:"Pet Breeds"})]}),e.jsx($,{value:"countries",children:e.jsx(ue,{})}),e.jsx($,{value:"regions",children:e.jsx(je,{})}),e.jsx($,{value:"breeds",children:e.jsx(me,{})})]})]})}function ue(){const{toast:a}=z(),[T,m]=O.useState(!1),[g,v]=O.useState(null),{data:f=[],isLoading:L}=R({queryKey:["/api/countries"]}),r=M({resolver:Q(oe),defaultValues:{code:"",nameEn:"",nameZh:"",phonePrefix:"",flag:"",active:!0}}),t=A({mutationFn:s=>S("POST","/api/countries",s),onSuccess:()=>{P.invalidateQueries({queryKey:["/api/countries"]}),m(!1),r.reset(),a({title:"Country created successfully"})},onError:s=>{a({title:"Error creating country",description:s.message||"An error occurred",variant:"destructive"})}}),N=A({mutationFn:({id:s,data:n})=>S("PATCH",`/api/countries/${s}`,n),onSuccess:()=>{P.invalidateQueries({queryKey:["/api/countries"]}),m(!1),v(null),r.reset(),a({title:"Country updated successfully"})},onError:s=>{a({title:"Error updating country",description:s.message||"An error occurred",variant:"destructive"})}}),C=A({mutationFn:s=>S("DELETE",`/api/countries/${s}`),onSuccess:()=>{P.invalidateQueries({queryKey:["/api/countries"]}),a({title:"Country deleted successfully"})},onError:s=>{a({title:"Error deleting country",description:s.message||"An error occurred",variant:"destructive"})}}),y=s=>{s?(v(s),r.reset({code:s.code,nameEn:s.nameEn,nameZh:s.nameZh||"",phonePrefix:s.phonePrefix,flag:s.flag||"",active:s.active})):(v(null),r.reset({code:"",nameEn:"",nameZh:"",phonePrefix:"",flag:"",active:!0})),m(!0)},D=s=>{const n={...s,active:!!s.active};g?N.mutate({id:g.id,data:n}):t.mutate(n)},w=t.isPending||N.isPending;return L?e.jsx("div",{children:"Loading..."}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold","data-testid":"text-countries-title",children:["Countries (",f.length,")"]}),e.jsxs(G,{open:T,onOpenChange:m,children:[e.jsx(U,{asChild:!0,children:e.jsxs(p,{onClick:()=>y(),"data-testid":"button-add-country",children:[e.jsx(se,{className:"mr-2 h-4 w-4"})," Add Country"]})}),e.jsxs(J,{children:[e.jsx(W,{children:e.jsx(X,{children:g?"Edit Country":"Add Country"})}),e.jsx(V,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(D),className:"space-y-4",children:[e.jsx(o,{control:r.control,name:"code",render:({field:s})=>e.jsxs(x,{children:[e.jsx(h,{children:"Country Code"}),e.jsx(u,{children:e.jsx(b,{placeholder:"HK",...s,"data-testid":"input-country-code"})}),e.jsx(j,{})]})}),e.jsx(o,{control:r.control,name:"nameEn",render:({field:s})=>e.jsxs(x,{children:[e.jsx(h,{children:"Name (English)"}),e.jsx(u,{children:e.jsx(b,{placeholder:"Hong Kong",...s,"data-testid":"input-country-name-en"})}),e.jsx(j,{})]})}),e.jsx(o,{control:r.control,name:"nameZh",render:({field:s})=>e.jsxs(x,{children:[e.jsx(h,{children:"Name (Chinese)"}),e.jsx(u,{children:e.jsx(b,{placeholder:"é¦™æ¸¯",...s,"data-testid":"input-country-name-zh"})}),e.jsx(j,{})]})}),e.jsx(o,{control:r.control,name:"phonePrefix",render:({field:s})=>e.jsxs(x,{children:[e.jsx(h,{children:"Phone Prefix"}),e.jsx(u,{children:e.jsx(b,{placeholder:"+852",...s,"data-testid":"input-country-phone"})}),e.jsx(j,{})]})}),e.jsx(o,{control:r.control,name:"flag",render:({field:s})=>e.jsxs(x,{children:[e.jsx(h,{children:"Flag Emoji"}),e.jsx(u,{children:e.jsx(b,{placeholder:"ðŸ‡­ðŸ‡°",...s,"data-testid":"input-country-flag"})}),e.jsx(j,{})]})}),e.jsx(o,{control:r.control,name:"active",render:({field:s})=>e.jsxs(x,{children:[e.jsx(h,{children:"Status"}),e.jsxs(B,{onValueChange:n=>s.onChange(n==="true"),value:String(s.value),children:[e.jsx(u,{children:e.jsx(q,{"data-testid":"select-country-status",children:e.jsx(F,{})})}),e.jsxs(Z,{children:[e.jsx(c,{value:"true",children:"Active"}),e.jsx(c,{value:"false",children:"Inactive"})]})]}),e.jsx(j,{})]})}),e.jsx(p,{type:"submit",className:"w-full",disabled:w,"data-testid":"button-submit-country",children:w?"Saving...":g?"Update":"Create"})]})})]})]})]}),e.jsx("div",{className:"block md:hidden space-y-4",children:f.map(s=>e.jsx(ae,{"data-testid":`card-country-${s.code}`,children:e.jsxs(re,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:s.flag}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:s.nameEn}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.nameZh})]})]}),e.jsx("span",{className:`text-sm ${s.active?"text-green-600":"text-gray-400"}`,children:s.active?"Active":"Inactive"})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-600 dark:text-gray-400 mb-3",children:[e.jsxs("span",{children:["Code: ",s.code]}),e.jsxs("span",{children:["Phone: ",s.phonePrefix]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(p,{variant:"outline",size:"sm",onClick:()=>y(s),className:"flex-1",children:[e.jsx(H,{className:"h-4 w-4 mr-1"})," Edit"]}),e.jsxs(p,{variant:"destructive",size:"sm",onClick:()=>C.mutate(s.id),disabled:C.isPending,className:"flex-1",children:[e.jsx(k,{className:"h-4 w-4 mr-1"})," Delete"]})]})]})},s.id))}),e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs(Y,{children:[e.jsx(_,{children:e.jsxs(K,{children:[e.jsx(d,{children:"Flag"}),e.jsx(d,{children:"Code"}),e.jsx(d,{children:"Name (EN)"}),e.jsx(d,{children:"Name (ZH)"}),e.jsx(d,{children:"Phone Prefix"}),e.jsx(d,{children:"Status"}),e.jsx(d,{children:"Actions"})]})}),e.jsx(ee,{children:f.map(s=>e.jsxs(K,{"data-testid":`row-country-${s.code}`,children:[e.jsx(l,{children:s.flag}),e.jsx(l,{children:s.code}),e.jsx(l,{children:s.nameEn}),e.jsx(l,{children:s.nameZh}),e.jsx(l,{children:s.phonePrefix}),e.jsx(l,{children:e.jsx("span",{className:s.active?"text-green-600":"text-gray-400",children:s.active?"Active":"Inactive"})}),e.jsx(l,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{variant:"outline",size:"sm",onClick:()=>y(s),"data-testid":`button-edit-country-${s.code}`,children:e.jsx(H,{className:"h-4 w-4"})}),e.jsx(p,{variant:"destructive",size:"sm",onClick:()=>C.mutate(s.id),disabled:C.isPending,"data-testid":`button-delete-country-${s.code}`,children:e.jsx(k,{className:"h-4 w-4"})})]})})]},s.id))})]})})]})}function je(){const{toast:a}=z(),[T,m]=O.useState(!1),[g,v]=O.useState(null),{data:f=[],isLoading:L}=R({queryKey:["/api/regions"]}),{data:r=[]}=R({queryKey:["/api/countries"]}),t=M({resolver:Q(xe),defaultValues:{code:"",nameEn:"",nameZh:"",countryCode:"HK",active:!0}}),N=A({mutationFn:s=>S("POST","/api/regions",s),onSuccess:()=>{P.invalidateQueries({queryKey:["/api/regions"]}),m(!1),t.reset(),a({title:"Region created successfully"})},onError:s=>{a({title:"Error creating region",description:s.message||"An error occurred",variant:"destructive"})}}),C=A({mutationFn:({id:s,data:n})=>S("PATCH",`/api/regions/${s}`,n),onSuccess:()=>{P.invalidateQueries({queryKey:["/api/regions"]}),m(!1),v(null),t.reset(),a({title:"Region updated successfully"})},onError:s=>{a({title:"Error updating region",description:s.message||"An error occurred",variant:"destructive"})}}),y=s=>{var n;if(!s&&r.length===0){a({title:"Please wait",description:"Loading countries...",variant:"destructive"});return}s?(v(s),t.reset({code:s.code,nameEn:s.nameEn,nameZh:s.nameZh,countryCode:s.countryCode,active:s.active})):(v(null),t.reset({code:"",nameEn:"",nameZh:"",countryCode:((n=r[0])==null?void 0:n.code)||"HK",active:!0})),m(!0)},D=s=>{const n={...s,active:!!s.active};g?C.mutate({id:g.id,data:n}):N.mutate(n)},w=N.isPending||C.isPending;return L?e.jsx("div",{children:"Loading..."}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold","data-testid":"text-regions-title",children:["Regions (",f.length,")"]}),e.jsxs(G,{open:T,onOpenChange:m,children:[e.jsx(U,{asChild:!0,children:e.jsxs(p,{onClick:()=>y(),"data-testid":"button-add-region",children:[e.jsx(se,{className:"mr-2 h-4 w-4"})," Add Region"]})}),e.jsxs(J,{children:[e.jsx(W,{children:e.jsx(X,{children:g?"Edit Region":"Add Region"})}),e.jsx(V,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(D),className:"space-y-4",children:[e.jsx(o,{control:t.control,name:"code",render:({field:s})=>e.jsxs(x,{children:[e.jsx(h,{children:"Region Code"}),e.jsx(u,{children:e.jsx(b,{placeholder:"HKI",...s,"data-testid":"input-region-code"})}),e.jsx(j,{})]})}),e.jsx(o,{control:t.control,name:"nameEn",render:({field:s})=>e.jsxs(x,{children:[e.jsx(h,{children:"Name (English)"}),e.jsx(u,{children:e.jsx(b,{placeholder:"Hong Kong Island",...s,"data-testid":"input-region-name-en"})}),e.jsx(j,{})]})}),e.jsx(o,{control:t.control,name:"nameZh",render:({field:s})=>e.jsxs(x,{children:[e.jsx(h,{children:"Name (Chinese)"}),e.jsx(u,{children:e.jsx(b,{placeholder:"é¦™æ¸¯å³¶",...s,"data-testid":"input-region-name-zh"})}),e.jsx(j,{})]})}),e.jsx(o,{control:t.control,name:"countryCode",render:({field:s})=>e.jsxs(x,{children:[e.jsx(h,{children:"Country"}),e.jsxs(B,{onValueChange:s.onChange,value:s.value,children:[e.jsx(u,{children:e.jsx(q,{"data-testid":"select-region-country",children:e.jsx(F,{})})}),e.jsx(Z,{children:r.map(n=>e.jsxs(c,{value:n.code,children:[n.flag," ",n.nameEn]},n.code))})]}),e.jsx(j,{})]})}),e.jsx(o,{control:t.control,name:"active",render:({field:s})=>e.jsxs(x,{children:[e.jsx(h,{children:"Status"}),e.jsxs(B,{onValueChange:n=>s.onChange(n==="true"),value:String(s.value),children:[e.jsx(u,{children:e.jsx(q,{"data-testid":"select-region-status",children:e.jsx(F,{})})}),e.jsxs(Z,{children:[e.jsx(c,{value:"true",children:"Active"}),e.jsx(c,{value:"false",children:"Inactive"})]})]}),e.jsx(j,{})]})}),e.jsx(p,{type:"submit",className:"w-full",disabled:w,"data-testid":"button-submit-region",children:w?"Saving...":g?"Update":"Create"})]})})]})]})]}),e.jsxs(Y,{children:[e.jsx(_,{children:e.jsxs(K,{children:[e.jsx(d,{children:"Code"}),e.jsx(d,{children:"Name (EN)"}),e.jsx(d,{children:"Name (ZH)"}),e.jsx(d,{children:"Country"}),e.jsx(d,{children:"Status"}),e.jsx(d,{children:"Actions"})]})}),e.jsx(ee,{children:f.map(s=>{const n=r.find(i=>i.code===s.countryCode);return e.jsxs(K,{"data-testid":`row-region-${s.code}`,children:[e.jsx(l,{children:s.code}),e.jsx(l,{children:s.nameEn}),e.jsx(l,{children:s.nameZh}),e.jsxs(l,{children:[n==null?void 0:n.flag," ",n==null?void 0:n.nameEn]}),e.jsx(l,{children:e.jsx("span",{className:s.active?"text-green-600":"text-gray-400",children:s.active?"Active":"Inactive"})}),e.jsx(l,{children:e.jsx(p,{variant:"outline",size:"sm",onClick:()=>y(s),"data-testid":`button-edit-region-${s.code}`,children:e.jsx(H,{className:"h-4 w-4"})})})]},s.id)})})]})]})}function me(){const{toast:a}=z(),[T,m]=O.useState(!1),[g,v]=O.useState(null),{data:f=[],isLoading:L}=R({queryKey:["/api/pet-breeds"]}),{data:r=[]}=R({queryKey:["/api/countries"]}),t=M({resolver:Q(he),defaultValues:{species:"dog",breedEn:"",breedZh:"",countryCode:null,isCommon:!0,active:!0}}),N=A({mutationFn:n=>S("POST","/api/pet-breeds",n),onSuccess:()=>{P.invalidateQueries({queryKey:["/api/pet-breeds"]}),m(!1),t.reset(),a({title:"Pet breed created successfully"})},onError:n=>{a({title:"Error creating breed",description:n.message||"An error occurred",variant:"destructive"})}}),C=A({mutationFn:({id:n,data:i})=>S("PATCH",`/api/pet-breeds/${n}`,i),onSuccess:()=>{P.invalidateQueries({queryKey:["/api/pet-breeds"]}),m(!1),v(null),t.reset(),a({title:"Pet breed updated successfully"})},onError:n=>{a({title:"Error updating breed",description:n.message||"An error occurred",variant:"destructive"})}}),y=A({mutationFn:n=>S("DELETE",`/api/pet-breeds/${n}`),onSuccess:()=>{P.invalidateQueries({queryKey:["/api/pet-breeds"]}),a({title:"Pet breed deleted successfully"})},onError:n=>{a({title:"Error deleting breed",description:n.message||"An error occurred",variant:"destructive"})}}),D=n=>{n?(v(n),t.reset({species:n.species,breedEn:n.breedEn,breedZh:n.breedZh||"",countryCode:n.countryCode,isCommon:n.isCommon,active:n.active})):(v(null),t.reset({species:"dog",breedEn:"",breedZh:"",countryCode:null,isCommon:!0,active:!0})),m(!0)},w=n=>{const i={...n,countryCode:n.countryCode||null,isCommon:!!n.isCommon,active:!!n.active};g?C.mutate({id:g.id,data:i}):N.mutate(i)},s=N.isPending||C.isPending;return L?e.jsx("div",{children:"Loading..."}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold","data-testid":"text-breeds-title",children:["Pet Breeds (",f.length,")"]}),e.jsxs(G,{open:T,onOpenChange:m,children:[e.jsx(U,{asChild:!0,children:e.jsxs(p,{onClick:()=>D(),"data-testid":"button-add-breed",children:[e.jsx(se,{className:"mr-2 h-4 w-4"})," Add Breed"]})}),e.jsxs(J,{children:[e.jsx(W,{children:e.jsx(X,{children:g?"Edit Pet Breed":"Add Pet Breed"})}),e.jsx(V,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(w),className:"space-y-4",children:[e.jsx(o,{control:t.control,name:"species",render:({field:n})=>e.jsxs(x,{children:[e.jsx(h,{children:"Species"}),e.jsxs(B,{onValueChange:n.onChange,value:n.value,children:[e.jsx(u,{children:e.jsx(q,{"data-testid":"select-breed-species",children:e.jsx(F,{})})}),e.jsxs(Z,{children:[e.jsx(c,{value:"dog",children:"Dog"}),e.jsx(c,{value:"cat",children:"Cat"}),e.jsx(c,{value:"bird",children:"Bird"}),e.jsx(c,{value:"rabbit",children:"Rabbit"}),e.jsx(c,{value:"hamster",children:"Hamster"}),e.jsx(c,{value:"other",children:"Other"})]})]}),e.jsx(j,{})]})}),e.jsx(o,{control:t.control,name:"breedEn",render:({field:n})=>e.jsxs(x,{children:[e.jsx(h,{children:"Breed Name (English)"}),e.jsx(u,{children:e.jsx(b,{placeholder:"Golden Retriever",...n,"data-testid":"input-breed-name-en"})}),e.jsx(j,{})]})}),e.jsx(o,{control:t.control,name:"breedZh",render:({field:n})=>e.jsxs(x,{children:[e.jsx(h,{children:"Breed Name (Chinese)"}),e.jsx(u,{children:e.jsx(b,{placeholder:"é‡‘æ¯›å°‹å›žçŠ¬",...n,"data-testid":"input-breed-name-zh"})}),e.jsx(j,{})]})}),e.jsx(o,{control:t.control,name:"countryCode",render:({field:n})=>e.jsxs(x,{children:[e.jsx(h,{children:"Country (Optional)"}),e.jsxs(B,{onValueChange:i=>n.onChange(i==="GLOBAL"?null:i),value:n.value||"GLOBAL",children:[e.jsx(u,{children:e.jsx(q,{"data-testid":"select-breed-country",children:e.jsx(F,{placeholder:"Global (all countries)"})})}),e.jsxs(Z,{children:[e.jsx(c,{value:"GLOBAL",children:"Global (all countries)"}),r.map(i=>e.jsxs(c,{value:i.code,children:[i.flag," ",i.nameEn]},i.code))]})]}),e.jsx(j,{})]})}),e.jsx(o,{control:t.control,name:"isCommon",render:({field:n})=>e.jsxs(x,{children:[e.jsx(h,{children:"Common Breed"}),e.jsxs(B,{onValueChange:i=>n.onChange(i==="true"),value:String(n.value),children:[e.jsx(u,{children:e.jsx(q,{"data-testid":"select-breed-common",children:e.jsx(F,{})})}),e.jsxs(Z,{children:[e.jsx(c,{value:"true",children:"Common"}),e.jsx(c,{value:"false",children:"Uncommon"})]})]}),e.jsx(j,{})]})}),e.jsx(o,{control:t.control,name:"active",render:({field:n})=>e.jsxs(x,{children:[e.jsx(h,{children:"Status"}),e.jsxs(B,{onValueChange:i=>n.onChange(i==="true"),value:String(n.value),children:[e.jsx(u,{children:e.jsx(q,{"data-testid":"select-breed-status",children:e.jsx(F,{})})}),e.jsxs(Z,{children:[e.jsx(c,{value:"true",children:"Active"}),e.jsx(c,{value:"false",children:"Inactive"})]})]}),e.jsx(j,{})]})}),e.jsx(p,{type:"submit",className:"w-full",disabled:s,"data-testid":"button-submit-breed",children:s?"Saving...":g?"Update":"Create"})]})})]})]})]}),e.jsxs(Y,{children:[e.jsx(_,{children:e.jsxs(K,{children:[e.jsx(d,{children:"Species"}),e.jsx(d,{children:"Breed (EN)"}),e.jsx(d,{children:"Breed (ZH)"}),e.jsx(d,{children:"Country"}),e.jsx(d,{children:"Common"}),e.jsx(d,{children:"Status"}),e.jsx(d,{children:"Actions"})]})}),e.jsx(ee,{children:f.map(n=>{const i=r.find(ne=>ne.code===n.countryCode);return e.jsxs(K,{"data-testid":`row-breed-${n.id}`,children:[e.jsx(l,{className:"capitalize",children:n.species}),e.jsx(l,{children:n.breedEn}),e.jsx(l,{children:n.breedZh}),e.jsx(l,{children:n.countryCode?e.jsxs(e.Fragment,{children:[i==null?void 0:i.flag," ",i==null?void 0:i.nameEn]}):e.jsx("span",{className:"text-muted-foreground",children:"Global"})}),e.jsx(l,{children:n.isCommon?e.jsx("span",{className:"text-green-600",children:"Common"}):e.jsx("span",{className:"text-gray-400",children:"Uncommon"})}),e.jsx(l,{children:e.jsx("span",{className:n.active?"text-green-600":"text-gray-400",children:n.active?"Active":"Inactive"})}),e.jsx(l,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{variant:"outline",size:"sm",onClick:()=>D(n),"data-testid":`button-edit-breed-${n.id}`,children:e.jsx(H,{className:"h-4 w-4"})}),e.jsx(p,{variant:"destructive",size:"sm",onClick:()=>y.mutate(n.id),disabled:y.isPending,"data-testid":`button-delete-breed-${n.id}`,children:e.jsx(k,{className:"h-4 w-4"})})]})})]},n.id)})})]})]})}export{Se as default};
