import{c as R,e as Ue,f as ea,a as aa,u as sa,a6 as ta,r as m,h as f,g as ra,j as e,S as ia,X as $,B as i,C as v,v as k,w as N,y as w,b as C,F as na,z as _,A,D as S,E as P,I as ue,G as F,Q as la,J as fe,K as je,N as ye,O as be,P as ae,M as oa,a7 as da,d as ca,a8 as ve,a9 as ke,a5 as pa,aa as ma,$ as se,a0 as te,a1 as re,a2 as ie,a3 as ne,ab as Ne,ac as B,ad as d,ae as we,a4 as le,o as xa,s as K,af as ha,ag as ga,T as u,U as T,ah as ua}from"./index-yGPiJpIr.js";import{u as j}from"./useMutation-g6oReyS0.js";import{A as fa,h as ja,a as ya,b as ba,c as va,d as ka,e as Na,f as wa,g as Ca}from"./alert-dialog-CbtaLizn.js";import{A as Ce,a as _e,b as Ae,c as Se}from"./accordion-5sL8WrAM.js";import{S as D}from"./switch-BdZ2xI1R.js";import{A as _a}from"./arrow-left-BVTF3Tl5.js";import{P as z}from"./paw-print-D6Tii1Io.js";import{S as Aa}from"./square-pen-Cuk1HIl5.js";import{U as Pe}from"./user-CcdmAbwc.js";import{M as Sa}from"./mail-CLLlllUf.js";import{G as Fe}from"./globe-CpIG6KpI.js";import{T as Te}from"./triangle-alert-DBRIKIPj.js";import{C as De}from"./copy-DKt1Q6nz.js";import{S as Pa}from"./shield-CCzToWzY.js";import{D as Fa}from"./download-CBUc3OPD.js";import{T as Ta}from"./trash-2-pXZASDYN.js";import"./index-C-LwW-wl.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Da=R("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const La=R("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ea=R("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=R("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]),qa=t=>xa({name:K().min(1,t("profile.validation.name","Name is required")).optional().or(ha("")),email:K().email(t("profile.validation.email","Please enter a valid email")),phone:K().min(1,t("profile.validation.phone_required","Phone number is required")).min(8,t("profile.validation.phone_length","Please enter a valid phone number (at least 8 digits)")),languagePreference:ga(["en","zh-HK"]),regionPreference:K().optional()});function es(){const{user:t,isLoading:Le}=Ue(),[,oe]=ea(),{toast:n}=aa(),{t:a,language:Ee}=sa(),{setLanguage:Me}=ta(),[de,ce]=m.useState("+852"),qe=qa(a),{data:c,isLoading:Oe}=f({queryKey:["/api/users",t==null?void 0:t.id],enabled:!!(t!=null&&t.id)}),{data:Ve=[]}=f({queryKey:["/api/regions"]}),{data:H=[]}=f({queryKey:["/api/countries"]}),{data:L=[],isLoading:Ie}=f({queryKey:["/api/users",t==null?void 0:t.id,"pets"],enabled:!!(t!=null&&t.id)}),{data:l,isLoading:$e}=f({queryKey:["/api/users",t==null?void 0:t.id,"notification-preferences"],enabled:!!(t!=null&&t.id)}),x=j({mutationFn:async s=>await(await u("PATCH",`/api/users/${t==null?void 0:t.id}/notification-preferences`,s)).json(),onSuccess:()=>{T.invalidateQueries({queryKey:["/api/users",t==null?void 0:t.id,"notification-preferences"]}),n({title:a("profile.notifications.success","Notification preferences updated"),description:a("profile.notifications.success_desc","Your notification settings have been saved.")})},onError:s=>{n({title:a("profile.notifications.error","Update failed"),description:s.message,variant:"destructive"})}}),y=(s,r)=>{x.mutate({[s]:r})},[Be,E]=m.useState(!1),[M,Ke]=m.useState(null),[Y,Q]=m.useState(""),[q,pe]=m.useState(null),[ze,O]=m.useState(!1),[Re,me]=m.useState(!1),[He,V]=m.useState(!1),[G,W]=m.useState(""),xe=(c==null?void 0:c.role)==="admin",{data:I,isLoading:Ye}=f({queryKey:["/api/auth/2fa/status"],enabled:!!(t!=null&&t.id)&&xe}),J=j({mutationFn:async()=>await(await u("POST","/api/auth/2fa/setup",{})).json(),onSuccess:s=>{Ke({qrCode:s.qrCode,secret:s.secret}),E(!0)},onError:s=>{n({title:a("profile.2fa.setup_error","Setup failed"),description:s.message,variant:"destructive"})}}),X=j({mutationFn:async s=>await(await u("POST","/api/auth/2fa/verify",{code:s})).json(),onSuccess:s=>{pe(s.backupCodes),O(!0),E(!1),Q(""),T.invalidateQueries({queryKey:["/api/auth/2fa/status"]}),n({title:a("profile.2fa.enabled_title","2FA Enabled"),description:a("profile.2fa.enabled_desc","Two-factor authentication has been enabled. Save your backup codes.")})},onError:s=>{n({title:a("profile.2fa.verify_error","Verification failed"),description:s.message,variant:"destructive"})}}),Z=j({mutationFn:async s=>await(await u("POST","/api/auth/2fa/disable",{code:s})).json(),onSuccess:()=>{V(!1),W(""),T.invalidateQueries({queryKey:["/api/auth/2fa/status"]}),n({title:a("profile.2fa.disabled_title","2FA Disabled"),description:a("profile.2fa.disabled_desc","Two-factor authentication has been disabled.")})},onError:s=>{n({title:a("profile.2fa.disable_error","Disable failed"),description:s.message,variant:"destructive"})}}),he=j({mutationFn:async s=>await(await u("POST","/api/auth/2fa/backup-codes",{code:s})).json(),onSuccess:s=>{pe(s.backupCodes),O(!0),T.invalidateQueries({queryKey:["/api/auth/2fa/status"]}),n({title:a("profile.2fa.codes_regenerated","Backup Codes Regenerated"),description:a("profile.2fa.codes_regenerated_desc","New backup codes have been generated. Save them securely.")})},onError:s=>{n({title:a("profile.2fa.regenerate_error","Failed to regenerate codes"),description:s.message,variant:"destructive"})}}),Qe=()=>{q&&(navigator.clipboard.writeText(q.join(`
`)),me(!0),setTimeout(()=>me(!1),2e3))},o=ra({resolver:ua(qe),defaultValues:{name:"",email:"",phone:"",languagePreference:"en",regionPreference:void 0}});m.useEffect(()=>{if(c&&H.length>0&&(o.setValue("name",c.name||""),o.setValue("email",c.email||""),o.setValue("languagePreference",c.languagePreference||"en"),o.setValue("regionPreference",c.regionPreference||void 0),c.phone)){const s=c.phone.trim();if(s.startsWith("+")){const h=H.map(p=>p.phonePrefix).filter(Boolean).sort((p,g)=>((g==null?void 0:g.length)||0)-((p==null?void 0:p.length)||0)).find(p=>p&&s.startsWith(p));h?(ce(h),o.setValue("phone",s.substring(h.length).trim())):o.setValue("phone",s)}else o.setValue("phone",s)}},[c,H,o]);const U=j({mutationFn:async s=>{const r=s.phone?`${de}${s.phone.replace(/\s/g,"")}`:"";return await(await u("PATCH",`/api/users/${t==null?void 0:t.id}`,{...s,phone:r})).json()},onSuccess:(s,r)=>{T.invalidateQueries({queryKey:["/api/users",t==null?void 0:t.id]}),r.languagePreference&&Me(r.languagePreference),n({title:a("profile.success.title","Profile updated successfully!"),description:a("profile.success.desc","Your changes have been saved.")})},onError:s=>{n({title:a("profile.error.title","Update failed"),description:s.message,variant:"destructive"})}}),Ge=s=>{U.mutate(s)},We=async()=>{try{const s=await fetch("/api/users/export",{credentials:"include"});if(!s.ok){const ee=s.headers.get("Content-Type");if(ee&&ee.includes("application/json")){const Ze=await s.json();throw new Error(Ze.message||"Failed to export data")}throw new Error("Failed to export data")}const r=s.headers.get("Content-Type");if(!r||!r.includes("application/json"))throw new Error("Invalid response format");const h=s.headers.get("Content-Disposition");if(!h)throw new Error("Invalid download response");let p=`petsos-data-export-${new Date().toISOString()}.json`;const g=h.match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/);g&&g[1]&&(p=g[1].replace(/['"]/g,""));const Xe=await s.blob(),ge=window.URL.createObjectURL(Xe),b=document.createElement("a");b.href=ge,b.download=p,document.body.appendChild(b),b.click(),window.URL.revokeObjectURL(ge);try{b.remove()}catch{}n({title:a("profile.export.success_title","Data exported successfully"),description:a("profile.export.success_desc","Your personal data has been downloaded.")})}catch{n({title:a("profile.export.error_title","Export failed"),description:a("profile.export.error_desc","Failed to download your data. Please try again."),variant:"destructive"})}},Je=async()=>{try{const s=await u("DELETE","/api/users/gdpr-delete"),r=await s.json();if(!s.ok)throw new Error(r.message||"Failed to delete account");n({title:a("profile.delete.success_title","Account deleted"),description:a("profile.delete.success_desc","Your account and all data have been permanently deleted.")}),setTimeout(()=>{oe("/")},2e3)}catch(s){n({title:a("profile.delete.error_title","Deletion failed"),description:s.message||a("profile.delete.error_desc","Failed to delete your account. Please try again."),variant:"destructive"})}};return Le||Oe?e.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-900 flex items-center justify-center",children:e.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:a("loading.profile","Loading profile...")})}):t?e.jsxs(e.Fragment,{children:[e.jsx(ia,{noindex:!0}),e.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-900 py-8",children:e.jsxs("div",{className:"max-w-2xl mx-auto px-4",children:[e.jsx("div",{className:"mb-6",children:e.jsx($,{href:"/",children:e.jsxs(i,{variant:"ghost",size:"sm","data-testid":"button-back",children:[e.jsx(_a,{className:"w-4 h-4 mr-2"}),a("button.back_home","Back to Home")]})})}),e.jsxs(v,{className:"border-2 border-green-200 dark:border-green-800 bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-950 dark:to-emerald-950",children:[e.jsxs(k,{children:[e.jsxs(N,{className:"flex items-center gap-2 text-green-800 dark:text-green-300",children:[e.jsx(z,{className:"w-6 h-6"}),a("profile.pets_cta.title","Your Pets")," ",L.length>0&&`(${L.length})`]}),e.jsx(w,{className:"text-green-700 dark:text-green-400",children:a("profile.pets_cta.desc","Save your pet profiles for faster emergency help")})]}),e.jsx(C,{className:"space-y-4",children:Ie?e.jsx("div",{className:"text-sm text-green-700 dark:text-green-400",children:a("loading.pets","Loading pets...")}):L.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-3",children:L.map(s=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white dark:bg-gray-800 rounded-lg border border-green-200 dark:border-green-800","data-testid":`pet-card-${s.id}`,children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center text-2xl",children:s.species==="dog"?"ðŸ•":s.species==="cat"?"ðŸˆ":s.species==="bird"?"ðŸ¦œ":s.species==="rabbit"?"ðŸ°":s.species==="hamster"?"ðŸ¹":"ðŸ¾"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-gray-100","data-testid":`pet-name-${s.id}`,children:s.name}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":`pet-info-${s.id}`,children:[s.breed," ",s.age&&`â€¢ ${s.age} ${a("pets.years","years")}`]})]}),e.jsx($,{href:"/pets",children:e.jsx(i,{variant:"ghost",size:"sm","data-testid":`button-edit-pet-${s.id}`,children:e.jsx(Aa,{className:"w-4 h-4"})})})]},s.id))}),e.jsx($,{href:"/pets",children:e.jsxs(i,{className:"w-full bg-green-600 hover:bg-green-700 text-white dark:bg-green-700 dark:hover:bg-green-600",size:"lg","data-testid":"button-add-pet",children:[e.jsx(z,{className:"w-5 h-5 mr-2"}),a("profile.pets_cta.add_another","Add Another Pet")]})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-3 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center",children:e.jsx(z,{className:"w-8 h-8 text-green-600 dark:text-green-400"})}),e.jsx("h4",{className:"font-semibold text-green-800 dark:text-green-300 mb-2",children:a("profile.pets_empty.title","No pets yet")}),e.jsx("p",{className:"text-sm text-green-700 dark:text-green-400 mb-4",children:a("profile.pets_empty.desc","Add your first furry kid for faster emergency help. It only takes 30 seconds!")})]}),e.jsx($,{href:"/pets",children:e.jsxs(i,{className:"w-full bg-green-600 hover:bg-green-700 text-white dark:bg-green-700 dark:hover:bg-green-600",size:"lg","data-testid":"button-add-first-pet",children:[e.jsx(z,{className:"w-5 h-5 mr-2"}),a("profile.pets_cta.button","Add or Manage Pets")]})})]})})]}),e.jsxs(v,{className:"mt-6",children:[e.jsxs(k,{children:[e.jsxs(N,{className:"flex items-center gap-2",children:[e.jsx(Pe,{className:"w-6 h-6"}),a("profile.title","My Profile")]}),e.jsx(w,{children:a("profile.desc","Manage your account information and preferences")})]}),e.jsx(C,{children:e.jsx(na,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(Ge),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(_,{control:o.control,name:"name",render:({field:s})=>e.jsxs(A,{children:[e.jsx(S,{children:a("profile.name","Name")}),e.jsx(P,{children:e.jsxs("div",{className:"relative",children:[e.jsx(Pe,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400 dark:text-gray-500"}),e.jsx(ue,{...s,className:"pl-10",placeholder:a("profile.name_placeholder","Enter your name"),"data-testid":"input-name"})]})}),e.jsx(F,{})]})}),e.jsx(_,{control:o.control,name:"email",render:({field:s})=>e.jsxs(A,{children:[e.jsx(S,{children:a("profile.email","Email")}),e.jsx(P,{children:e.jsxs("div",{className:"relative",children:[e.jsx(Sa,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400 dark:text-gray-500"}),e.jsx(ue,{...s,type:"email",className:"pl-10",placeholder:a("profile.email_placeholder","you@example.com"),"data-testid":"input-email"})]})}),e.jsx(F,{})]})}),e.jsx(_,{control:o.control,name:"phone",render:({field:s})=>e.jsxs(A,{children:[e.jsxs(S,{children:[a("profile.phone","Phone Number"),e.jsx("span",{className:"text-red-600 dark:text-red-500 ml-1",children:"*"})]}),e.jsx(P,{children:e.jsx(la,{value:s.value,onChange:s.onChange,countryCode:de,onCountryCodeChange:ce,testId:"input-phone"})}),e.jsx(F,{})]})})]}),e.jsx(Ce,{type:"single",collapsible:!0,className:"border rounded-lg",children:e.jsxs(_e,{value:"settings",className:"border-0",children:[e.jsx(Ae,{className:"px-4 hover:no-underline","data-testid":"accordion-settings",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"w-4 h-4"}),e.jsx("span",{children:a("profile.settings","Language & Region Settings")})]})}),e.jsxs(Se,{className:"px-4 pb-4 space-y-4",children:[e.jsx(_,{control:o.control,name:"languagePreference",render:({field:s})=>e.jsxs(A,{children:[e.jsx(S,{children:a("profile.language","Language Preference")}),e.jsxs(fe,{onValueChange:s.onChange,value:s.value,children:[e.jsx(P,{children:e.jsxs(je,{"data-testid":"select-language",children:[e.jsx(Fe,{className:"w-4 h-4 mr-2 text-gray-400 dark:text-gray-500"}),e.jsx(ye,{placeholder:a("profile.language_placeholder","Select language")})]})}),e.jsxs(be,{children:[e.jsx(ae,{value:"en","data-testid":"option-en",children:"English"}),e.jsx(ae,{value:"zh-HK","data-testid":"option-zh",children:"ç¹é«”ä¸­æ–‡"})]})]}),e.jsx(F,{})]})}),e.jsx(_,{control:o.control,name:"regionPreference",render:({field:s})=>e.jsxs(A,{children:[e.jsx(S,{children:a("profile.region","Region Preference")}),e.jsxs(fe,{onValueChange:s.onChange,value:s.value,children:[e.jsx(P,{children:e.jsxs(je,{"data-testid":"select-region",children:[e.jsx(oa,{className:"w-4 h-4 mr-2 text-gray-400 dark:text-gray-500"}),e.jsx(ye,{placeholder:a("profile.region_placeholder","Select region")})]})}),e.jsx(be,{children:Ve.map(r=>e.jsx(ae,{value:r.id,"data-testid":`option-region-${r.code}`,children:Ee==="en"?r.nameEn:r.nameZh},r.id))})]}),e.jsx(F,{})]})})]})]})}),e.jsxs(i,{type:"submit",className:"w-full",disabled:U.isPending,"data-testid":"button-save-profile",children:[e.jsx(Ea,{className:"w-4 h-4 mr-2"}),U.isPending?a("profile.saving","Saving..."):a("profile.save","Save Changes")]})]})})})]}),e.jsxs(v,{className:"mt-6",children:[e.jsxs(k,{children:[e.jsxs(N,{className:"flex items-center gap-2",children:[e.jsx(da,{className:"w-6 h-6"}),a("profile.notifications.title","Notification Preferences")]}),e.jsx(w,{children:a("profile.notifications.desc","Control what types of notifications you receive")})]}),e.jsx(C,{children:$e?e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("loading.notifications","Loading notification preferences...")}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ca,{className:"w-5 h-5 text-red-600 dark:text-red-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:a("profile.notifications.emergency_alerts","Emergency Alerts")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("profile.notifications.emergency_alerts_desc","Critical notifications about your emergency requests")})]})]}),e.jsx(D,{checked:(l==null?void 0:l.emergencyAlerts)??!0,onCheckedChange:s=>y("emergencyAlerts",s),disabled:x.isPending,"data-testid":"switch-emergency-alerts"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(La,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:a("profile.notifications.general_updates","General Updates")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("profile.notifications.general_updates_desc","Platform announcements and service updates")})]})]}),e.jsx(D,{checked:(l==null?void 0:l.generalUpdates)??!0,onCheckedChange:s=>y("generalUpdates",s),disabled:x.isPending,"data-testid":"switch-general-updates"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-amber-50 dark:bg-amber-900/20 rounded-lg border border-amber-200 dark:border-amber-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Te,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:a("profile.notifications.system_alerts","System Alerts")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("profile.notifications.system_alerts_desc","Maintenance notices and security alerts")})]})]}),e.jsx(D,{checked:(l==null?void 0:l.systemAlerts)??!0,onCheckedChange:s=>y("systemAlerts",s),disabled:x.isPending,"data-testid":"switch-system-alerts"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Da,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:a("profile.notifications.vet_tips","Veterinary Tips")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("profile.notifications.vet_tips_desc","Pet health tips and educational content")})]})]}),e.jsx(D,{checked:(l==null?void 0:l.vetTips)??!0,onCheckedChange:s=>y("vetTips",s),disabled:x.isPending,"data-testid":"switch-vet-tips"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-200 dark:border-purple-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ma,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:a("profile.notifications.promotions","Promotions & Offers")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("profile.notifications.promotions_desc","Special offers from partner clinics and hospitals")})]})]}),e.jsx(D,{checked:(l==null?void 0:l.promotions)??!1,onCheckedChange:s=>y("promotions",s),disabled:x.isPending,"data-testid":"switch-promotions"})]}),x.isPending&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center",children:a("profile.notifications.saving","Saving preferences...")})]})})]}),xe&&e.jsxs(v,{className:"mt-6 border-2 border-amber-200 dark:border-amber-800",children:[e.jsxs(k,{children:[e.jsxs(N,{className:"flex items-center gap-2 text-amber-700 dark:text-amber-400",children:[e.jsx(ve,{className:"w-6 h-6"}),a("profile.2fa.title","Two-Factor Authentication")]}),e.jsx(w,{children:a("profile.2fa.desc","Add an extra layer of security to your admin account")})]}),e.jsx(C,{children:Ye?e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("loading.2fa","Loading 2FA status...")}):I!=null&&I.enabled?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-green-100 dark:bg-green-800 flex items-center justify-center",children:e.jsx(ke,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-green-800 dark:text-green-300",children:a("profile.2fa.enabled_status","2FA is enabled")}),e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400",children:a("profile.2fa.backup_count",`${I.backupCodesCount} backup codes remaining`)})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(i,{variant:"outline",className:"flex-1",onClick:()=>{const s=prompt(a("profile.2fa.enter_code","Enter your 2FA code to regenerate backup codes:"));s&&he.mutate(s)},disabled:he.isPending,"data-testid":"button-regenerate-backup-codes",children:[e.jsx(pa,{className:"w-4 h-4 mr-2"}),a("profile.2fa.regenerate_codes","New Backup Codes")]}),e.jsxs(i,{variant:"destructive",className:"flex-1",onClick:()=>V(!0),"data-testid":"button-disable-2fa",children:[e.jsx(ve,{className:"w-4 h-4 mr-2"}),a("profile.2fa.disable_button","Disable 2FA")]})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-amber-50 dark:bg-amber-900/20 rounded-lg border border-amber-200 dark:border-amber-800",children:e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-300",children:a("profile.2fa.not_enabled","Two-factor authentication adds an extra layer of security by requiring a code from your authenticator app when logging in.")})}),e.jsxs(i,{onClick:()=>J.mutate(),disabled:J.isPending,className:"w-full bg-amber-600 hover:bg-amber-700 text-white","data-testid":"button-enable-2fa",children:[e.jsx(ma,{className:"w-4 h-4 mr-2"}),J.isPending?a("profile.2fa.setting_up","Setting up..."):a("profile.2fa.enable_button","Enable Two-Factor Authentication")]})]})})]}),e.jsx(se,{open:Be,onOpenChange:E,children:e.jsxs(te,{className:"sm:max-w-md",children:[e.jsxs(re,{children:[e.jsx(ie,{children:a("profile.2fa.setup_title","Set Up Two-Factor Authentication")}),e.jsx(ne,{children:a("profile.2fa.setup_desc","Scan the QR code with your authenticator app (Google Authenticator, Authy, etc.)")})]}),e.jsx("div",{className:"space-y-4",children:M&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-center p-4 bg-white rounded-lg",children:e.jsx("img",{src:M.qrCode,alt:"2FA QR Code",className:"w-48 h-48","data-testid":"img-2fa-qrcode"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 text-center",children:a("profile.2fa.manual_entry","Or enter this code manually:")}),e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-100 dark:bg-gray-800 rounded font-mono text-sm",children:[e.jsx("code",{className:"flex-1 text-center","data-testid":"text-2fa-secret",children:M.secret}),e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>navigator.clipboard.writeText(M.secret),"data-testid":"button-copy-secret",children:e.jsx(De,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:a("profile.2fa.enter_verification","Enter the 6-digit code from your app:")}),e.jsx("div",{className:"flex justify-center",children:e.jsxs(Ne,{value:Y,onChange:Q,maxLength:6,"data-testid":"input-2fa-code",children:[e.jsxs(B,{children:[e.jsx(d,{index:0}),e.jsx(d,{index:1}),e.jsx(d,{index:2})]}),e.jsx(we,{}),e.jsxs(B,{children:[e.jsx(d,{index:3}),e.jsx(d,{index:4}),e.jsx(d,{index:5})]})]})})]})]})}),e.jsxs(le,{children:[e.jsx(i,{variant:"outline",onClick:()=>{E(!1),Q("")},children:a("common.cancel","Cancel")}),e.jsx(i,{onClick:()=>X.mutate(Y),disabled:Y.length!==6||X.isPending,"data-testid":"button-verify-2fa",children:X.isPending?a("profile.2fa.verifying","Verifying..."):a("profile.2fa.verify_button","Verify & Enable")})]})]})}),e.jsx(se,{open:ze,onOpenChange:O,children:e.jsxs(te,{className:"sm:max-w-md",children:[e.jsxs(re,{children:[e.jsx(ie,{children:a("profile.2fa.backup_title","Save Your Backup Codes")}),e.jsx(ne,{children:a("profile.2fa.backup_desc","Store these codes securely. Each code can only be used once if you lose access to your authenticator app.")})]}),e.jsxs("div",{className:"space-y-4",children:[q&&e.jsx("div",{className:"grid grid-cols-2 gap-2 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg font-mono text-sm",children:q.map((s,r)=>e.jsx("div",{className:"p-2 bg-white dark:bg-gray-700 rounded text-center","data-testid":`text-backup-code-${r}`,children:s},r))}),e.jsx(i,{onClick:Qe,variant:"outline",className:"w-full","data-testid":"button-copy-backup-codes",children:Re?e.jsxs(e.Fragment,{children:[e.jsx(ke,{className:"w-4 h-4 mr-2"}),a("profile.2fa.copied","Copied!")]}):e.jsxs(e.Fragment,{children:[e.jsx(De,{className:"w-4 h-4 mr-2"}),a("profile.2fa.copy_codes","Copy All Codes")]})})]}),e.jsx(le,{children:e.jsx(i,{onClick:()=>O(!1),"data-testid":"button-close-backup-codes",children:a("profile.2fa.saved_codes","I've Saved My Codes")})})]})}),e.jsx(se,{open:He,onOpenChange:V,children:e.jsxs(te,{className:"sm:max-w-md",children:[e.jsxs(re,{children:[e.jsx(ie,{children:a("profile.2fa.disable_title","Disable Two-Factor Authentication")}),e.jsx(ne,{children:a("profile.2fa.disable_desc","Enter your current 2FA code to disable two-factor authentication. This will make your account less secure.")})]}),e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"flex justify-center",children:e.jsxs(Ne,{value:G,onChange:W,maxLength:6,"data-testid":"input-disable-2fa-code",children:[e.jsxs(B,{children:[e.jsx(d,{index:0}),e.jsx(d,{index:1}),e.jsx(d,{index:2})]}),e.jsx(we,{}),e.jsxs(B,{children:[e.jsx(d,{index:3}),e.jsx(d,{index:4}),e.jsx(d,{index:5})]})]})})}),e.jsxs(le,{children:[e.jsx(i,{variant:"outline",onClick:()=>{V(!1),W("")},children:a("common.cancel","Cancel")}),e.jsx(i,{variant:"destructive",onClick:()=>Z.mutate(G),disabled:G.length!==6||Z.isPending,"data-testid":"button-confirm-disable-2fa",children:Z.isPending?a("profile.2fa.disabling","Disabling..."):a("profile.2fa.confirm_disable","Disable 2FA")})]})]})}),e.jsxs(v,{className:"mt-6 border-gray-200 dark:border-gray-800",children:[e.jsxs(k,{children:[e.jsxs(N,{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx(Pa,{className:"w-5 h-5"}),a("profile.privacy.title","Privacy & Data Rights")]}),e.jsx(w,{children:a("profile.privacy.desc","Manage your personal data and privacy settings")})]}),e.jsx(C,{children:e.jsx(Ce,{type:"single",collapsible:!0,children:e.jsxs(_e,{value:"privacy",children:[e.jsx(Ae,{"data-testid":"accordion-privacy",children:a("profile.privacy.expand","View privacy options")}),e.jsxs(Se,{className:"space-y-6 pt-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2 text-sm text-gray-700 dark:text-gray-300",children:a("profile.privacy.export_title","Export Your Data")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:a("profile.privacy.export_desc","Download a copy of all your personal data in JSON format (GDPR/PDPO compliant)")}),e.jsxs(i,{onClick:We,variant:"outline",className:"w-full","data-testid":"button-export-data",children:[e.jsx(Fa,{className:"w-4 h-4 mr-2"}),a("profile.privacy.export_button","Download My Data")]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h4",{className:"font-medium mb-2 text-sm text-gray-700 dark:text-gray-300",children:a("profile.privacy.delete_title","Delete Your Account")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:a("profile.privacy.delete_desc","Permanently delete your account and all associated data. This action cannot be undone.")}),e.jsxs(fa,{children:[e.jsx(ja,{asChild:!0,children:e.jsxs(i,{variant:"destructive",className:"w-full","data-testid":"button-delete-account",children:[e.jsx(Ta,{className:"w-4 h-4 mr-2"}),a("profile.privacy.delete_button","Delete My Account")]})}),e.jsxs(ya,{children:[e.jsxs(ba,{children:[e.jsxs(va,{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"w-5 h-5 text-red-600 dark:text-red-500"}),a("profile.delete.dialog_title","Are you absolutely sure?")]}),e.jsxs(ka,{children:[a("profile.delete.dialog_desc","This action cannot be undone. This will permanently delete your account and remove all your data from our servers, including:"),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1 text-sm",children:[e.jsx("li",{children:a("profile.delete.dialog_item1","Your profile and contact information")}),e.jsx("li",{children:a("profile.delete.dialog_item2","All saved pets and their medical history")}),e.jsx("li",{children:a("profile.delete.dialog_item3","All emergency request records")}),e.jsx("li",{children:a("profile.delete.dialog_item4","All privacy consents and preferences")})]})]})]}),e.jsxs(Na,{children:[e.jsx(wa,{"data-testid":"button-cancel-delete",children:a("profile.delete.dialog_cancel","Cancel")}),e.jsx(Ca,{onClick:Je,className:"bg-red-600 hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600","data-testid":"button-confirm-delete",children:a("profile.delete.dialog_confirm","Yes, delete my account")})]})]})]})]})]})]})})})]})]})})]}):(oe("/"),null)}export{es as default};
