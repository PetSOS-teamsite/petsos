import{c as Re,r as m,a as Ve,h as de,g as fe,j as e,a3 as Be,B as j,C as k,q as P,t as A,b as S,a5 as Ne,I as u,E as oe,G as xe,H as he,J as ue,K as y,ao as $e,M as qe,a6 as se,a7 as ae,a8 as ne,a9 as le,aa as re,s as M,F as Ue,aK as We,aL as Ke,aM as V,aW as B,w as i,x as l,y as r,z as t,A as d,D as z,v as ze,ab as Ze,O as $,Q as K,aX as Xe,ad as Ce}from"./index-B6B5-wqG.js";import{u as we}from"./useMutation-DUKQItlV.js";import{A as Qe,a as Ge,b as Je,c as _e,d as Ye,e as es,f as ss,g as as}from"./alert-dialog-DGaBQvry.js";import{T as O}from"./textarea-B8jmdzpK.js";import{S as c}from"./switch-7TT_84Ex.js";import{B as q}from"./badge-BCk9M62I.js";import{i as ns}from"./schema-B-05xN5B.js";import{L as te}from"./loader-circle-BzrSke9v.js";import{A as ls}from"./arrow-left-BpE3PuIj.js";import{P as rs}from"./plus-DnjqSZ24.js";import{B as ts}from"./building-2-BRlfl8Dq.js";import{S as ie}from"./star-DBX654sP.js";import{C as ke}from"./circle-check-vxY-lgNo.js";import{I as me}from"./image-CSjOTTx7.js";import{S as is}from"./search-DTxsAJDX.js";import{P as cs}from"./pencil-xD7zwg5A.js";import{T as ds}from"./trash-2-CgsLVNDK.js";import{C as os}from"./copy-DCH70_rv.js";import{E as xs}from"./external-link-CYEeLBKa.js";import{U as hs}from"./upload-DSNnQUDA.js";import{C as us}from"./circle-x-CX15qlya.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=Re("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]),js=n=>{const v=n.split(",").map(f=>f.trim()).filter(f=>f);return v.length>0?v:null},Se=n=>(n||[]).join(", ");function ce({control:n,name:v,label:f,placeholder:N,description:E,testId:b}){const{field:C}=Xe({control:n,name:v}),[T,s]=m.useState(Se(C.value));m.useEffect(()=>{s(Se(C.value))},[C.value]);const h=w=>{const D=w.target.value;s(D),C.onChange(js(D))};return e.jsxs(l,{children:[e.jsx(r,{children:f}),e.jsx(t,{children:e.jsx(u,{value:T,onChange:h,placeholder:N,"data-testid":b})}),e.jsx(z,{children:E}),e.jsx(d,{})]})}const Pe=ns.extend({nameEn:M().min(1,"Hospital name (English) is required"),nameZh:M().min(1,"Hospital name (Chinese) is required"),addressEn:M().min(1,"Address (English) is required"),addressZh:M().min(1,"Address (Chinese) is required"),regionId:M().min(1,"Region is required"),slug:M().min(1,"URL slug is required").regex(/^[a-z0-9-]+$/,"Slug must be lowercase letters, numbers, and hyphens only")});function Ae({form:n,onSubmit:v,submitLabel:f}){de({queryKey:["/api/regions"]});const[N,E]=m.useState(""),b=n.watch("photos"),C=()=>{if(N.trim()){const s=b||[];n.setValue("photos",[...s,N.trim()],{shouldDirty:!0,shouldTouch:!0}),E("")}},T=s=>{const h=b||[];n.setValue("photos",h.filter((w,D)=>D!==s),{shouldDirty:!0,shouldTouch:!0})};return e.jsx(Ue,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(v),className:"space-y-4",children:[e.jsxs(We,{defaultValue:"basic",className:"w-full",children:[e.jsxs(Ke,{className:"grid w-full grid-cols-5",children:[e.jsx(V,{value:"basic",children:"Basic Info"}),e.jsx(V,{value:"photos",children:"Photos"}),e.jsx(V,{value:"facilities",children:"Facilities"}),e.jsx(V,{value:"medical",children:"Medical Services"}),e.jsx(V,{value:"operational",children:"Operational"})]}),e.jsxs(B,{value:"basic",className:"space-y-4",children:[e.jsx("div",{className:"mb-4 p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-md",children:e.jsxs("p",{className:"text-sm text-green-800 dark:text-green-300",children:[e.jsx("strong",{children:"Essential Information:"})," Help pet parents contact you quickly during emergencies. Complete this first, then add photos and services to increase visibility."]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(i,{control:n.control,name:"nameEn",render:({field:s})=>e.jsxs(l,{children:[e.jsx(r,{children:"Hospital Name (English) *"}),e.jsx(t,{children:e.jsx(u,{...s,placeholder:"Central Animal Hospital","data-testid":"input-name-en"})}),e.jsx(d,{})]})}),e.jsx(i,{control:n.control,name:"nameZh",render:({field:s})=>e.jsxs(l,{children:[e.jsx(r,{children:"Hospital Name (Chinese) *"}),e.jsx(t,{children:e.jsx(u,{...s,placeholder:"ä¸­ç’°å‹•ç‰©é†«é™¢","data-testid":"input-name-zh"})}),e.jsx(d,{})]})})]}),e.jsx(i,{control:n.control,name:"slug",render:({field:s})=>e.jsxs(l,{children:[e.jsx(r,{children:"URL Slug *"}),e.jsx(t,{children:e.jsx(u,{...s,placeholder:"central-animal-hospital","data-testid":"input-slug"})}),e.jsx(z,{children:"Lowercase letters, numbers, and hyphens only"}),e.jsx(d,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(i,{control:n.control,name:"addressEn",render:({field:s})=>e.jsxs(l,{children:[e.jsx(r,{children:"Address (English) *"}),e.jsx(t,{children:e.jsx(O,{...s,placeholder:"123 Queen's Road Central",rows:3,"data-testid":"input-address-en"})}),e.jsx(d,{})]})}),e.jsx(i,{control:n.control,name:"addressZh",render:({field:s})=>e.jsxs(l,{children:[e.jsx(r,{children:"Address (Chinese) *"}),e.jsx(t,{children:e.jsx(O,{...s,placeholder:"çš‡åŽå¤§é“ä¸­123è™Ÿ",rows:3,"data-testid":"input-address-zh"})}),e.jsx(d,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(i,{control:n.control,name:"phone",render:({field:s})=>e.jsxs(l,{children:[e.jsx(r,{children:"Phone *"}),e.jsx(t,{children:e.jsx(u,{...s,value:s.value||"",placeholder:"+852 1234 5678","data-testid":"input-phone"})}),e.jsx(d,{})]})}),e.jsx(i,{control:n.control,name:"whatsapp",render:({field:s})=>e.jsxs(l,{children:[e.jsx(r,{children:"WhatsApp *"}),e.jsx(t,{children:e.jsx(u,{...s,value:s.value||"",placeholder:"+852 1234 5678","data-testid":"input-whatsapp"})}),e.jsx(d,{})]})}),e.jsx(i,{control:n.control,name:"email",render:({field:s})=>e.jsxs(l,{children:[e.jsx(r,{children:"Email *"}),e.jsx(t,{children:e.jsx(u,{...s,value:s.value||"",placeholder:"info@hospital.com",type:"email","data-testid":"input-email"})}),e.jsx(d,{})]})})]})]}),e.jsx(B,{value:"photos",className:"space-y-4",children:e.jsxs(k,{children:[e.jsxs(P,{children:[e.jsx(A,{children:"Hospital Photos"}),e.jsx(ze,{children:"Add photos of the hospital to help pet owners"})]}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{placeholder:"Enter photo URL (e.g., https://example.com/photo.jpg)",value:N,onChange:s=>E(s.target.value),onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),C()),"data-testid":"input-photo-url"}),e.jsxs(j,{type:"button",onClick:C,"data-testid":"button-add-photo",children:[e.jsx(hs,{className:"h-4 w-4 mr-2"}),"Add"]})]}),b&&b.length>0?e.jsx("div",{className:"grid grid-cols-3 gap-4",children:b.map((s,h)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:s,alt:`Hospital photo ${h+1}`,className:"w-full h-32 object-cover rounded-lg border",onError:w=>{w.target.src="/placeholder-image.png"}}),e.jsx(j,{type:"button",variant:"destructive",size:"icon",className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>T(h),"data-testid":`button-remove-photo-${h}`,children:e.jsx(us,{className:"h-4 w-4"})}),e.jsxs("div",{className:"absolute bottom-2 left-2 bg-black/50 text-white text-xs px-2 py-1 rounded",children:["Photo ",h+1]})]},h))}):e.jsxs("div",{className:"text-center py-12 text-muted-foreground border-2 border-dashed rounded-lg",children:[e.jsx(me,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No photos added yet"}),e.jsx("p",{className:"text-sm",children:"Add photo URLs above to display them here"})]})]})]})}),e.jsxs(B,{value:"facilities",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(i,{control:n.control,name:"parking",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(r,{className:"text-base",children:"Parking Available"})}),e.jsx(t,{children:e.jsx(c,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"wheelchairAccess",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(r,{className:"text-base",children:"Wheelchair Accessible"})}),e.jsx(t,{children:e.jsx(c,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"isolationWard",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(r,{className:"text-base",children:"Isolation Ward"})}),e.jsx(t,{children:e.jsx(c,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"ambulanceSupport",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(r,{className:"text-base",children:"Ambulance Support"})}),e.jsx(t,{children:e.jsx(c,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"eolSupport",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(r,{className:"text-base",children:"End-of-Life Support"})}),e.jsx(t,{children:e.jsx(c,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"whatsappTriage",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(r,{className:"text-base",children:"WhatsApp Triage"})}),e.jsx(t,{children:e.jsx(c,{checked:s.value||!1,onCheckedChange:s.onChange})})]})})]}),e.jsx(i,{control:n.control,name:"icuLevel",render:({field:s})=>e.jsxs(l,{children:[e.jsx(r,{children:"ICU Level"}),e.jsx(t,{children:e.jsx(u,{...s,value:s.value||"",placeholder:"e.g., Level 2 ICU"})}),e.jsx(d,{})]})})]}),e.jsxs(B,{value:"medical",className:"space-y-4",children:[e.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md",children:e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-300",children:[e.jsx("strong",{children:"Optional:"})," Help pet parents find you during emergencies by listing your medical services and capabilities."]})}),e.jsx("h3",{className:"text-lg font-semibold",children:"Imaging Services"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(i,{control:n.control,name:"imagingXray",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(r,{className:"text-base",children:"X-Ray"})}),e.jsx(t,{children:e.jsx(c,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"imagingUS",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(r,{className:"text-base",children:"Ultrasound"})}),e.jsx(t,{children:e.jsx(c,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"imagingCT",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(r,{className:"text-base",children:"CT Scan"})}),e.jsx(t,{children:e.jsx(c,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"sameDayCT",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(r,{className:"text-base",children:"Same-Day CT"})}),e.jsx(t,{children:e.jsx(c,{checked:s.value||!1,onCheckedChange:s.onChange})})]})})]}),e.jsx("h3",{className:"text-lg font-semibold mt-6",children:"Laboratory & Testing"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(i,{control:n.control,name:"inHouseLab",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(r,{className:"text-base",children:"In-House Laboratory"})}),e.jsx(t,{children:e.jsx(c,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"extLabCutoff",render:({field:s})=>e.jsxs(l,{children:[e.jsx(r,{children:"External Lab Cutoff Time"}),e.jsx(t,{children:e.jsx(u,{...s,value:s.value||"",placeholder:"e.g., 6:00 PM"})})]})})]}),e.jsx(i,{control:n.control,name:"bloodBankAccess",render:({field:s})=>e.jsxs(l,{children:[e.jsx(r,{children:"Blood Bank Access"}),e.jsx(t,{children:e.jsx(u,{...s,value:s.value||"",placeholder:"e.g., On-site blood bank"})}),e.jsx(d,{})]})}),e.jsx("h3",{className:"text-lg font-semibold mt-6",children:"Surgery Capabilities"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(i,{control:n.control,name:"sxEmergencySoft",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(r,{className:"text-base",children:"Emergency Soft Tissue Surgery"})}),e.jsx(t,{children:e.jsx(c,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"sxEmergencyOrtho",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(r,{className:"text-base",children:"Emergency Orthopedic Surgery"})}),e.jsx(t,{children:e.jsx(c,{checked:s.value||!1,onCheckedChange:s.onChange})})]})})]}),e.jsx("h3",{className:"text-lg font-semibold mt-6",children:"Life Support Equipment"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(i,{control:n.control,name:"oxygenTherapy",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(r,{className:"text-base",children:"Oxygen Therapy / Tanks"})}),e.jsx(t,{children:e.jsx(c,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"ventilator",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(r,{className:"text-base",children:"Ventilator / Respirator"})}),e.jsx(t,{children:e.jsx(c,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"bloodTransfusion",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(r,{className:"text-base",children:"Blood Bank (transfusion support)"})}),e.jsx(t,{children:e.jsx(c,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"imagingMRI",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(r,{className:"text-base",children:"MRI Imaging"})}),e.jsx(t,{children:e.jsx(c,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"endoscopy",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(r,{className:"text-base",children:"Endoscopy"})}),e.jsx(t,{children:e.jsx(c,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"dialysis",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(r,{className:"text-base",children:"Dialysis / Renal Support"})}),e.jsx(t,{children:e.jsx(c,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"defibrillator",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(r,{className:"text-base",children:"Defibrillator / AED"})}),e.jsx(t,{children:e.jsx(c,{checked:s.value||!1,onCheckedChange:s.onChange})})]})})]}),e.jsx(i,{control:n.control,name:"anaesMonitoring",render:({field:s})=>e.jsxs(l,{children:[e.jsx(r,{children:"Anesthesia Monitoring"}),e.jsx(t,{children:e.jsx(u,{...s,value:s.value||"",placeholder:"e.g., Advanced monitoring equipment"})}),e.jsx(d,{})]})}),e.jsx(i,{control:n.control,name:"specialistAvail",render:({field:s})=>e.jsxs(l,{children:[e.jsx(r,{children:"Specialist Availability"}),e.jsx(t,{children:e.jsx(O,{...s,value:s.value||"",placeholder:"List available specialists",rows:3})}),e.jsx(d,{})]})})]}),e.jsxs(B,{value:"operational",className:"space-y-4",children:[e.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md",children:e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-300",children:[e.jsx("strong",{children:"Optional:"})," Share operational details like visiting hours, facilities, and support options to build trust with pet owners."]})}),e.jsx(i,{control:n.control,name:"onSiteVet247",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(r,{className:"text-base",children:"On-Site Vet 24/7"}),e.jsx(z,{children:"Is a veterinarian on-site 24 hours?"})]}),e.jsx(t,{children:e.jsx(c,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"nurse24h",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(r,{className:"text-base",children:"24-Hour Nursing"}),e.jsx(z,{children:"Are nurses available 24 hours?"})]}),e.jsx(t,{children:e.jsx(c,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"triagePolicy",render:({field:s})=>e.jsxs(l,{children:[e.jsx(r,{children:"Triage Policy"}),e.jsx(t,{children:e.jsx(O,{...s,value:s.value||"",placeholder:"Describe triage process",rows:3})}),e.jsx(d,{})]})}),e.jsx(i,{control:n.control,name:"typicalWaitBand",render:({field:s})=>e.jsxs(l,{children:[e.jsx(r,{children:"Typical Wait Time"}),e.jsxs(oe,{onValueChange:s.onChange,value:s.value||"",children:[e.jsx(t,{children:e.jsx(xe,{children:e.jsx(he,{placeholder:"Select wait time"})})}),e.jsxs(ue,{children:[e.jsx(y,{value:"<30min",children:"< 30 minutes"}),e.jsx(y,{value:"30-60min",children:"30-60 minutes"}),e.jsx(y,{value:"1-2hr",children:"1-2 hours"}),e.jsx(y,{value:">2hr",children:"> 2 hours"})]})]}),e.jsx(d,{})]})}),e.jsx(i,{control:n.control,name:"ownerVisitPolicy",render:({field:s})=>e.jsxs(l,{children:[e.jsx(r,{children:"Owner Visiting Policy"}),e.jsx(t,{children:e.jsx(O,{...s,value:s.value||"",placeholder:"Describe visiting hours and policies",rows:3})}),e.jsx(d,{})]})}),e.jsx(i,{control:n.control,name:"recheckWindow",render:({field:s})=>e.jsxs(l,{children:[e.jsx(r,{children:"Recheck Window"}),e.jsx(t,{children:e.jsx(u,{...s,value:s.value||"",placeholder:"e.g., 48 hours"})}),e.jsx(d,{})]})}),e.jsx("h3",{className:"text-lg font-semibold mt-6",children:"Client Support"}),e.jsx(ce,{control:n.control,name:"languages",label:"Languages Spoken",placeholder:"e.g., English, Cantonese, Mandarin, Japanese",description:"Comma-separated list of languages spoken by staff",testId:"input-languages"}),e.jsx("h3",{className:"text-lg font-semibold mt-6",children:"Payment & Insurance"}),e.jsx(i,{control:n.control,name:"admissionDeposit",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(r,{className:"text-base",children:"Requires Admission Deposit"})}),e.jsx(t,{children:e.jsx(c,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"depositBand",render:({field:s})=>e.jsxs(l,{children:[e.jsx(r,{children:"Deposit Range"}),e.jsxs(oe,{onValueChange:s.onChange,value:s.value||"",children:[e.jsx(t,{children:e.jsx(xe,{children:e.jsx(he,{placeholder:"Select deposit range"})})}),e.jsxs(ue,{children:[e.jsx(y,{value:"<5k",children:"< HK$5,000"}),e.jsx(y,{value:"5-10k",children:"HK$5,000 - 10,000"}),e.jsx(y,{value:"10-20k",children:"HK$10,000 - 20,000"}),e.jsx(y,{value:">20k",children:"> HK$20,000"})]})]}),e.jsx(d,{})]})}),e.jsx(i,{control:n.control,name:"refundPolicy",render:({field:s})=>e.jsxs(l,{children:[e.jsx(r,{children:"Refund Policy"}),e.jsx(t,{children:e.jsx(O,{...s,value:s.value||"",placeholder:"Describe refund policy",rows:3})}),e.jsx(d,{})]})}),e.jsx(ce,{control:n.control,name:"payMethods",label:"Payment Methods Accepted",placeholder:"e.g., Cash, Credit Card, PayMe, FPS, Octopus",description:"Comma-separated list of accepted payment methods",testId:"input-pay-methods"}),e.jsx(ce,{control:n.control,name:"insuranceSupport",label:"Insurance Providers Supported",placeholder:"e.g., Blue Cross, OneDegree, Petclaim, Pawpular",description:"Comma-separated list of insurance providers supported",testId:"input-insurance-support"})]})]}),e.jsx(Ze,{children:e.jsx(j,{type:"submit","data-testid":"button-submit",children:f})})]})})}function Fs(){const[n,v]=m.useState(!1),[f,N]=m.useState(!1),[E,b]=m.useState(!1),[C,T]=m.useState(!1),[s,h]=m.useState(null),[w,D]=m.useState(null),[Z,je]=m.useState(null),[X,pe]=m.useState(null),[U,ge]=m.useState(""),[W,be]=m.useState("all"),[L,Q]=m.useState(1),G=20,{toast:p}=Ve(),{data:H,isLoading:Ee}=de({queryKey:["/api/regions"]}),{data:o,isLoading:Te}=de({queryKey:["/api/hospitals"]}),I={total:(o==null?void 0:o.length)??0,verified:((o==null?void 0:o.filter(a=>a.lastVerifiedAt))??[]).length,open247:((o==null?void 0:o.filter(a=>a.open247))??[]).length,withPhotos:((o==null?void 0:o.filter(a=>a.photos&&a.photos.length>0))??[]).length,partners:((o==null?void 0:o.filter(a=>a.isPartner))??[]).length},J=(o==null?void 0:o.filter(a=>{if(U){const x=U.toLowerCase(),g=a.nameEn.toLowerCase().includes(x)||a.nameZh.toLowerCase().includes(x),R=a.addressEn.toLowerCase().includes(x)||a.addressZh.toLowerCase().includes(x);if(!g&&!R)return!1}return!(W!=="all"&&a.regionId!==W)}))??[],F=Math.ceil(J.length/G),ve=J.slice((L-1)*G,L*G),De=()=>{ge(""),be("all"),Q(1)},_=fe({resolver:Ce(Pe),defaultValues:{nameEn:"",nameZh:"",addressEn:"",addressZh:"",slug:"",regionId:"",phone:null,whatsapp:null,email:null,websiteUrl:null,open247:!0,isAvailable:!0,isPartner:!1,latitude:null,longitude:null,photos:[],liveStatus:null,onSiteVet247:null,triagePolicy:null,typicalWaitBand:null,isolationWard:null,ambulanceSupport:null,icuLevel:null,nurse24h:null,ownerVisitPolicy:null,eolSupport:null,imagingXray:null,imagingUS:null,imagingCT:null,sameDayCT:null,inHouseLab:null,extLabCutoff:null,bloodBankAccess:null,sxEmergencySoft:null,sxEmergencyOrtho:null,anaesMonitoring:null,specialistAvail:null,oxygenTherapy:null,ventilator:null,bloodTransfusion:null,imagingMRI:null,endoscopy:null,dialysis:null,defibrillator:null,whatsappTriage:null,parking:null,wheelchairAccess:null,admissionDeposit:null,depositBand:null,recheckWindow:null,refundPolicy:null,speciesAccepted:null,languages:null,payMethods:null,insuranceSupport:null}}),ye=fe({resolver:Ce(Pe)}),Le=()=>{_.reset(),v(!0)},He=a=>{h(a),ye.reset({nameEn:a.nameEn,nameZh:a.nameZh,addressEn:a.addressEn,addressZh:a.addressZh,slug:a.slug,regionId:a.regionId,phone:a.phone||null,whatsapp:a.whatsapp||null,email:a.email||null,websiteUrl:a.websiteUrl||null,open247:a.open247,isAvailable:a.isAvailable,isPartner:a.isPartner,latitude:a.latitude?String(a.latitude):null,longitude:a.longitude?String(a.longitude):null,photos:a.photos||[],liveStatus:a.liveStatus??null,onSiteVet247:a.onSiteVet247??null,triagePolicy:a.triagePolicy??null,typicalWaitBand:a.typicalWaitBand??null,isolationWard:a.isolationWard??null,ambulanceSupport:a.ambulanceSupport??null,icuLevel:a.icuLevel??null,nurse24h:a.nurse24h??null,ownerVisitPolicy:a.ownerVisitPolicy??null,eolSupport:a.eolSupport??null,imagingXray:a.imagingXray??null,imagingUS:a.imagingUS??null,imagingCT:a.imagingCT??null,sameDayCT:a.sameDayCT??null,inHouseLab:a.inHouseLab??null,extLabCutoff:a.extLabCutoff??null,bloodBankAccess:a.bloodBankAccess??null,sxEmergencySoft:a.sxEmergencySoft??null,sxEmergencyOrtho:a.sxEmergencyOrtho??null,anaesMonitoring:a.anaesMonitoring??null,specialistAvail:a.specialistAvail??null,oxygenTherapy:a.oxygenTherapy??null,ventilator:a.ventilator??null,bloodTransfusion:a.bloodTransfusion??null,imagingMRI:a.imagingMRI??null,endoscopy:a.endoscopy??null,dialysis:a.dialysis??null,defibrillator:a.defibrillator??null,whatsappTriage:a.whatsappTriage??null,parking:a.parking??null,wheelchairAccess:a.wheelchairAccess??null,admissionDeposit:a.admissionDeposit??null,depositBand:a.depositBand??null,recheckWindow:a.recheckWindow??null,refundPolicy:a.refundPolicy??null,speciesAccepted:a.speciesAccepted??null,languages:a.languages??null,payMethods:a.payMethods??null,insuranceSupport:a.insuranceSupport??null}),N(!0)},Ie=a=>{h(a),b(!0)},Me=async a=>{try{await $("POST","/api/hospitals",a),await K.invalidateQueries({queryKey:["/api/hospitals"]}),v(!1),_.reset(),p({title:"Success",description:"Hospital added successfully"})}catch(x){p({title:"Error",description:x.message||"Failed to add hospital",variant:"destructive"})}},Oe=async a=>{if(s)try{await $("PATCH",`/api/hospitals/${s.id}`,a),await K.invalidateQueries({queryKey:["/api/hospitals"]}),N(!1),h(null),p({title:"Success",description:"Hospital updated successfully"})}catch(x){p({title:"Error",description:x.message||"Failed to update hospital",variant:"destructive"})}},Fe=async()=>{if(s)try{await $("DELETE",`/api/hospitals/${s.id}`),await K.invalidateQueries({queryKey:["/api/hospitals"]}),b(!1),h(null),p({title:"Success",description:"Hospital deleted successfully"})}catch(a){p({title:"Error",description:a.message||"Failed to delete hospital",variant:"destructive"})}},Y=we({mutationFn:async a=>{const g=await(await $("POST",`/api/hospitals/${a}/generate-code`,{})).json();return{code:g.code,expiresAt:g.expiresAt}},onSuccess:a=>{je(a.code),pe(a.expiresAt),T(!0),p({title:"Code generated successfully"})},onError:a=>{p({title:"Error generating code",description:a.message,variant:"destructive"})}}),ee=we({mutationFn:async({hospitalId:a,isPartner:x})=>{await $("PATCH",`/api/hospitals/${a}`,{isPartner:x})},onSuccess:(a,x)=>{K.invalidateQueries({queryKey:["/api/hospitals"]}),p({title:x.isPartner?"Partner Added":"Partner Removed",description:x.isPartner?"Hospital is now a PetSOS Partner":"Hospital is no longer a PetSOS Partner"})},onError:a=>{p({title:"Error updating partner status",description:a.message,variant:"destructive"})}});return Te||Ee?e.jsx("div",{className:"container mx-auto p-6 max-w-7xl",children:e.jsx("div",{className:"flex justify-center items-center h-96",children:e.jsx(te,{className:"h-8 w-8 animate-spin text-primary"})})}):e.jsxs("div",{className:"container mx-auto p-6 max-w-7xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx(Be,{href:"/admin",children:e.jsxs(j,{variant:"ghost",size:"sm","data-testid":"button-back",children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Dashboard"]})}),e.jsx("h1",{className:"text-3xl font-bold","data-testid":"heading-admin-hospitals",children:"Admin: Hospital Management"})]}),e.jsx("p",{className:"text-muted-foreground",children:"Manage 24-hour animal hospital profiles with photos and facilities"})]}),e.jsxs(j,{onClick:Le,"data-testid":"button-add-hospital",children:[e.jsx(rs,{className:"h-4 w-4 mr-2"}),"Add Hospital"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:[e.jsxs(k,{children:[e.jsxs(P,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(A,{className:"text-sm font-medium",children:"Total Hospitals"}),e.jsx(ts,{className:"h-4 w-4 text-blue-500"})]}),e.jsx(S,{children:e.jsx("div",{className:"text-2xl font-bold",children:I.total})})]}),e.jsxs(k,{children:[e.jsxs(P,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(A,{className:"text-sm font-medium",children:"Open 24/7"}),e.jsx(Ne,{className:"h-4 w-4 text-green-500"})]}),e.jsx(S,{children:e.jsx("div",{className:"text-2xl font-bold",children:I.open247})})]}),e.jsxs(k,{children:[e.jsxs(P,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(A,{className:"text-sm font-medium",children:"Partners"}),e.jsx(ie,{className:"h-4 w-4 text-amber-500"})]}),e.jsx(S,{children:e.jsx("div",{className:"text-2xl font-bold",children:I.partners})})]}),e.jsxs(k,{children:[e.jsxs(P,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(A,{className:"text-sm font-medium",children:"Verified"}),e.jsx(ke,{className:"h-4 w-4 text-emerald-500"})]}),e.jsx(S,{children:e.jsx("div",{className:"text-2xl font-bold",children:I.verified})})]}),e.jsxs(k,{children:[e.jsxs(P,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(A,{className:"text-sm font-medium",children:"With Photos"}),e.jsx(me,{className:"h-4 w-4 text-purple-500"})]}),e.jsx(S,{children:e.jsx("div",{className:"text-2xl font-bold",children:I.withPhotos})})]})]}),e.jsx(k,{className:"mb-6",children:e.jsxs(S,{className:"pt-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(is,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(u,{placeholder:"Search by name or address...",value:U,onChange:a=>ge(a.target.value),className:"pl-10","data-testid":"input-search"})]}),e.jsxs(oe,{value:W,onValueChange:be,children:[e.jsx(xe,{className:"w-full md:w-48",children:e.jsx(he,{placeholder:"All Regions"})}),e.jsxs(ue,{children:[e.jsx(y,{value:"all",children:"All Regions"}),H==null?void 0:H.map(a=>e.jsx(y,{value:a.id,children:a.nameEn},a.id))]})]}),(U||W!=="all")&&e.jsxs(j,{variant:"outline",onClick:De,children:[e.jsx($e,{className:"h-4 w-4 mr-2"}),"Clear"]})]}),e.jsxs("div",{className:"mt-4 text-sm text-muted-foreground",children:["Showing ",J.length," of ",I.total," hospitals"]})]})}),e.jsxs(k,{children:[e.jsxs(P,{children:[e.jsx(A,{children:"Hospitals"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Page ",L," of ",F||1]})]}),e.jsxs(S,{children:[e.jsxs("div",{className:"space-y-4",children:[ve.map(a=>{const x=H==null?void 0:H.find(R=>R.id===a.regionId),g=a.photos;return e.jsx("div",{className:"p-4 border rounded-lg hover:bg-accent/50 transition-colors","data-testid":`hospital-card-${a.id}`,children:e.jsxs("div",{className:"flex gap-4",children:[g&&g.length>0&&e.jsx("img",{src:g[0],alt:a.nameEn,className:"w-24 h-24 object-cover rounded-lg flex-shrink-0",onError:R=>{R.target.style.display="none"}}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:[e.jsx("h3",{className:"text-lg font-semibold",children:a.nameEn}),e.jsx(q,{variant:"outline",children:(x==null?void 0:x.code)||"N/A"}),a.open247&&e.jsx(q,{variant:"default",className:"bg-green-600",children:"24hrs"}),a.isPartner&&e.jsxs(q,{className:"bg-gradient-to-r from-purple-600 to-blue-600 text-white",children:[e.jsx(ie,{className:"h-3 w-3 mr-1"}),"Partner"]}),a.lastVerifiedAt&&e.jsxs(q,{variant:"secondary",children:[e.jsx(ke,{className:"h-3 w-3 mr-1"}),"Verified"]}),g&&g.length>0&&e.jsxs(q,{variant:"outline",children:[e.jsx(me,{className:"h-3 w-3 mr-1"}),g.length," ",g.length===1?"photo":"photos"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:a.nameZh}),e.jsx("p",{className:"text-sm mb-1",children:a.addressEn}),e.jsxs("div",{className:"flex items-center gap-4 text-sm mt-2",children:[a.phone&&e.jsxs("span",{className:"text-muted-foreground",children:["ðŸ“ž ",a.phone]}),a.latitude&&a.longitude&&e.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[e.jsx(qe,{className:"h-3 w-3"}),Number(a.latitude).toFixed(4),", ",Number(a.longitude).toFixed(4)]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{variant:a.isPartner?"default":"outline",size:"sm",onClick:()=>ee.mutate({hospitalId:a.id,isPartner:!a.isPartner}),"data-testid":`button-toggle-partner-${a.id}`,title:a.isPartner?"Remove as Partner":"Make Partner",disabled:ee.isPending,className:a.isPartner?"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700":"",children:ee.isPending?e.jsx(te,{className:"h-4 w-4 animate-spin"}):e.jsx(ie,{className:`h-4 w-4 ${a.isPartner?"fill-current":""}`})}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>{D(a),je(null),Y.mutate(a.id)},"data-testid":`button-generate-code-${a.id}`,title:a.slug?"Generate Access Code":"Add URL slug first to enable access codes",disabled:Y.isPending||!a.slug,children:Y.isPending?e.jsx(te,{className:"h-4 w-4 animate-spin"}):e.jsx(ms,{className:"h-4 w-4"})}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>He(a),"data-testid":`button-edit-${a.id}`,children:e.jsx(cs,{className:"h-4 w-4"})}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>Ie(a),"data-testid":`button-delete-${a.id}`,children:e.jsx(ds,{className:"h-4 w-4 text-destructive"})})]})]})},a.id)}),ve.length===0&&e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"No hospitals found"})]}),F>1&&e.jsxs("div",{className:"flex justify-center gap-2 mt-6",children:[e.jsx(j,{variant:"outline",size:"sm",onClick:()=>Q(a=>Math.max(1,a-1)),disabled:L===1,children:"Previous"}),e.jsxs("span",{className:"flex items-center px-4 text-sm text-muted-foreground",children:["Page ",L," of ",F]}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>Q(a=>Math.min(F,a+1)),disabled:L===F,children:"Next"})]})]})]}),e.jsx(se,{open:n,onOpenChange:v,children:e.jsxs(ae,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ne,{children:[e.jsx(le,{children:"Add New Hospital"}),e.jsx(re,{children:"Enter the hospital details including photos and facilities"})]}),e.jsx(Ae,{form:_,onSubmit:Me,submitLabel:"Add Hospital"})]})}),e.jsx(se,{open:f,onOpenChange:N,children:e.jsxs(ae,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ne,{children:[e.jsx(le,{children:"Edit Hospital"}),e.jsx(re,{children:"Update the hospital details"})]}),e.jsx(Ae,{form:ye,onSubmit:Oe,submitLabel:"Save Changes"})]})}),e.jsx(Qe,{open:E,onOpenChange:b,children:e.jsxs(Ge,{children:[e.jsxs(Je,{children:[e.jsx(_e,{children:"Are you absolutely sure?"}),e.jsxs(Ye,{children:["This will permanently delete ",e.jsx("strong",{children:s==null?void 0:s.nameEn}),". This action cannot be undone."]})]}),e.jsxs(es,{children:[e.jsx(ss,{children:"Cancel"}),e.jsx(as,{onClick:Fe,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90","data-testid":"button-confirm-delete",children:"Delete"})]})]})}),e.jsx(se,{open:C,onOpenChange:a=>{T(a),a||pe(null)},children:e.jsxs(ae,{className:"max-w-md",children:[e.jsxs(ne,{children:[e.jsx(le,{children:"Generated Code"}),e.jsx(re,{children:"Share this code with the hospital owner to access their edit link"})]}),Z&&w&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Access Code:"}),e.jsx("p",{className:"text-3xl font-mono font-bold text-red-600 dark:text-red-400 tracking-widest",children:Z}),X&&e.jsxs("p",{className:"text-xs text-orange-600 dark:text-orange-400 mt-3","data-testid":"text-code-expiry",children:[e.jsx(Ne,{className:"inline h-3 w-3 mr-1"}),"Expires: ",new Date(X).toLocaleDateString()," (",new Date(X).toLocaleTimeString(),")"]})]}),e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Edit Link:"}),e.jsx("p",{className:"text-sm font-mono break-all text-blue-600 dark:text-blue-400",children:`${window.location.origin}/hospital/edit/${w.slug}`})]}),e.jsx("div",{className:"p-3 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-md",children:e.jsxs("p",{className:"text-xs text-amber-800 dark:text-amber-300",children:[e.jsx("strong",{children:"Important:"})," This code expires in 48 hours. After expiration, a new code must be generated."]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(j,{variant:"outline",onClick:()=>{navigator.clipboard.writeText(Z),p({title:"Code copied to clipboard"})},className:"flex-1","data-testid":"button-copy-code",children:[e.jsx(os,{className:"h-4 w-4 mr-2"}),"Copy Code"]}),e.jsxs(j,{variant:"outline",onClick:()=>{const a=`${window.location.origin}/hospital/edit/${w.slug}`;navigator.clipboard.writeText(a),p({title:"Link copied to clipboard"})},className:"flex-1","data-testid":"button-copy-link",children:[e.jsx(xs,{className:"h-4 w-4 mr-2"}),"Copy Link"]})]})]})]})})]})}export{Fs as default};
