import{c as z,e as Xe,f as Ze,a as We,u as Ue,a2 as ea,h as f,r as c,g as aa,a3 as sa,j as e,U as O,B as i,C as j,q as b,t as y,v,b as k,F as ta,w as N,x as w,y as C,z as _,I as Z,A,N as ra,E as he,G as ge,H as ue,J as fe,K as W,M as ia,a4 as na,d as la,a5 as je,a6 as be,a7 as ye,a8 as oa,X as U,Y as ee,_ as ae,$ as se,a0 as te,a9 as ve,aa as I,ab as o,ac as ke,a1 as re,o as da,s as R,ad as ca,ae as pa,O as x,Q as S}from"./index-Dv-87GdI.js";import{u as h}from"./useMutation-DhbY-5L1.js";import{A as ma,h as xa,a as ha,b as ga,c as ua,d as fa,e as ja,f as ba,g as ya}from"./alert-dialog-phmvSypz.js";import{A as Ne,a as we,b as Ce,c as _e}from"./accordion-BdzDQEi3.js";import{S as P}from"./switch-DNY1qyBa.js";import{A as va}from"./arrow-left-BiOU8dRi.js";import{P as $}from"./paw-print-DGN0yKnL.js";import{S as ka}from"./square-pen-3cMkxRSJ.js";import{U as Ae}from"./user-DwTOldS-.js";import{M as Na}from"./mail-ODTLULHl.js";import{G as Se}from"./globe-d27vOE1C.js";import{R as wa}from"./refresh-cw-BE3VGX5S.js";import{C as Pe}from"./copy-D0zamOfW.js";import{S as Ca}from"./shield-BfDKYE08.js";import{D as _a}from"./download-D2XgrGr7.js";import{T as Aa}from"./trash-2-DER-1qtk.js";import"./index-3MSBdfhq.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sa=z("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pa=z("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=z("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=z("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]),Da=t=>da({name:R().min(1,t("profile.validation.name","Name is required")).optional().or(ca("")),email:R().email(t("profile.validation.email","Please enter a valid email")),phone:R().min(1,t("profile.validation.phone_required","Phone number is required")).min(8,t("profile.validation.phone_length","Please enter a valid phone number (at least 8 digits)")),languagePreference:pa(["en","zh-HK"]),regionPreference:R().optional()});function Xa(){const{user:t,isLoading:Fe}=Xe(),[,ie]=Ze(),{toast:n}=We(),{t:a,language:Te}=Ue(),{setLanguage:De}=ea(),Le=Da(a),{data:d,isLoading:Me}=f({queryKey:["/api/users",t==null?void 0:t.id],enabled:!!(t!=null&&t.id)}),{data:Ee=[]}=f({queryKey:["/api/regions"]}),{data:F=[],isLoading:qe}=f({queryKey:["/api/users",t==null?void 0:t.id,"pets"],enabled:!!(t!=null&&t.id)}),{data:l,isLoading:Oe}=f({queryKey:["/api/users",t==null?void 0:t.id,"notification-preferences"],enabled:!!(t!=null&&t.id)}),p=h({mutationFn:async s=>await(await x("PATCH",`/api/users/${t==null?void 0:t.id}/notification-preferences`,s)).json(),onSuccess:()=>{S.invalidateQueries({queryKey:["/api/users",t==null?void 0:t.id,"notification-preferences"]}),n({title:a("profile.notifications.success","Notification preferences updated"),description:a("profile.notifications.success_desc","Your notification settings have been saved.")})},onError:s=>{n({title:a("profile.notifications.error","Update failed"),description:s.message,variant:"destructive"})}}),g=(s,r)=>{p.mutate({[s]:r})},[Ie,T]=c.useState(!1),[D,Re]=c.useState(null),[B,K]=c.useState(""),[L,ne]=c.useState(null),[$e,M]=c.useState(!1),[ze,le]=c.useState(!1),[Be,E]=c.useState(!1),[H,V]=c.useState(""),oe=(d==null?void 0:d.role)==="admin",{data:q,isLoading:Ke}=f({queryKey:["/api/auth/2fa/status"],enabled:!!(t!=null&&t.id)&&oe}),Y=h({mutationFn:async()=>await(await x("POST","/api/auth/2fa/setup",{})).json(),onSuccess:s=>{Re({qrCode:s.qrCode,secret:s.secret}),T(!0)},onError:s=>{n({title:a("profile.2fa.setup_error","Setup failed"),description:s.message,variant:"destructive"})}}),Q=h({mutationFn:async s=>await(await x("POST","/api/auth/2fa/verify",{code:s})).json(),onSuccess:s=>{ne(s.backupCodes),M(!0),T(!1),K(""),S.invalidateQueries({queryKey:["/api/auth/2fa/status"]}),n({title:a("profile.2fa.enabled_title","2FA Enabled"),description:a("profile.2fa.enabled_desc","Two-factor authentication has been enabled. Save your backup codes.")})},onError:s=>{n({title:a("profile.2fa.verify_error","Verification failed"),description:s.message,variant:"destructive"})}}),G=h({mutationFn:async s=>await(await x("POST","/api/auth/2fa/disable",{code:s})).json(),onSuccess:()=>{E(!1),V(""),S.invalidateQueries({queryKey:["/api/auth/2fa/status"]}),n({title:a("profile.2fa.disabled_title","2FA Disabled"),description:a("profile.2fa.disabled_desc","Two-factor authentication has been disabled.")})},onError:s=>{n({title:a("profile.2fa.disable_error","Disable failed"),description:s.message,variant:"destructive"})}}),de=h({mutationFn:async s=>await(await x("POST","/api/auth/2fa/backup-codes",{code:s})).json(),onSuccess:s=>{ne(s.backupCodes),M(!0),S.invalidateQueries({queryKey:["/api/auth/2fa/status"]}),n({title:a("profile.2fa.codes_regenerated","Backup Codes Regenerated"),description:a("profile.2fa.codes_regenerated_desc","New backup codes have been generated. Save them securely.")})},onError:s=>{n({title:a("profile.2fa.regenerate_error","Failed to regenerate codes"),description:s.message,variant:"destructive"})}}),He=()=>{L&&(navigator.clipboard.writeText(L.join(`
`)),le(!0),setTimeout(()=>le(!1),2e3))},m=aa({resolver:sa(Le),defaultValues:{name:"",email:"",phone:"",languagePreference:"en",regionPreference:void 0},values:d?{name:d.name||"",email:d.email||"",phone:d.phone||"",languagePreference:d.languagePreference||"en",regionPreference:d.regionPreference||void 0}:void 0}),J=h({mutationFn:async s=>await(await x("PATCH",`/api/users/${t==null?void 0:t.id}`,s)).json(),onSuccess:(s,r)=>{S.invalidateQueries({queryKey:["/api/users",t==null?void 0:t.id]}),r.languagePreference&&De(r.languagePreference),n({title:a("profile.success.title","Profile updated successfully!"),description:a("profile.success.desc","Your changes have been saved.")})},onError:s=>{n({title:a("profile.error.title","Update failed"),description:s.message,variant:"destructive"})}}),Ve=s=>{J.mutate(s)},Ye=async()=>{try{const s=await fetch("/api/users/export",{credentials:"include"});if(!s.ok){const xe=s.headers.get("Content-Type");if(xe&&xe.includes("application/json")){const Je=await s.json();throw new Error(Je.message||"Failed to export data")}throw new Error("Failed to export data")}const r=s.headers.get("Content-Type");if(!r||!r.includes("application/json"))throw new Error("Invalid response format");const ce=s.headers.get("Content-Disposition");if(!ce)throw new Error("Invalid download response");let pe=`petsos-data-export-${new Date().toISOString()}.json`;const X=ce.match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/);X&&X[1]&&(pe=X[1].replace(/['"]/g,""));const Ge=await s.blob(),me=window.URL.createObjectURL(Ge),u=document.createElement("a");u.href=me,u.download=pe,document.body.appendChild(u),u.click(),window.URL.revokeObjectURL(me),document.body.removeChild(u),n({title:a("profile.export.success_title","Data exported successfully"),description:a("profile.export.success_desc","Your personal data has been downloaded.")})}catch{n({title:a("profile.export.error_title","Export failed"),description:a("profile.export.error_desc","Failed to download your data. Please try again."),variant:"destructive"})}},Qe=async()=>{try{const s=await x("DELETE","/api/users/gdpr-delete"),r=await s.json();if(!s.ok)throw new Error(r.message||"Failed to delete account");n({title:a("profile.delete.success_title","Account deleted"),description:a("profile.delete.success_desc","Your account and all data have been permanently deleted.")}),setTimeout(()=>{ie("/")},2e3)}catch(s){n({title:a("profile.delete.error_title","Deletion failed"),description:s.message||a("profile.delete.error_desc","Failed to delete your account. Please try again."),variant:"destructive"})}};return Fe||Me?e.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-900 flex items-center justify-center",children:e.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:a("loading.profile","Loading profile...")})}):t?e.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-900 py-8",children:e.jsxs("div",{className:"max-w-2xl mx-auto px-4",children:[e.jsx("div",{className:"mb-6",children:e.jsx(O,{href:"/",children:e.jsxs(i,{variant:"ghost",size:"sm","data-testid":"button-back",children:[e.jsx(va,{className:"w-4 h-4 mr-2"}),a("button.back_home","Back to Home")]})})}),e.jsxs(j,{className:"border-2 border-green-200 dark:border-green-800 bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-950 dark:to-emerald-950",children:[e.jsxs(b,{children:[e.jsxs(y,{className:"flex items-center gap-2 text-green-800 dark:text-green-300",children:[e.jsx($,{className:"w-6 h-6"}),a("profile.pets_cta.title","Your Pets")," ",F.length>0&&`(${F.length})`]}),e.jsx(v,{className:"text-green-700 dark:text-green-400",children:a("profile.pets_cta.desc","Save your pet profiles for faster emergency help")})]}),e.jsx(k,{className:"space-y-4",children:qe?e.jsx("div",{className:"text-sm text-green-700 dark:text-green-400",children:a("loading.pets","Loading pets...")}):F.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-3",children:F.map(s=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white dark:bg-gray-800 rounded-lg border border-green-200 dark:border-green-800","data-testid":`pet-card-${s.id}`,children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center text-2xl",children:s.species==="dog"?"ðŸ•":s.species==="cat"?"ðŸˆ":s.species==="bird"?"ðŸ¦œ":s.species==="rabbit"?"ðŸ°":s.species==="hamster"?"ðŸ¹":"ðŸ¾"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-gray-100","data-testid":`pet-name-${s.id}`,children:s.name}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":`pet-info-${s.id}`,children:[s.breed," ",s.age&&`â€¢ ${s.age} ${a("pets.years","years")}`]})]}),e.jsx(O,{href:"/pets",children:e.jsx(i,{variant:"ghost",size:"sm","data-testid":`button-edit-pet-${s.id}`,children:e.jsx(ka,{className:"w-4 h-4"})})})]},s.id))}),e.jsx(O,{href:"/pets",children:e.jsxs(i,{className:"w-full bg-green-600 hover:bg-green-700 text-white dark:bg-green-700 dark:hover:bg-green-600",size:"lg","data-testid":"button-add-pet",children:[e.jsx($,{className:"w-5 h-5 mr-2"}),a("profile.pets_cta.add_another","Add Another Pet")]})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-3 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center",children:e.jsx($,{className:"w-8 h-8 text-green-600 dark:text-green-400"})}),e.jsx("h4",{className:"font-semibold text-green-800 dark:text-green-300 mb-2",children:a("profile.pets_empty.title","No pets yet")}),e.jsx("p",{className:"text-sm text-green-700 dark:text-green-400 mb-4",children:a("profile.pets_empty.desc","Add your first furry kid for faster emergency help. It only takes 30 seconds!")})]}),e.jsx(O,{href:"/pets",children:e.jsxs(i,{className:"w-full bg-green-600 hover:bg-green-700 text-white dark:bg-green-700 dark:hover:bg-green-600",size:"lg","data-testid":"button-add-first-pet",children:[e.jsx($,{className:"w-5 h-5 mr-2"}),a("profile.pets_cta.button","Add or Manage Pets")]})})]})})]}),e.jsxs(j,{className:"mt-6",children:[e.jsxs(b,{children:[e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-6 h-6"}),a("profile.title","My Profile")]}),e.jsx(v,{children:a("profile.desc","Manage your account information and preferences")})]}),e.jsx(k,{children:e.jsx(ta,{...m,children:e.jsxs("form",{onSubmit:m.handleSubmit(Ve),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(N,{control:m.control,name:"name",render:({field:s})=>e.jsxs(w,{children:[e.jsx(C,{children:a("profile.name","Name")}),e.jsx(_,{children:e.jsxs("div",{className:"relative",children:[e.jsx(Ae,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400 dark:text-gray-500"}),e.jsx(Z,{...s,className:"pl-10",placeholder:a("profile.name_placeholder","Enter your name"),"data-testid":"input-name"})]})}),e.jsx(A,{})]})}),e.jsx(N,{control:m.control,name:"email",render:({field:s})=>e.jsxs(w,{children:[e.jsx(C,{children:a("profile.email","Email")}),e.jsx(_,{children:e.jsxs("div",{className:"relative",children:[e.jsx(Na,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400 dark:text-gray-500"}),e.jsx(Z,{...s,type:"email",className:"pl-10",placeholder:a("profile.email_placeholder","you@example.com"),"data-testid":"input-email"})]})}),e.jsx(A,{})]})}),e.jsx(N,{control:m.control,name:"phone",render:({field:s})=>e.jsxs(w,{children:[e.jsxs(C,{children:[a("profile.phone","Phone Number"),e.jsx("span",{className:"text-red-600 dark:text-red-500 ml-1",children:"*"})]}),e.jsx(_,{children:e.jsxs("div",{className:"relative",children:[e.jsx(ra,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400 dark:text-gray-500"}),e.jsx(Z,{...s,type:"tel",className:"pl-10",placeholder:a("profile.phone_placeholder","+852 1234 5678"),"data-testid":"input-phone",required:!0})]})}),e.jsx(A,{})]})})]}),e.jsx(Ne,{type:"single",collapsible:!0,className:"border rounded-lg",children:e.jsxs(we,{value:"settings",className:"border-0",children:[e.jsx(Ce,{className:"px-4 hover:no-underline","data-testid":"accordion-settings",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-4 h-4"}),e.jsx("span",{children:a("profile.settings","Language & Region Settings")})]})}),e.jsxs(_e,{className:"px-4 pb-4 space-y-4",children:[e.jsx(N,{control:m.control,name:"languagePreference",render:({field:s})=>e.jsxs(w,{children:[e.jsx(C,{children:a("profile.language","Language Preference")}),e.jsxs(he,{onValueChange:s.onChange,value:s.value,children:[e.jsx(_,{children:e.jsxs(ge,{"data-testid":"select-language",children:[e.jsx(Se,{className:"w-4 h-4 mr-2 text-gray-400 dark:text-gray-500"}),e.jsx(ue,{placeholder:a("profile.language_placeholder","Select language")})]})}),e.jsxs(fe,{children:[e.jsx(W,{value:"en","data-testid":"option-en",children:"English"}),e.jsx(W,{value:"zh-HK","data-testid":"option-zh",children:"ç¹é«”ä¸­æ–‡"})]})]}),e.jsx(A,{})]})}),e.jsx(N,{control:m.control,name:"regionPreference",render:({field:s})=>e.jsxs(w,{children:[e.jsx(C,{children:a("profile.region","Region Preference")}),e.jsxs(he,{onValueChange:s.onChange,value:s.value,children:[e.jsx(_,{children:e.jsxs(ge,{"data-testid":"select-region",children:[e.jsx(ia,{className:"w-4 h-4 mr-2 text-gray-400 dark:text-gray-500"}),e.jsx(ue,{placeholder:a("profile.region_placeholder","Select region")})]})}),e.jsx(fe,{children:Ee.map(r=>e.jsx(W,{value:r.id,"data-testid":`option-region-${r.code}`,children:Te==="en"?r.nameEn:r.nameZh},r.id))})]}),e.jsx(A,{})]})})]})]})}),e.jsxs(i,{type:"submit",className:"w-full",disabled:J.isPending,"data-testid":"button-save-profile",children:[e.jsx(Fa,{className:"w-4 h-4 mr-2"}),J.isPending?a("profile.saving","Saving..."):a("profile.save","Save Changes")]})]})})})]}),e.jsxs(j,{className:"mt-6",children:[e.jsxs(b,{children:[e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(na,{className:"w-6 h-6"}),a("profile.notifications.title","Notification Preferences")]}),e.jsx(v,{children:a("profile.notifications.desc","Control what types of notifications you receive")})]}),e.jsx(k,{children:Oe?e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("loading.notifications","Loading notification preferences...")}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(la,{className:"w-5 h-5 text-red-600 dark:text-red-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:a("profile.notifications.emergency_alerts","Emergency Alerts")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("profile.notifications.emergency_alerts_desc","Critical notifications about your emergency requests")})]})]}),e.jsx(P,{checked:(l==null?void 0:l.emergencyAlerts)??!0,onCheckedChange:s=>g("emergencyAlerts",s),disabled:p.isPending,"data-testid":"switch-emergency-alerts"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Pa,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:a("profile.notifications.general_updates","General Updates")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("profile.notifications.general_updates_desc","Platform announcements and service updates")})]})]}),e.jsx(P,{checked:(l==null?void 0:l.generalUpdates)??!0,onCheckedChange:s=>g("generalUpdates",s),disabled:p.isPending,"data-testid":"switch-general-updates"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-amber-50 dark:bg-amber-900/20 rounded-lg border border-amber-200 dark:border-amber-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(je,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:a("profile.notifications.system_alerts","System Alerts")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("profile.notifications.system_alerts_desc","Maintenance notices and security alerts")})]})]}),e.jsx(P,{checked:(l==null?void 0:l.systemAlerts)??!0,onCheckedChange:s=>g("systemAlerts",s),disabled:p.isPending,"data-testid":"switch-system-alerts"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Sa,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:a("profile.notifications.vet_tips","Veterinary Tips")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("profile.notifications.vet_tips_desc","Pet health tips and educational content")})]})]}),e.jsx(P,{checked:(l==null?void 0:l.vetTips)??!0,onCheckedChange:s=>g("vetTips",s),disabled:p.isPending,"data-testid":"switch-vet-tips"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-200 dark:border-purple-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ta,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:a("profile.notifications.promotions","Promotions & Offers")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("profile.notifications.promotions_desc","Special offers from partner clinics and hospitals")})]})]}),e.jsx(P,{checked:(l==null?void 0:l.promotions)??!1,onCheckedChange:s=>g("promotions",s),disabled:p.isPending,"data-testid":"switch-promotions"})]}),p.isPending&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center",children:a("profile.notifications.saving","Saving preferences...")})]})})]}),oe&&e.jsxs(j,{className:"mt-6 border-2 border-amber-200 dark:border-amber-800",children:[e.jsxs(b,{children:[e.jsxs(y,{className:"flex items-center gap-2 text-amber-700 dark:text-amber-400",children:[e.jsx(be,{className:"w-6 h-6"}),a("profile.2fa.title","Two-Factor Authentication")]}),e.jsx(v,{children:a("profile.2fa.desc","Add an extra layer of security to your admin account")})]}),e.jsx(k,{children:Ke?e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("loading.2fa","Loading 2FA status...")}):q!=null&&q.enabled?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-green-100 dark:bg-green-800 flex items-center justify-center",children:e.jsx(ye,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-green-800 dark:text-green-300",children:a("profile.2fa.enabled_status","2FA is enabled")}),e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400",children:a("profile.2fa.backup_count",`${q.backupCodesCount} backup codes remaining`)})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(i,{variant:"outline",className:"flex-1",onClick:()=>{const s=prompt(a("profile.2fa.enter_code","Enter your 2FA code to regenerate backup codes:"));s&&de.mutate(s)},disabled:de.isPending,"data-testid":"button-regenerate-backup-codes",children:[e.jsx(wa,{className:"w-4 h-4 mr-2"}),a("profile.2fa.regenerate_codes","New Backup Codes")]}),e.jsxs(i,{variant:"destructive",className:"flex-1",onClick:()=>E(!0),"data-testid":"button-disable-2fa",children:[e.jsx(be,{className:"w-4 h-4 mr-2"}),a("profile.2fa.disable_button","Disable 2FA")]})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-amber-50 dark:bg-amber-900/20 rounded-lg border border-amber-200 dark:border-amber-800",children:e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-300",children:a("profile.2fa.not_enabled","Two-factor authentication adds an extra layer of security by requiring a code from your authenticator app when logging in.")})}),e.jsxs(i,{onClick:()=>Y.mutate(),disabled:Y.isPending,className:"w-full bg-amber-600 hover:bg-amber-700 text-white","data-testid":"button-enable-2fa",children:[e.jsx(oa,{className:"w-4 h-4 mr-2"}),Y.isPending?a("profile.2fa.setting_up","Setting up..."):a("profile.2fa.enable_button","Enable Two-Factor Authentication")]})]})})]}),e.jsx(U,{open:Ie,onOpenChange:T,children:e.jsxs(ee,{className:"sm:max-w-md",children:[e.jsxs(ae,{children:[e.jsx(se,{children:a("profile.2fa.setup_title","Set Up Two-Factor Authentication")}),e.jsx(te,{children:a("profile.2fa.setup_desc","Scan the QR code with your authenticator app (Google Authenticator, Authy, etc.)")})]}),e.jsx("div",{className:"space-y-4",children:D&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-center p-4 bg-white rounded-lg",children:e.jsx("img",{src:D.qrCode,alt:"2FA QR Code",className:"w-48 h-48","data-testid":"img-2fa-qrcode"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 text-center",children:a("profile.2fa.manual_entry","Or enter this code manually:")}),e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-100 dark:bg-gray-800 rounded font-mono text-sm",children:[e.jsx("code",{className:"flex-1 text-center","data-testid":"text-2fa-secret",children:D.secret}),e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>navigator.clipboard.writeText(D.secret),"data-testid":"button-copy-secret",children:e.jsx(Pe,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:a("profile.2fa.enter_verification","Enter the 6-digit code from your app:")}),e.jsx("div",{className:"flex justify-center",children:e.jsxs(ve,{value:B,onChange:K,maxLength:6,"data-testid":"input-2fa-code",children:[e.jsxs(I,{children:[e.jsx(o,{index:0}),e.jsx(o,{index:1}),e.jsx(o,{index:2})]}),e.jsx(ke,{}),e.jsxs(I,{children:[e.jsx(o,{index:3}),e.jsx(o,{index:4}),e.jsx(o,{index:5})]})]})})]})]})}),e.jsxs(re,{children:[e.jsx(i,{variant:"outline",onClick:()=>{T(!1),K("")},children:a("common.cancel","Cancel")}),e.jsx(i,{onClick:()=>Q.mutate(B),disabled:B.length!==6||Q.isPending,"data-testid":"button-verify-2fa",children:Q.isPending?a("profile.2fa.verifying","Verifying..."):a("profile.2fa.verify_button","Verify & Enable")})]})]})}),e.jsx(U,{open:$e,onOpenChange:M,children:e.jsxs(ee,{className:"sm:max-w-md",children:[e.jsxs(ae,{children:[e.jsx(se,{children:a("profile.2fa.backup_title","Save Your Backup Codes")}),e.jsx(te,{children:a("profile.2fa.backup_desc","Store these codes securely. Each code can only be used once if you lose access to your authenticator app.")})]}),e.jsxs("div",{className:"space-y-4",children:[L&&e.jsx("div",{className:"grid grid-cols-2 gap-2 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg font-mono text-sm",children:L.map((s,r)=>e.jsx("div",{className:"p-2 bg-white dark:bg-gray-700 rounded text-center","data-testid":`text-backup-code-${r}`,children:s},r))}),e.jsx(i,{onClick:He,variant:"outline",className:"w-full","data-testid":"button-copy-backup-codes",children:ze?e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),a("profile.2fa.copied","Copied!")]}):e.jsxs(e.Fragment,{children:[e.jsx(Pe,{className:"w-4 h-4 mr-2"}),a("profile.2fa.copy_codes","Copy All Codes")]})})]}),e.jsx(re,{children:e.jsx(i,{onClick:()=>M(!1),"data-testid":"button-close-backup-codes",children:a("profile.2fa.saved_codes","I've Saved My Codes")})})]})}),e.jsx(U,{open:Be,onOpenChange:E,children:e.jsxs(ee,{className:"sm:max-w-md",children:[e.jsxs(ae,{children:[e.jsx(se,{children:a("profile.2fa.disable_title","Disable Two-Factor Authentication")}),e.jsx(te,{children:a("profile.2fa.disable_desc","Enter your current 2FA code to disable two-factor authentication. This will make your account less secure.")})]}),e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"flex justify-center",children:e.jsxs(ve,{value:H,onChange:V,maxLength:6,"data-testid":"input-disable-2fa-code",children:[e.jsxs(I,{children:[e.jsx(o,{index:0}),e.jsx(o,{index:1}),e.jsx(o,{index:2})]}),e.jsx(ke,{}),e.jsxs(I,{children:[e.jsx(o,{index:3}),e.jsx(o,{index:4}),e.jsx(o,{index:5})]})]})})}),e.jsxs(re,{children:[e.jsx(i,{variant:"outline",onClick:()=>{E(!1),V("")},children:a("common.cancel","Cancel")}),e.jsx(i,{variant:"destructive",onClick:()=>G.mutate(H),disabled:H.length!==6||G.isPending,"data-testid":"button-confirm-disable-2fa",children:G.isPending?a("profile.2fa.disabling","Disabling..."):a("profile.2fa.confirm_disable","Disable 2FA")})]})]})}),e.jsxs(j,{className:"mt-6 border-gray-200 dark:border-gray-800",children:[e.jsxs(b,{children:[e.jsxs(y,{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx(Ca,{className:"w-5 h-5"}),a("profile.privacy.title","Privacy & Data Rights")]}),e.jsx(v,{children:a("profile.privacy.desc","Manage your personal data and privacy settings")})]}),e.jsx(k,{children:e.jsx(Ne,{type:"single",collapsible:!0,children:e.jsxs(we,{value:"privacy",children:[e.jsx(Ce,{"data-testid":"accordion-privacy",children:a("profile.privacy.expand","View privacy options")}),e.jsxs(_e,{className:"space-y-6 pt-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2 text-sm text-gray-700 dark:text-gray-300",children:a("profile.privacy.export_title","Export Your Data")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:a("profile.privacy.export_desc","Download a copy of all your personal data in JSON format (GDPR/PDPO compliant)")}),e.jsxs(i,{onClick:Ye,variant:"outline",className:"w-full","data-testid":"button-export-data",children:[e.jsx(_a,{className:"w-4 h-4 mr-2"}),a("profile.privacy.export_button","Download My Data")]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h4",{className:"font-medium mb-2 text-sm text-gray-700 dark:text-gray-300",children:a("profile.privacy.delete_title","Delete Your Account")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:a("profile.privacy.delete_desc","Permanently delete your account and all associated data. This action cannot be undone.")}),e.jsxs(ma,{children:[e.jsx(xa,{asChild:!0,children:e.jsxs(i,{variant:"destructive",className:"w-full","data-testid":"button-delete-account",children:[e.jsx(Aa,{className:"w-4 h-4 mr-2"}),a("profile.privacy.delete_button","Delete My Account")]})}),e.jsxs(ha,{children:[e.jsxs(ga,{children:[e.jsxs(ua,{className:"flex items-center gap-2",children:[e.jsx(je,{className:"w-5 h-5 text-red-600 dark:text-red-500"}),a("profile.delete.dialog_title","Are you absolutely sure?")]}),e.jsxs(fa,{children:[a("profile.delete.dialog_desc","This action cannot be undone. This will permanently delete your account and remove all your data from our servers, including:"),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1 text-sm",children:[e.jsx("li",{children:a("profile.delete.dialog_item1","Your profile and contact information")}),e.jsx("li",{children:a("profile.delete.dialog_item2","All saved pets and their medical history")}),e.jsx("li",{children:a("profile.delete.dialog_item3","All emergency request records")}),e.jsx("li",{children:a("profile.delete.dialog_item4","All privacy consents and preferences")})]})]})]}),e.jsxs(ja,{children:[e.jsx(ba,{"data-testid":"button-cancel-delete",children:a("profile.delete.dialog_cancel","Cancel")}),e.jsx(ya,{onClick:Qe,className:"bg-red-600 hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600","data-testid":"button-confirm-delete",children:a("profile.delete.dialog_confirm","Yes, delete my account")})]})]})]})]})]})]})})})]})]})}):(ie("/"),null)}export{Xa as default};
