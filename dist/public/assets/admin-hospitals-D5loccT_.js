import{c as xe,r as m,a as He,h as te,g as ge,j as e,_ as Ie,B as j,C as k,q as I,t as F,b as S,a0 as Fe,I as h,a1 as re,a2 as ie,a3 as ce,a4 as de,a5 as v,av as Me,M as Oe,s as T,F as Ve,ar as Be,as as Re,at as B,aC as R,w as i,x as l,y as t,z as r,A as c,D as K,v as Ue,G as q,H as J,aD as We,a7 as be}from"./index-DSfXJrMH.js";import{u as qe}from"./useMutation-Cr219pYB.js";import{D as Y,a as ee,b as se,c as ae,d as ne,e as $e}from"./dialog-DVNSF8fN.js";import{A as Ke,a as Ze,b as ze,c as Xe,d as Qe,e as Ge,f as _e,g as Je}from"./alert-dialog-wxMcagxD.js";import{T as H}from"./textarea-BoweR-O6.js";import{S as d}from"./switch-Cwa_8bCq.js";import{B as $}from"./badge-i4G4T4_i.js";import{i as Ye}from"./schema-C8dc2iy6.js";import{L as ve}from"./loader-circle-DJFh7Kw2.js";import{A as es}from"./arrow-left-B5_XZNND.js";import{P as ss}from"./plus-DrdFOOcl.js";import{B as as}from"./building-2-BvJiZHTX.js";import{C as ye}from"./circle-check-D_uZXrGr.js";import{S as ns}from"./search-qxig8uw6.js";import{P as ls}from"./pencil-GTbF4EPR.js";import{T as ts}from"./trash-2-DJdNRrn9.js";import{C as rs}from"./copy-CxZilC83.js";import{E as is}from"./external-link-CGotNA9G.js";import{C as cs}from"./circle-x-CZneOd2b.js";import"./index-BKY5CHHC.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=xe("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=xe("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=xe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),xs=n=>{const g=n.split(",").map(y=>y.trim()).filter(y=>y);return g.length>0?g:null},fe=n=>(n||[]).join(", ");function le({control:n,name:g,label:y,placeholder:f,description:A,testId:p}){const{field:N}=We({control:n,name:g}),[E,s]=m.useState(fe(N.value));m.useEffect(()=>{s(fe(N.value))},[N.value]);const x=w=>{const P=w.target.value;s(P),N.onChange(xs(P))};return e.jsxs(l,{children:[e.jsx(t,{children:y}),e.jsx(r,{children:e.jsx(h,{value:E,onChange:x,placeholder:f,"data-testid":p})}),e.jsx(K,{children:A}),e.jsx(c,{})]})}const Ne=Ye.extend({nameEn:T().min(1,"Hospital name (English) is required"),nameZh:T().min(1,"Hospital name (Chinese) is required"),addressEn:T().min(1,"Address (English) is required"),addressZh:T().min(1,"Address (Chinese) is required"),regionId:T().min(1,"Region is required"),slug:T().min(1,"URL slug is required").regex(/^[a-z0-9-]+$/,"Slug must be lowercase letters, numbers, and hyphens only")});function Ce({form:n,onSubmit:g,submitLabel:y}){te({queryKey:["/api/regions"]});const[f,A]=m.useState(""),p=n.watch("photos"),N=()=>{if(f.trim()){const s=p||[];n.setValue("photos",[...s,f.trim()]),A("")}},E=s=>{const x=p||[];n.setValue("photos",x.filter((w,P)=>P!==s))};return e.jsx(Ve,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(g),className:"space-y-4",children:[e.jsxs(Be,{defaultValue:"basic",className:"w-full",children:[e.jsxs(Re,{className:"grid w-full grid-cols-5",children:[e.jsx(B,{value:"basic",children:"Basic Info"}),e.jsx(B,{value:"photos",children:"Photos"}),e.jsx(B,{value:"facilities",children:"Facilities"}),e.jsx(B,{value:"medical",children:"Medical Services"}),e.jsx(B,{value:"operational",children:"Operational"})]}),e.jsxs(R,{value:"basic",className:"space-y-4",children:[e.jsx("div",{className:"mb-4 p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-md",children:e.jsxs("p",{className:"text-sm text-green-800 dark:text-green-300",children:[e.jsx("strong",{children:"Essential Information:"})," Help pet parents contact you quickly during emergencies. Complete this first, then add photos and services to increase visibility."]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(i,{control:n.control,name:"nameEn",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Hospital Name (English) *"}),e.jsx(r,{children:e.jsx(h,{...s,placeholder:"Central Animal Hospital","data-testid":"input-name-en"})}),e.jsx(c,{})]})}),e.jsx(i,{control:n.control,name:"nameZh",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Hospital Name (Chinese) *"}),e.jsx(r,{children:e.jsx(h,{...s,placeholder:"ä¸­ç’°å‹•ç‰©é†«é™¢","data-testid":"input-name-zh"})}),e.jsx(c,{})]})})]}),e.jsx(i,{control:n.control,name:"slug",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"URL Slug *"}),e.jsx(r,{children:e.jsx(h,{...s,placeholder:"central-animal-hospital","data-testid":"input-slug"})}),e.jsx(K,{children:"Lowercase letters, numbers, and hyphens only"}),e.jsx(c,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(i,{control:n.control,name:"addressEn",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Address (English) *"}),e.jsx(r,{children:e.jsx(H,{...s,placeholder:"123 Queen's Road Central",rows:3,"data-testid":"input-address-en"})}),e.jsx(c,{})]})}),e.jsx(i,{control:n.control,name:"addressZh",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Address (Chinese) *"}),e.jsx(r,{children:e.jsx(H,{...s,placeholder:"çš‡åŽå¤§é“ä¸­123è™Ÿ",rows:3,"data-testid":"input-address-zh"})}),e.jsx(c,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(i,{control:n.control,name:"phone",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Phone *"}),e.jsx(r,{children:e.jsx(h,{...s,value:s.value||"",placeholder:"+852 1234 5678","data-testid":"input-phone"})}),e.jsx(c,{})]})}),e.jsx(i,{control:n.control,name:"whatsapp",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"WhatsApp *"}),e.jsx(r,{children:e.jsx(h,{...s,value:s.value||"",placeholder:"+852 1234 5678","data-testid":"input-whatsapp"})}),e.jsx(c,{})]})}),e.jsx(i,{control:n.control,name:"email",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Email *"}),e.jsx(r,{children:e.jsx(h,{...s,value:s.value||"",placeholder:"info@hospital.com",type:"email","data-testid":"input-email"})}),e.jsx(c,{})]})})]})]}),e.jsx(R,{value:"photos",className:"space-y-4",children:e.jsxs(k,{children:[e.jsxs(I,{children:[e.jsx(F,{children:"Hospital Photos"}),e.jsx(Ue,{children:"Add photos of the hospital to help pet owners"})]}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{placeholder:"Enter photo URL (e.g., https://example.com/photo.jpg)",value:f,onChange:s=>A(s.target.value),onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),N()),"data-testid":"input-photo-url"}),e.jsxs(j,{type:"button",onClick:N,"data-testid":"button-add-photo",children:[e.jsx(os,{className:"h-4 w-4 mr-2"}),"Add"]})]}),p&&p.length>0?e.jsx("div",{className:"grid grid-cols-3 gap-4",children:p.map((s,x)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:s,alt:`Hospital photo ${x+1}`,className:"w-full h-32 object-cover rounded-lg border",onError:w=>{w.target.src="/placeholder-image.png"}}),e.jsx(j,{type:"button",variant:"destructive",size:"icon",className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>E(x),"data-testid":`button-remove-photo-${x}`,children:e.jsx(cs,{className:"h-4 w-4"})}),e.jsxs("div",{className:"absolute bottom-2 left-2 bg-black/50 text-white text-xs px-2 py-1 rounded",children:["Photo ",x+1]})]},x))}):e.jsxs("div",{className:"text-center py-12 text-muted-foreground border-2 border-dashed rounded-lg",children:[e.jsx(oe,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No photos added yet"}),e.jsx("p",{className:"text-sm",children:"Add photo URLs above to display them here"})]})]})]})}),e.jsxs(R,{value:"facilities",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(i,{control:n.control,name:"parking",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"Parking Available"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"wheelchairAccess",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"Wheelchair Accessible"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"isolationWard",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"Isolation Ward"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"ambulanceSupport",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"Ambulance Support"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"eolSupport",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"End-of-Life Support"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"whatsappTriage",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"WhatsApp Triage"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})})]}),e.jsx(i,{control:n.control,name:"icuLevel",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"ICU Level"}),e.jsx(r,{children:e.jsx(h,{...s,value:s.value||"",placeholder:"e.g., Level 2 ICU"})}),e.jsx(c,{})]})})]}),e.jsxs(R,{value:"medical",className:"space-y-4",children:[e.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md",children:e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-300",children:[e.jsx("strong",{children:"Optional:"})," Help pet parents find you during emergencies by listing your medical services and capabilities."]})}),e.jsx("h3",{className:"text-lg font-semibold",children:"Imaging Services"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(i,{control:n.control,name:"imagingXray",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"X-Ray"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"imagingUS",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"Ultrasound"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"imagingCT",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"CT Scan"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"sameDayCT",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"Same-Day CT"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})})]}),e.jsx("h3",{className:"text-lg font-semibold mt-6",children:"Laboratory & Testing"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(i,{control:n.control,name:"inHouseLab",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"In-House Laboratory"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"extLabCutoff",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"External Lab Cutoff Time"}),e.jsx(r,{children:e.jsx(h,{...s,value:s.value||"",placeholder:"e.g., 6:00 PM"})})]})})]}),e.jsx(i,{control:n.control,name:"bloodBankAccess",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Blood Bank Access"}),e.jsx(r,{children:e.jsx(h,{...s,value:s.value||"",placeholder:"e.g., On-site blood bank"})}),e.jsx(c,{})]})}),e.jsx("h3",{className:"text-lg font-semibold mt-6",children:"Surgery Capabilities"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(i,{control:n.control,name:"sxEmergencySoft",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"Emergency Soft Tissue Surgery"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"sxEmergencyOrtho",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"Emergency Orthopedic Surgery"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})})]}),e.jsx(i,{control:n.control,name:"anaesMonitoring",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Anesthesia Monitoring"}),e.jsx(r,{children:e.jsx(h,{...s,value:s.value||"",placeholder:"e.g., Advanced monitoring equipment"})}),e.jsx(c,{})]})}),e.jsx(i,{control:n.control,name:"specialistAvail",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Specialist Availability"}),e.jsx(r,{children:e.jsx(H,{...s,value:s.value||"",placeholder:"List available specialists",rows:3})}),e.jsx(c,{})]})})]}),e.jsxs(R,{value:"operational",className:"space-y-4",children:[e.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md",children:e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-300",children:[e.jsx("strong",{children:"Optional:"})," Share operational details like visiting hours, facilities, and support options to build trust with pet owners."]})}),e.jsx(i,{control:n.control,name:"onSiteVet247",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(t,{className:"text-base",children:"On-Site Vet 24/7"}),e.jsx(K,{children:"Is a veterinarian on-site 24 hours?"})]}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"nurse24h",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(t,{className:"text-base",children:"24-Hour Nursing"}),e.jsx(K,{children:"Are nurses available 24 hours?"})]}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"triagePolicy",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Triage Policy"}),e.jsx(r,{children:e.jsx(H,{...s,value:s.value||"",placeholder:"Describe triage process",rows:3})}),e.jsx(c,{})]})}),e.jsx(i,{control:n.control,name:"typicalWaitBand",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Typical Wait Time"}),e.jsxs(re,{onValueChange:s.onChange,value:s.value||"",children:[e.jsx(r,{children:e.jsx(ie,{children:e.jsx(ce,{placeholder:"Select wait time"})})}),e.jsxs(de,{children:[e.jsx(v,{value:"<30min",children:"< 30 minutes"}),e.jsx(v,{value:"30-60min",children:"30-60 minutes"}),e.jsx(v,{value:"1-2hr",children:"1-2 hours"}),e.jsx(v,{value:">2hr",children:"> 2 hours"})]})]}),e.jsx(c,{})]})}),e.jsx(i,{control:n.control,name:"ownerVisitPolicy",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Owner Visiting Policy"}),e.jsx(r,{children:e.jsx(H,{...s,value:s.value||"",placeholder:"Describe visiting hours and policies",rows:3})}),e.jsx(c,{})]})}),e.jsx(i,{control:n.control,name:"recheckWindow",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Recheck Window"}),e.jsx(r,{children:e.jsx(h,{...s,value:s.value||"",placeholder:"e.g., 48 hours"})}),e.jsx(c,{})]})}),e.jsx("h3",{className:"text-lg font-semibold mt-6",children:"Client Support"}),e.jsx(le,{control:n.control,name:"languages",label:"Languages Spoken",placeholder:"e.g., English, Cantonese, Mandarin, Japanese",description:"Comma-separated list of languages spoken by staff",testId:"input-languages"}),e.jsx("h3",{className:"text-lg font-semibold mt-6",children:"Payment & Insurance"}),e.jsx(i,{control:n.control,name:"admissionDeposit",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"Requires Admission Deposit"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"depositBand",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Deposit Range"}),e.jsxs(re,{onValueChange:s.onChange,value:s.value||"",children:[e.jsx(r,{children:e.jsx(ie,{children:e.jsx(ce,{placeholder:"Select deposit range"})})}),e.jsxs(de,{children:[e.jsx(v,{value:"<5k",children:"< HK$5,000"}),e.jsx(v,{value:"5-10k",children:"HK$5,000 - 10,000"}),e.jsx(v,{value:"10-20k",children:"HK$10,000 - 20,000"}),e.jsx(v,{value:">20k",children:"> HK$20,000"})]})]}),e.jsx(c,{})]})}),e.jsx(i,{control:n.control,name:"refundPolicy",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Refund Policy"}),e.jsx(r,{children:e.jsx(H,{...s,value:s.value||"",placeholder:"Describe refund policy",rows:3})}),e.jsx(c,{})]})}),e.jsx(le,{control:n.control,name:"payMethods",label:"Payment Methods Accepted",placeholder:"e.g., Cash, Credit Card, PayMe, FPS, Octopus",description:"Comma-separated list of accepted payment methods",testId:"input-pay-methods"}),e.jsx(le,{control:n.control,name:"insuranceSupport",label:"Insurance Providers Supported",placeholder:"e.g., Blue Cross, OneDegree, Petclaim, Pawpular",description:"Comma-separated list of insurance providers supported",testId:"input-insurance-support"})]})]}),e.jsx($e,{children:e.jsx(j,{type:"submit","data-testid":"button-submit",children:y})})]})})}function Ts(){const[n,g]=m.useState(!1),[y,f]=m.useState(!1),[A,p]=m.useState(!1),[N,E]=m.useState(!1),[s,x]=m.useState(null),[w,P]=m.useState(null),[Z,he]=m.useState(null),[U,ue]=m.useState(""),[W,me]=m.useState("all"),[D,z]=m.useState(1),X=20,{toast:b}=He(),{data:L,isLoading:we}=te({queryKey:["/api/regions"]}),{data:o,isLoading:ke}=te({queryKey:["/api/hospitals"]}),M={total:(o==null?void 0:o.length)??0,verified:((o==null?void 0:o.filter(a=>a.lastVerifiedAt))??[]).length,open247:((o==null?void 0:o.filter(a=>a.open247))??[]).length,withPhotos:((o==null?void 0:o.filter(a=>a.photos&&a.photos.length>0))??[]).length},Q=(o==null?void 0:o.filter(a=>{if(U){const u=U.toLowerCase(),C=a.nameEn.toLowerCase().includes(u)||a.nameZh.toLowerCase().includes(u),V=a.addressEn.toLowerCase().includes(u)||a.addressZh.toLowerCase().includes(u);if(!C&&!V)return!1}return!(W!=="all"&&a.regionId!==W)}))??[],O=Math.ceil(Q.length/X),je=Q.slice((D-1)*X,D*X),Se=()=>{ue(""),me("all"),z(1)},G=ge({resolver:be(Ne),defaultValues:{nameEn:"",nameZh:"",addressEn:"",addressZh:"",slug:"",regionId:"",phone:null,whatsapp:null,websiteUrl:null,open247:!0,isAvailable:!0,isPartner:!1,latitude:null,longitude:null,photos:null,liveStatus:null,onSiteVet247:null,triagePolicy:null,typicalWaitBand:null,isolationWard:null,ambulanceSupport:null,icuLevel:null,nurse24h:null,ownerVisitPolicy:null,eolSupport:null,imagingXray:null,imagingUS:null,imagingCT:null,sameDayCT:null,inHouseLab:null,extLabCutoff:null,bloodBankAccess:null,sxEmergencySoft:null,sxEmergencyOrtho:null,anaesMonitoring:null,specialistAvail:null,whatsappTriage:null,parking:null,wheelchairAccess:null,admissionDeposit:null,depositBand:null,recheckWindow:null,refundPolicy:null,speciesAccepted:null,languages:null,payMethods:null,insuranceSupport:null}}),pe=ge({resolver:be(Ne)}),Ae=()=>{G.reset(),g(!0)},Ee=a=>{x(a),pe.reset({nameEn:a.nameEn,nameZh:a.nameZh,addressEn:a.addressEn,addressZh:a.addressZh,slug:a.slug,regionId:a.regionId,phone:a.phone||null,whatsapp:a.whatsapp||null,websiteUrl:a.websiteUrl||null,open247:a.open247,isAvailable:a.isAvailable,isPartner:a.isPartner,latitude:a.latitude?String(a.latitude):null,longitude:a.longitude?String(a.longitude):null,photos:a.photos||null,liveStatus:a.liveStatus||null,onSiteVet247:a.onSiteVet247||null,triagePolicy:a.triagePolicy||null,typicalWaitBand:a.typicalWaitBand||null,isolationWard:a.isolationWard||null,ambulanceSupport:a.ambulanceSupport||null,icuLevel:a.icuLevel||null,nurse24h:a.nurse24h||null,ownerVisitPolicy:a.ownerVisitPolicy||null,eolSupport:a.eolSupport||null,imagingXray:a.imagingXray||null,imagingUS:a.imagingUS||null,imagingCT:a.imagingCT||null,sameDayCT:a.sameDayCT||null,inHouseLab:a.inHouseLab||null,extLabCutoff:a.extLabCutoff||null,bloodBankAccess:a.bloodBankAccess||null,sxEmergencySoft:a.sxEmergencySoft||null,sxEmergencyOrtho:a.sxEmergencyOrtho||null,anaesMonitoring:a.anaesMonitoring||null,specialistAvail:a.specialistAvail||null,whatsappTriage:a.whatsappTriage||null,parking:a.parking||null,wheelchairAccess:a.wheelchairAccess||null,admissionDeposit:a.admissionDeposit||null,depositBand:a.depositBand||null,recheckWindow:a.recheckWindow||null,refundPolicy:a.refundPolicy||null,speciesAccepted:a.speciesAccepted||null,languages:a.languages||null,payMethods:a.payMethods||null,insuranceSupport:a.insuranceSupport||null}),f(!0)},Pe=a=>{x(a),p(!0)},De=async a=>{try{await q("POST","/api/hospitals",a),await J.invalidateQueries({queryKey:["/api/hospitals"]}),g(!1),G.reset(),b({title:"Success",description:"Hospital added successfully"})}catch(u){b({title:"Error",description:u.message||"Failed to add hospital",variant:"destructive"})}},Le=async a=>{if(s)try{await q("PATCH",`/api/hospitals/${s.id}`,a),await J.invalidateQueries({queryKey:["/api/hospitals"]}),f(!1),x(null),b({title:"Success",description:"Hospital updated successfully"})}catch(u){b({title:"Error",description:u.message||"Failed to update hospital",variant:"destructive"})}},Te=async()=>{if(s)try{await q("DELETE",`/api/hospitals/${s.id}`),await J.invalidateQueries({queryKey:["/api/hospitals"]}),p(!1),x(null),b({title:"Success",description:"Hospital deleted successfully"})}catch(a){b({title:"Error",description:a.message||"Failed to delete hospital",variant:"destructive"})}},_=qe({mutationFn:async a=>(await q("POST",`/api/hospitals/${a}/generate-code`,{})).code,onSuccess:a=>{he(a),b({title:"Code generated successfully"})},onError:a=>{b({title:"Error generating code",description:a.message,variant:"destructive"})}});return ke||we?e.jsx("div",{className:"container mx-auto p-6 max-w-7xl",children:e.jsx("div",{className:"flex justify-center items-center h-96",children:e.jsx(ve,{className:"h-8 w-8 animate-spin text-primary"})})}):e.jsxs("div",{className:"container mx-auto p-6 max-w-7xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx(Ie,{href:"/admin",children:e.jsxs(j,{variant:"ghost",size:"sm","data-testid":"button-back",children:[e.jsx(es,{className:"h-4 w-4 mr-2"}),"Dashboard"]})}),e.jsx("h1",{className:"text-3xl font-bold","data-testid":"heading-admin-hospitals",children:"Admin: Hospital Management"})]}),e.jsx("p",{className:"text-muted-foreground",children:"Manage 24-hour animal hospital profiles with photos and facilities"})]}),e.jsxs(j,{onClick:Ae,"data-testid":"button-add-hospital",children:[e.jsx(ss,{className:"h-4 w-4 mr-2"}),"Add Hospital"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs(k,{children:[e.jsxs(I,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(F,{className:"text-sm font-medium",children:"Total Hospitals"}),e.jsx(as,{className:"h-4 w-4 text-blue-500"})]}),e.jsx(S,{children:e.jsx("div",{className:"text-2xl font-bold",children:M.total})})]}),e.jsxs(k,{children:[e.jsxs(I,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(F,{className:"text-sm font-medium",children:"Open 24/7"}),e.jsx(Fe,{className:"h-4 w-4 text-green-500"})]}),e.jsx(S,{children:e.jsx("div",{className:"text-2xl font-bold",children:M.open247})})]}),e.jsxs(k,{children:[e.jsxs(I,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(F,{className:"text-sm font-medium",children:"Verified"}),e.jsx(ye,{className:"h-4 w-4 text-emerald-500"})]}),e.jsx(S,{children:e.jsx("div",{className:"text-2xl font-bold",children:M.verified})})]}),e.jsxs(k,{children:[e.jsxs(I,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(F,{className:"text-sm font-medium",children:"With Photos"}),e.jsx(oe,{className:"h-4 w-4 text-purple-500"})]}),e.jsx(S,{children:e.jsx("div",{className:"text-2xl font-bold",children:M.withPhotos})})]})]}),e.jsx(k,{className:"mb-6",children:e.jsxs(S,{className:"pt-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ns,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(h,{placeholder:"Search by name or address...",value:U,onChange:a=>ue(a.target.value),className:"pl-10","data-testid":"input-search"})]}),e.jsxs(re,{value:W,onValueChange:me,children:[e.jsx(ie,{className:"w-full md:w-48",children:e.jsx(ce,{placeholder:"All Regions"})}),e.jsxs(de,{children:[e.jsx(v,{value:"all",children:"All Regions"}),L==null?void 0:L.map(a=>e.jsx(v,{value:a.id,children:a.nameEn},a.id))]})]}),(U||W!=="all")&&e.jsxs(j,{variant:"outline",onClick:Se,children:[e.jsx(Me,{className:"h-4 w-4 mr-2"}),"Clear"]})]}),e.jsxs("div",{className:"mt-4 text-sm text-muted-foreground",children:["Showing ",Q.length," of ",M.total," hospitals"]})]})}),e.jsxs(k,{children:[e.jsxs(I,{children:[e.jsx(F,{children:"Hospitals"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Page ",D," of ",O||1]})]}),e.jsxs(S,{children:[e.jsxs("div",{className:"space-y-4",children:[je.map(a=>{const u=L==null?void 0:L.find(V=>V.id===a.regionId),C=a.photos;return e.jsx("div",{className:"p-4 border rounded-lg hover:bg-accent/50 transition-colors","data-testid":`hospital-card-${a.id}`,children:e.jsxs("div",{className:"flex gap-4",children:[C&&C.length>0&&e.jsx("img",{src:C[0],alt:a.nameEn,className:"w-24 h-24 object-cover rounded-lg flex-shrink-0",onError:V=>{V.target.style.display="none"}}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:a.nameEn}),e.jsx($,{variant:"outline",children:(u==null?void 0:u.code)||"N/A"}),a.open247&&e.jsx($,{variant:"default",className:"bg-green-600",children:"24hrs"}),a.lastVerifiedAt&&e.jsxs($,{variant:"secondary",children:[e.jsx(ye,{className:"h-3 w-3 mr-1"}),"Verified"]}),C&&C.length>0&&e.jsxs($,{variant:"outline",children:[e.jsx(oe,{className:"h-3 w-3 mr-1"}),C.length," ",C.length===1?"photo":"photos"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:a.nameZh}),e.jsx("p",{className:"text-sm mb-1",children:a.addressEn}),e.jsxs("div",{className:"flex items-center gap-4 text-sm mt-2",children:[a.phone&&e.jsxs("span",{className:"text-muted-foreground",children:["ðŸ“ž ",a.phone]}),a.latitude&&a.longitude&&e.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[e.jsx(Oe,{className:"h-3 w-3"}),Number(a.latitude).toFixed(4),", ",Number(a.longitude).toFixed(4)]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{variant:"outline",size:"sm",onClick:()=>{P(a),he(null),_.mutate(a.id),E(!0)},"data-testid":`button-generate-code-${a.id}`,title:a.slug?"Generate Access Code":"Add URL slug first to enable access codes",disabled:_.isPending||!a.slug,children:_.isPending?e.jsx(ve,{className:"h-4 w-4 animate-spin"}):e.jsx(ds,{className:"h-4 w-4"})}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>Ee(a),"data-testid":`button-edit-${a.id}`,children:e.jsx(ls,{className:"h-4 w-4"})}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>Pe(a),"data-testid":`button-delete-${a.id}`,children:e.jsx(ts,{className:"h-4 w-4 text-destructive"})})]})]})},a.id)}),je.length===0&&e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"No hospitals found"})]}),O>1&&e.jsxs("div",{className:"flex justify-center gap-2 mt-6",children:[e.jsx(j,{variant:"outline",size:"sm",onClick:()=>z(a=>Math.max(1,a-1)),disabled:D===1,children:"Previous"}),e.jsxs("span",{className:"flex items-center px-4 text-sm text-muted-foreground",children:["Page ",D," of ",O]}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>z(a=>Math.min(O,a+1)),disabled:D===O,children:"Next"})]})]})]}),e.jsx(Y,{open:n,onOpenChange:g,children:e.jsxs(ee,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(se,{children:[e.jsx(ae,{children:"Add New Hospital"}),e.jsx(ne,{children:"Enter the hospital details including photos and facilities"})]}),e.jsx(Ce,{form:G,onSubmit:De,submitLabel:"Add Hospital"})]})}),e.jsx(Y,{open:y,onOpenChange:f,children:e.jsxs(ee,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(se,{children:[e.jsx(ae,{children:"Edit Hospital"}),e.jsx(ne,{children:"Update the hospital details"})]}),e.jsx(Ce,{form:pe,onSubmit:Le,submitLabel:"Save Changes"})]})}),e.jsx(Ke,{open:A,onOpenChange:p,children:e.jsxs(Ze,{children:[e.jsxs(ze,{children:[e.jsx(Xe,{children:"Are you absolutely sure?"}),e.jsxs(Qe,{children:["This will permanently delete ",e.jsx("strong",{children:s==null?void 0:s.nameEn}),". This action cannot be undone."]})]}),e.jsxs(Ge,{children:[e.jsx(_e,{children:"Cancel"}),e.jsx(Je,{onClick:Te,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90","data-testid":"button-confirm-delete",children:"Delete"})]})]})}),e.jsx(Y,{open:N,onOpenChange:E,children:e.jsxs(ee,{className:"max-w-md",children:[e.jsxs(se,{children:[e.jsx(ae,{children:"Generated Code"}),e.jsx(ne,{children:"Share this code with the hospital owner to access their edit link"})]}),Z&&w&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Access Code:"}),e.jsx("p",{className:"text-3xl font-mono font-bold text-red-600 dark:text-red-400 text-center tracking-widest",children:Z})]}),e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Edit Link:"}),e.jsx("p",{className:"text-sm font-mono break-all text-blue-600 dark:text-blue-400",children:`${window.location.origin}/hospital/edit/${w.slug}`})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(j,{variant:"outline",onClick:()=>{navigator.clipboard.writeText(Z),b({title:"Code copied to clipboard"})},className:"flex-1","data-testid":"button-copy-code",children:[e.jsx(rs,{className:"h-4 w-4 mr-2"}),"Copy Code"]}),e.jsxs(j,{variant:"outline",onClick:()=>{const a=`${window.location.origin}/hospital/edit/${w.slug}`;navigator.clipboard.writeText(a),b({title:"Link copied to clipboard"})},className:"flex-1","data-testid":"button-copy-link",children:[e.jsx(is,{className:"h-4 w-4 mr-2"}),"Copy Link"]})]})]})]})})]})}export{Ts as default};
