import{c as p,a as ve,r,h as _,j as e,S as Ne,X as S,B as c,$ as be,am as ke,a0 as Se,a1 as Ce,a2 as Ae,a3 as Me,Y as f,I as C,a4 as Te,a5 as G,C as W,v as Y,w as J,b as Z,R as ee,_ as Pe,a9 as Ie,T as A,U as g}from"./index-yGPiJpIr.js";import{u as M}from"./useMutation-g6oReyS0.js";import{B as T}from"./badge-4zSkoC7y.js";import{S as te}from"./scroll-area-DcyMsPXe.js";import{S as se}from"./skeleton-DdmbE3wx.js";import{S as Re}from"./switch-BdZ2xI1R.js";import{T as Fe}from"./textarea-B-COFCfx.js";import{C as $e}from"./checkbox-ZqlGbjLG.js";import{A as De}from"./arrow-left-BVTF3Tl5.js";import{M as j}from"./message-square-BEUah6ir.js";import{P as qe}from"./plus-oXMKgXWF.js";import{S as ae}from"./send-C40fC5Tu.js";import{S as Ee}from"./settings-Duucq0m_.js";import{S as Le}from"./search-DPDD1EGd.js";import{B as ne}from"./building-2-Bk6ymILd.js";import{U as ze}from"./user-CcdmAbwc.js";import{F as He}from"./file-text-CJoYtlB-.js";import{I as Ue}from"./image-BKIDXmlM.js";import{f as Ke}from"./formatDistanceToNow-3UBXKcFR.js";import{f as ie}from"./format-CKHqWWuY.js";import"./en-US-wfBU2YNu.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=p("ArchiveRestore",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h2",key:"tvwodi"}],["path",{d:"M20 8v11a2 2 0 0 1-2 2h-2",key:"1gkqxj"}],["path",{d:"m9 15 3-3 3 3",key:"1pd0qc"}],["path",{d:"M12 12v9",key:"192myk"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=p("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=p("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=p("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=p("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=p("VolumeX",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);function Qe(s,a){if(a)return e.jsx(de,{className:"h-3 w-3 text-blue-500"});switch(s){case"delivered":return e.jsx(de,{className:"h-3 w-3 text-gray-400"});case"sent":return e.jsx(Ie,{className:"h-3 w-3 text-gray-400"});case"failed":return e.jsx("span",{className:"text-xs text-red-500",children:"!"});default:return e.jsx(Pe,{className:"h-3 w-3 text-gray-400"})}}function _e(){try{const s=new(window.AudioContext||window.webkitAudioContext),a=s.createOscillator(),d=s.createGain();a.connect(d),d.connect(s.destination),a.frequency.value=800,a.type="sine",d.gain.setValueAtTime(.3,s.currentTime),d.gain.exponentialRampToValueAtTime(.01,s.currentTime+.3),a.start(s.currentTime),a.stop(s.currentTime+.3)}catch(s){console.log("Could not play notification sound:",s)}}function Ge({message:s}){const a=s.direction==="outbound";if(!s.mediaUrl&&s.messageType==="text")return null;const d=a?"text-green-100":"text-gray-500";switch(s.messageType){case"image":return e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ue,{className:`h-4 w-4 ${d}`}),e.jsx("span",{className:"text-xs opacity-75",children:"Image"}),s.mediaUrl&&e.jsx("a",{href:s.mediaUrl,target:"_blank",rel:"noopener noreferrer",className:"text-xs underline opacity-75 hover:opacity-100","data-testid":`media-link-${s.id}`,children:"View"})]});case"document":return e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(He,{className:`h-4 w-4 ${d}`}),e.jsx("span",{className:"text-xs opacity-75",children:"Document"}),s.mediaUrl&&e.jsx("a",{href:s.mediaUrl,target:"_blank",rel:"noopener noreferrer",className:"text-xs underline opacity-75 hover:opacity-100","data-testid":`media-link-${s.id}`,children:"Download"})]});case"audio":case"video":return e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Xe,{className:`h-4 w-4 ${d}`}),e.jsx("span",{className:"text-xs opacity-75",children:s.messageType==="audio"?"Audio":"Video"}),s.mediaUrl&&e.jsx("a",{href:s.mediaUrl,target:"_blank",rel:"noopener noreferrer",className:"text-xs underline opacity-75 hover:opacity-100","data-testid":`media-link-${s.id}`,children:"Play"})]});default:return null}}function gt(){const{toast:s}=ve(),[a,d]=r.useState(null),[P,ce]=r.useState(!1),[w,L]=r.useState(""),z=r.useRef(null),[I,R]=r.useState(null),[y,le]=r.useState(""),[oe,F]=r.useState(!1),[v,H]=r.useState("+852"),[U,K]=r.useState(""),[N,V]=r.useState(""),[h,me]=r.useState(()=>typeof window<"u"?localStorage.getItem("chatSoundEnabled")!=="false":!0),[$,he]=r.useState(()=>typeof window<"u"?localStorage.getItem("chatReadReceipts")==="true":!1),D=r.useRef(void 0),{data:l,isLoading:X,refetch:ue}=_({queryKey:["/api/admin/conversations",P],queryFn:async()=>{const t=await fetch(`/api/admin/conversations?includeArchived=${P}`,{credentials:"include"});if(!t.ok)throw new Error("Failed to fetch conversations");return t.json()},refetchInterval:1e4}),n=l==null?void 0:l.find(t=>t.id===a),{data:m,isLoading:xe,refetch:pe}=_({queryKey:["/api/admin/conversations",a,"messages"],queryFn:async()=>{if(!a)return[];const t=await fetch(`/api/admin/conversations/${a}/messages`,{credentials:"include"});if(!t.ok)throw new Error("Failed to fetch messages");return t.json()},enabled:!!a,refetchInterval:a?5e3:!1}),fe=M({mutationFn:t=>A("POST",`/api/admin/conversations/${t}/read`),onSuccess:()=>{g.invalidateQueries({queryKey:["/api/admin/conversations"]})}}),O=M({mutationFn:({id:t,archive:i})=>A("POST",`/api/admin/conversations/${t}/archive`,{archive:i}),onSuccess:(t,i)=>{s({title:i.archive?"Conversation Archived":"Conversation Restored",description:i.archive?"The conversation has been archived":"The conversation has been restored"}),g.invalidateQueries({queryKey:["/api/admin/conversations"]}),i.archive&&a===i.id&&d(null)},onError:t=>{s({title:"Error",description:t.message||"Failed to archive conversation",variant:"destructive"})}}),q=M({mutationFn:({id:t,content:i})=>A("POST",`/api/admin/conversations/${t}/reply`,{content:i}),onMutate:async({content:t})=>{const i={id:`temp-${Date.now()}`,conversationId:a,direction:"outbound",content:t,messageType:"text",status:"sent",whatsappMessageId:null,mediaUrl:null,sentAt:new Date,deliveredAt:null,readAt:null,errorMessage:null,createdAt:new Date};return R(i),L(""),{optimisticMessage:i}},onSuccess:()=>{R(null),g.invalidateQueries({queryKey:["/api/admin/conversations",a,"messages"]}),g.invalidateQueries({queryKey:["/api/admin/conversations"]})},onError:t=>{R(null),s({title:"Failed to send message",description:t.message||"Please try again",variant:"destructive"})}}),E=M({mutationFn:async({phoneNumber:t,displayName:i,message:o})=>{const b=await A("POST","/api/admin/conversations/new",{phoneNumber:t,displayName:i||void 0,content:o}),{conversation:k}=await b.json();return k},onSuccess:t=>{s({title:"Conversation Created",description:"New conversation started successfully"}),F(!1),H("+852"),K(""),V(""),g.invalidateQueries({queryKey:["/api/admin/conversations"]}),d(t.id)},onError:t=>{s({title:"Failed to create conversation",description:t.message||"Please try again",variant:"destructive"})}});r.useEffect(()=>{a&&(n!=null&&n.unreadCount)&&n.unreadCount>0&&fe.mutate(a)},[a,n==null?void 0:n.unreadCount]),r.useEffect(()=>{var t;(t=z.current)==null||t.scrollIntoView({behavior:"smooth"})},[m,I]),r.useEffect(()=>{typeof window<"u"&&localStorage.setItem("chatSoundEnabled",String(h))},[h]),r.useEffect(()=>{typeof window<"u"&&localStorage.setItem("chatReadReceipts",String($))},[$]),r.useEffect(()=>{if(m&&D.current&&h){const t=new Set(D.current.map(o=>o.id));m.filter(o=>!t.has(o.id)&&o.direction==="inbound").length>0&&_e()}D.current=m},[m,h]);const B=()=>{!w.trim()||!a||q.mutate({id:a,content:w.trim()})},ge=t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),B())},je=()=>{ue(),a&&pe(),s({title:"Refreshed",description:"Conversations and messages have been refreshed"})},u=I?[...m||[],I]:m,x=l==null?void 0:l.filter(t=>{var o,b,k;if(!y.trim())return!0;const i=y.toLowerCase();return((o=t.displayName)==null?void 0:o.toLowerCase().includes(i))||((b=t.phoneNumber)==null?void 0:b.toLowerCase().includes(i))||((k=t.lastMessagePreview)==null?void 0:k.toLowerCase().includes(i))}),Q=(l==null?void 0:l.reduce((t,i)=>t+(i.unreadCount||0),0))||0,we=()=>{me(t=>!t)},ye=()=>{!v.trim()||!N.trim()||E.mutate({phoneNumber:v.trim(),displayName:U.trim()||void 0,message:N.trim()})};return e.jsxs(e.Fragment,{children:[e.jsx(Ne,{noindex:!0}),e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-white to-gray-50 dark:from-gray-900 dark:to-gray-800",children:[e.jsx("header",{className:"border-b border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-900 sticky top-0 z-10",children:e.jsx("div",{className:"container mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(S,{href:"/admin",children:e.jsx(c,{variant:"ghost",size:"icon","data-testid":"button-back",children:e.jsx(De,{className:"h-5 w-5"})})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(j,{className:"h-6 w-6 text-green-600"}),"WhatsApp Chats",Q>0&&e.jsx(T,{variant:"destructive",className:"ml-2","data-testid":"badge-unread-total",children:Q})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Two-way messaging with hospitals"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(c,{variant:"outline",size:"icon",onClick:we,title:h?"Mute notifications":"Unmute notifications","data-testid":"button-toggle-sound",children:h?e.jsx(Oe,{className:"h-4 w-4"}):e.jsx(Be,{className:"h-4 w-4 text-muted-foreground"})}),e.jsxs(be,{open:oe,onOpenChange:F,children:[e.jsx(ke,{asChild:!0,children:e.jsx(c,{variant:"outline",size:"icon","data-testid":"button-new-chat",children:e.jsx(qe,{className:"h-4 w-4"})})}),e.jsxs(Se,{"data-testid":"dialog-new-chat",children:[e.jsxs(Ce,{children:[e.jsx(Ae,{children:"Start New Conversation"}),e.jsx(Me,{children:"Send a message to a new phone number to start a conversation."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"new-chat-phone",children:"Phone Number"}),e.jsx(C,{id:"new-chat-phone",value:v,onChange:t=>H(t.target.value),placeholder:"+852 XXXX XXXX","data-testid":"input-new-chat-phone"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Include country code (e.g., +852 for Hong Kong)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"new-chat-name",children:"Display Name (Optional)"}),e.jsx(C,{id:"new-chat-name",value:U,onChange:t=>K(t.target.value),placeholder:"Hospital Name or Contact","data-testid":"input-new-chat-name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"new-chat-message",children:"Initial Message"}),e.jsx(Fe,{id:"new-chat-message",value:N,onChange:t=>V(t.target.value),placeholder:"Type your message...",rows:4,"data-testid":"input-new-chat-message"})]})]}),e.jsxs(Te,{children:[e.jsx(c,{variant:"outline",onClick:()=>F(!1),"data-testid":"button-cancel-new-chat",children:"Cancel"}),e.jsx(c,{onClick:ye,disabled:!v.trim()||!N.trim()||E.isPending,"data-testid":"button-send-new-chat",children:E.isPending?e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"h-4 w-4 mr-2 animate-spin"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Send"]})})]})]})]}),e.jsx(c,{variant:"outline",size:"icon",onClick:je,"data-testid":"button-refresh",children:e.jsx(G,{className:`h-4 w-4 ${X?"animate-spin":""}`})}),e.jsxs("div",{className:"hidden sm:flex gap-2",children:[e.jsx(S,{href:"/admin/messages",children:e.jsxs(c,{variant:"outline",size:"sm","data-testid":"button-broadcast-messages",children:[e.jsx(j,{className:"h-4 w-4 mr-2"}),"Broadcasts"]})}),e.jsx(S,{href:"/admin/config",children:e.jsxs(c,{variant:"outline",size:"sm","data-testid":"button-admin-config",children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Config"]})})]})]})]})})}),e.jsx("main",{className:"container mx-auto px-4 py-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 h-[calc(100vh-180px)]",children:[e.jsxs(W,{className:"lg:w-1/3 flex flex-col","data-testid":"panel-conversations",children:[e.jsxs(Y,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(J,{className:"text-lg",children:"Conversations"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{htmlFor:"show-archived",className:"text-sm text-muted-foreground",children:"Archived"}),e.jsx(Re,{id:"show-archived",checked:P,onCheckedChange:ce,"data-testid":"switch-show-archived"})]})]}),e.jsxs("div",{className:"relative mt-3",children:[e.jsx(Le,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(C,{value:y,onChange:t=>le(t.target.value),placeholder:"Search conversations...",className:"pl-9","data-testid":"input-search-conversations"})]})]}),e.jsx(Z,{className:"flex-1 overflow-hidden p-0",children:e.jsx(te,{className:"h-full",children:X?e.jsx("div",{className:"space-y-2 p-4",children:[1,2,3,4,5].map(t=>e.jsx(se,{className:"h-16 w-full"},t))}):(x==null?void 0:x.length)===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center text-muted-foreground",children:[e.jsx(j,{className:"h-12 w-12 mb-4 opacity-50"}),e.jsx("p",{children:"No conversations found"}),e.jsx("p",{className:"text-sm",children:y?"Try a different search term":"Incoming messages from hospitals will appear here"})]}):e.jsx("div",{className:"divide-y",children:x==null?void 0:x.map(t=>e.jsx("button",{onClick:()=>d(t.id),className:`w-full text-left px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors ${a===t.id?"bg-primary/5 border-l-4 border-primary":""} ${t.isArchived?"opacity-60":""}`,"data-testid":`conversation-item-${t.id}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium truncate",children:t.displayName||t.phoneNumber}),t.hospitalId&&e.jsxs(T,{variant:"secondary",className:"flex-shrink-0 text-xs",children:[e.jsx(ne,{className:"h-3 w-3 mr-1"}),"Hospital"]}),t.isArchived&&e.jsxs(T,{variant:"outline",className:"flex-shrink-0 text-xs",children:[e.jsx(re,{className:"h-3 w-3 mr-1"}),"Archived"]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground mt-0.5",children:[e.jsx(ee,{className:"h-3 w-3"}),e.jsx("span",{className:"font-mono",children:t.phoneNumber})]}),t.lastMessagePreview&&e.jsx("p",{className:"text-sm text-muted-foreground truncate mt-1",children:t.lastMessagePreview})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1 flex-shrink-0",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:t.lastMessageAt?Ke(new Date(t.lastMessageAt),{addSuffix:!0}):"No messages"}),(t.unreadCount||0)>0&&e.jsx(T,{variant:"destructive",className:"h-5 min-w-5 flex items-center justify-center text-xs","data-testid":`unread-badge-${t.id}`,children:t.unreadCount})]})]})},t.id))})})})]}),e.jsx(W,{className:"lg:w-2/3 flex flex-col","data-testid":"panel-messages",children:a?e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"pb-3 border-b",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center",children:e.jsx(ze,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx(J,{className:"text-lg",children:(n==null?void 0:n.displayName)||(n==null?void 0:n.phoneNumber)}),e.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[e.jsx(ee,{className:"h-3 w-3"}),n==null?void 0:n.phoneNumber]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mr-2",title:"Send read receipts when viewing messages",children:[e.jsx($e,{id:"read-receipts",checked:$,onCheckedChange:t=>he(t===!0),"data-testid":"checkbox-read-receipts"}),e.jsx(f,{htmlFor:"read-receipts",className:"text-xs text-muted-foreground cursor-pointer",children:"Read receipts"})]}),(n==null?void 0:n.hospitalId)&&e.jsx(S,{href:`/admin/hospitals?id=${n==null?void 0:n.hospitalId}`,children:e.jsxs(c,{variant:"outline",size:"sm","data-testid":"button-view-hospital",children:[e.jsx(ne,{className:"h-4 w-4 mr-1"}),"View Hospital"]})}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>O.mutate({id:a,archive:!(n!=null&&n.isArchived)}),disabled:O.isPending,"data-testid":"button-archive",children:n!=null&&n.isArchived?e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"h-4 w-4 mr-1"}),"Restore"]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"h-4 w-4 mr-1"}),"Archive"]})})]})]})}),e.jsx(Z,{className:"flex-1 overflow-hidden p-0",children:e.jsx(te,{className:"h-full p-4",children:xe?e.jsx("div",{className:"space-y-4",children:[1,2,3,4].map(t=>e.jsx("div",{className:`flex ${t%2===0?"justify-end":"justify-start"}`,children:e.jsx(se,{className:"h-12 w-48 rounded-lg"})},t))}):(u==null?void 0:u.length)===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center text-muted-foreground",children:[e.jsx(j,{className:"h-12 w-12 mb-4 opacity-50"}),e.jsx("p",{children:"No messages yet"}),e.jsx("p",{className:"text-sm",children:"Send a message to start the conversation"})]}):e.jsxs("div",{className:"space-y-3",children:[u==null?void 0:u.map(t=>e.jsx("div",{className:`flex ${t.direction==="outbound"?"justify-end":"justify-start"}`,"data-testid":`message-${t.id}`,children:e.jsxs("div",{className:`max-w-[75%] rounded-lg px-4 py-2 ${t.direction==="outbound"?"bg-green-600 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-white"}`,children:[e.jsx(Ge,{message:t}),t.content&&e.jsx("p",{className:"text-sm whitespace-pre-wrap break-words",children:t.content}),e.jsxs("div",{className:`flex items-center gap-1 mt-1 text-xs ${t.direction==="outbound"?"text-green-100 justify-end":"text-gray-500"}`,children:[e.jsx("span",{children:t.sentAt?ie(new Date(t.sentAt),"HH:mm"):t.createdAt?ie(new Date(t.createdAt),"HH:mm"):""}),t.direction==="outbound"&&Qe(t.status,t.readAt)]})]})},t.id)),e.jsx("div",{ref:z})]})})}),e.jsx("div",{className:"p-4 border-t",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(C,{value:w,onChange:t=>L(t.target.value),onKeyPress:ge,placeholder:"Type a message...",disabled:q.isPending,className:"flex-1","data-testid":"input-reply"}),e.jsxs(c,{onClick:B,disabled:!w.trim()||q.isPending,"data-testid":"button-send",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Send"]})]})})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center text-muted-foreground",children:[e.jsx(j,{className:"h-16 w-16 mb-4 opacity-50"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Select a Conversation"}),e.jsx("p",{className:"text-sm max-w-md",children:"Choose a conversation from the list on the left to view messages and reply to hospitals."})]})})]})})]})]})}export{gt as default};
