import{c as Ce,r as m,a as He,h as te,g as pe,j as e,_ as Ie,B as j,C as k,q as I,t as F,b as S,a0 as Fe,I as h,a1 as re,a2 as ie,a3 as ce,a4 as de,a5 as v,av as Oe,M as Me,X as Ve,s as L,F as Be,ar as $e,as as Ue,at as $,aC as U,w as i,x as l,y as t,z as r,A as c,D as z,v as We,G as R,H as J,aD as qe,a7 as ge}from"./index-DwyYRZ5p.js";import{u as Re}from"./useMutation-qDWMbsfK.js";import{D as Y,a as ee,b as se,c as ae,d as ne,e as Ze}from"./dialog-DiajIIgm.js";import{A as ze,a as Ke,b as Xe,c as Qe,d as Ge,e as _e,f as Je,g as Ye}from"./alert-dialog-CuXdJD1b.js";import{T as H}from"./textarea-D7188dvW.js";import{S as d}from"./switch-BavEdzWh.js";import{B as Z}from"./badge-BMrQ0xDH.js";import{i as es}from"./schema-CJxOeGTw.js";import{L as be}from"./loader-circle-BdEoJB26.js";import{A as ss}from"./arrow-left-yEGhOFsb.js";import{P as as}from"./plus-n-JqKbGd.js";import{B as ns}from"./building-2-BwwPf-yj.js";import{C as ve}from"./circle-check-VAEX32bm.js";import{S as ls}from"./search-DvVGx0W3.js";import{P as ts}from"./pencil-Dt44MTy6.js";import{T as rs}from"./trash-2-CJDXV07h.js";import{C as is}from"./copy-BqOHNk6C.js";import{E as cs}from"./external-link-BUxMFfKu.js";import{C as ds}from"./circle-x-Bc7_aRaK.js";import"./index-mUsBoYTb.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=Ce("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=Ce("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),xs=n=>{const g=n.split(",").map(y=>y.trim()).filter(y=>y);return g.length>0?g:null},ye=n=>(n||[]).join(", ");function le({control:n,name:g,label:y,placeholder:f,description:A,testId:p}){const{field:N}=qe({control:n,name:g}),[E,s]=m.useState(ye(N.value));m.useEffect(()=>{s(ye(N.value))},[N.value]);const x=w=>{const P=w.target.value;s(P),N.onChange(xs(P))};return e.jsxs(l,{children:[e.jsx(t,{children:y}),e.jsx(r,{children:e.jsx(h,{value:E,onChange:x,placeholder:f,"data-testid":p})}),e.jsx(z,{children:A}),e.jsx(c,{})]})}const fe=es.extend({nameEn:L().min(1,"Hospital name (English) is required"),nameZh:L().min(1,"Hospital name (Chinese) is required"),addressEn:L().min(1,"Address (English) is required"),addressZh:L().min(1,"Address (Chinese) is required"),regionId:L().min(1,"Region is required"),slug:L().min(1,"URL slug is required").regex(/^[a-z0-9-]+$/,"Slug must be lowercase letters, numbers, and hyphens only")});function Ne({form:n,onSubmit:g,submitLabel:y}){te({queryKey:["/api/regions"]});const[f,A]=m.useState(""),p=n.watch("photos"),N=()=>{if(f.trim()){const s=p||[];n.setValue("photos",[...s,f.trim()]),A("")}},E=s=>{const x=p||[];n.setValue("photos",x.filter((w,P)=>P!==s))};return e.jsx(Be,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(g),className:"space-y-4",children:[e.jsxs($e,{defaultValue:"basic",className:"w-full",children:[e.jsxs(Ue,{className:"grid w-full grid-cols-5",children:[e.jsx($,{value:"basic",children:"Basic Info"}),e.jsx($,{value:"photos",children:"Photos"}),e.jsx($,{value:"facilities",children:"Facilities"}),e.jsx($,{value:"medical",children:"Medical Services"}),e.jsx($,{value:"operational",children:"Operational"})]}),e.jsxs(U,{value:"basic",className:"space-y-4",children:[e.jsx("div",{className:"mb-4 p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-md",children:e.jsxs("p",{className:"text-sm text-green-800 dark:text-green-300",children:[e.jsx("strong",{children:"Essential Information:"})," Help pet parents contact you quickly during emergencies. Complete this first, then add photos and services to increase visibility."]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(i,{control:n.control,name:"nameEn",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Hospital Name (English) *"}),e.jsx(r,{children:e.jsx(h,{...s,placeholder:"Central Animal Hospital","data-testid":"input-name-en"})}),e.jsx(c,{})]})}),e.jsx(i,{control:n.control,name:"nameZh",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Hospital Name (Chinese) *"}),e.jsx(r,{children:e.jsx(h,{...s,placeholder:"ä¸­ç’°å‹•ç‰©é†«é™¢","data-testid":"input-name-zh"})}),e.jsx(c,{})]})})]}),e.jsx(i,{control:n.control,name:"slug",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"URL Slug *"}),e.jsx(r,{children:e.jsx(h,{...s,placeholder:"central-animal-hospital","data-testid":"input-slug"})}),e.jsx(z,{children:"Lowercase letters, numbers, and hyphens only"}),e.jsx(c,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(i,{control:n.control,name:"addressEn",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Address (English) *"}),e.jsx(r,{children:e.jsx(H,{...s,placeholder:"123 Queen's Road Central",rows:3,"data-testid":"input-address-en"})}),e.jsx(c,{})]})}),e.jsx(i,{control:n.control,name:"addressZh",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Address (Chinese) *"}),e.jsx(r,{children:e.jsx(H,{...s,placeholder:"çš‡åŽå¤§é“ä¸­123è™Ÿ",rows:3,"data-testid":"input-address-zh"})}),e.jsx(c,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(i,{control:n.control,name:"phone",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Phone *"}),e.jsx(r,{children:e.jsx(h,{...s,value:s.value||"",placeholder:"+852 1234 5678","data-testid":"input-phone"})}),e.jsx(c,{})]})}),e.jsx(i,{control:n.control,name:"whatsapp",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"WhatsApp *"}),e.jsx(r,{children:e.jsx(h,{...s,value:s.value||"",placeholder:"+852 1234 5678","data-testid":"input-whatsapp"})}),e.jsx(c,{})]})}),e.jsx(i,{control:n.control,name:"email",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Email *"}),e.jsx(r,{children:e.jsx(h,{...s,value:s.value||"",placeholder:"info@hospital.com",type:"email","data-testid":"input-email"})}),e.jsx(c,{})]})})]})]}),e.jsx(U,{value:"photos",className:"space-y-4 hidden",children:e.jsxs(k,{children:[e.jsxs(I,{children:[e.jsx(F,{children:"Hospital Photos"}),e.jsx(We,{children:"Add photos of the hospital to help pet owners"})]}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{placeholder:"Enter photo URL (e.g., https://example.com/photo.jpg)",value:f,onChange:s=>A(s.target.value),onKeyPress:s=>s.key==="Enter"&&(s.preventDefault(),N()),"data-testid":"input-photo-url"}),e.jsxs(j,{type:"button",onClick:N,"data-testid":"button-add-photo",children:[e.jsx(os,{className:"h-4 w-4 mr-2"}),"Add"]})]}),p&&p.length>0?e.jsx("div",{className:"grid grid-cols-3 gap-4",children:p.map((s,x)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:s,alt:`Hospital photo ${x+1}`,className:"w-full h-32 object-cover rounded-lg border",onError:w=>{w.target.src="/placeholder-image.png"}}),e.jsx(j,{type:"button",variant:"destructive",size:"icon",className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>E(x),"data-testid":`button-remove-photo-${x}`,children:e.jsx(ds,{className:"h-4 w-4"})}),e.jsxs("div",{className:"absolute bottom-2 left-2 bg-black/50 text-white text-xs px-2 py-1 rounded",children:["Photo ",x+1]})]},x))}):e.jsxs("div",{className:"text-center py-12 text-muted-foreground border-2 border-dashed rounded-lg",children:[e.jsx(oe,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No photos added yet"}),e.jsx("p",{className:"text-sm",children:"Add photo URLs above to display them here"})]})]})]})}),e.jsxs(U,{value:"facilities",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(i,{control:n.control,name:"parking",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"Parking Available"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"wheelchairAccess",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"Wheelchair Accessible"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"isolationWard",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"Isolation Ward"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"ambulanceSupport",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"Ambulance Support"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"eolSupport",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"End-of-Life Support"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"oxygenTank",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"Oxygen Tank"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"whatsappTriage",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"WhatsApp Triage"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})})]}),e.jsx(i,{control:n.control,name:"icuLevel",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"ICU Level"}),e.jsx(r,{children:e.jsx(h,{...s,value:s.value||"",placeholder:"e.g., Level 2 ICU"})}),e.jsx(c,{})]})})]}),e.jsxs(U,{value:"medical",className:"space-y-4",children:[e.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md",children:e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-300",children:[e.jsx("strong",{children:"Optional:"})," Help pet parents find you during emergencies by listing your medical services and capabilities."]})}),e.jsx("h3",{className:"text-lg font-semibold",children:"Imaging Services"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(i,{control:n.control,name:"imagingXray",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"X-Ray"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"imagingUS",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"Ultrasound"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"imagingCT",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"CT Scan"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"sameDayCT",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"Same-Day CT"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})})]}),e.jsx("h3",{className:"text-lg font-semibold mt-6",children:"Laboratory & Testing"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(i,{control:n.control,name:"inHouseLab",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"In-House Laboratory"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"extLabCutoff",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"External Lab Cutoff Time"}),e.jsx(r,{children:e.jsx(h,{...s,value:s.value||"",placeholder:"e.g., 6:00 PM"})})]})})]}),e.jsx(i,{control:n.control,name:"bloodBankAccess",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Blood Bank Access"}),e.jsx(r,{children:e.jsx(h,{...s,value:s.value||"",placeholder:"e.g., On-site blood bank"})}),e.jsx(c,{})]})}),e.jsx("h3",{className:"text-lg font-semibold mt-6",children:"Surgery Capabilities"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(i,{control:n.control,name:"sxEmergencySoft",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"Emergency Soft Tissue Surgery"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"sxEmergencyOrtho",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"Emergency Orthopedic Surgery"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})})]}),e.jsx(i,{control:n.control,name:"anaesMonitoring",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Anesthesia Monitoring"}),e.jsx(r,{children:e.jsx(h,{...s,value:s.value||"",placeholder:"e.g., Advanced monitoring equipment"})}),e.jsx(c,{})]})}),e.jsx(i,{control:n.control,name:"specialistAvail",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Specialist Availability"}),e.jsx(r,{children:e.jsx(H,{...s,value:s.value||"",placeholder:"List available specialists",rows:3})}),e.jsx(c,{})]})})]}),e.jsxs(U,{value:"operational",className:"space-y-4",children:[e.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md",children:e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-300",children:[e.jsx("strong",{children:"Optional:"})," Share operational details like visiting hours, facilities, and support options to build trust with pet owners."]})}),e.jsx(i,{control:n.control,name:"onSiteVet247",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(t,{className:"text-base",children:"On-Site Vet 24/7"}),e.jsx(z,{children:"Is a veterinarian on-site 24 hours?"})]}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"nurse24h",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(t,{className:"text-base",children:"24-Hour Nursing"}),e.jsx(z,{children:"Are nurses available 24 hours?"})]}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"triagePolicy",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Triage Policy"}),e.jsx(r,{children:e.jsx(H,{...s,value:s.value||"",placeholder:"Describe triage process",rows:3})}),e.jsx(c,{})]})}),e.jsx(i,{control:n.control,name:"typicalWaitBand",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Typical Wait Time"}),e.jsxs(re,{onValueChange:s.onChange,value:s.value||"",children:[e.jsx(r,{children:e.jsx(ie,{children:e.jsx(ce,{placeholder:"Select wait time"})})}),e.jsxs(de,{children:[e.jsx(v,{value:"<30min",children:"< 30 minutes"}),e.jsx(v,{value:"30-60min",children:"30-60 minutes"}),e.jsx(v,{value:"1-2hr",children:"1-2 hours"}),e.jsx(v,{value:">2hr",children:"> 2 hours"})]})]}),e.jsx(c,{})]})}),e.jsx(i,{control:n.control,name:"ownerVisitPolicy",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Owner Visiting Policy"}),e.jsx(r,{children:e.jsx(H,{...s,value:s.value||"",placeholder:"Describe visiting hours and policies",rows:3})}),e.jsx(c,{})]})}),e.jsx(i,{control:n.control,name:"recheckWindow",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Recheck Window"}),e.jsx(r,{children:e.jsx(h,{...s,value:s.value||"",placeholder:"e.g., 48 hours"})}),e.jsx(c,{})]})}),e.jsx("h3",{className:"text-lg font-semibold mt-6",children:"Client Support"}),e.jsx(le,{control:n.control,name:"languages",label:"Languages Spoken",placeholder:"e.g., English, Cantonese, Mandarin, Japanese",description:"Comma-separated list of languages spoken by staff",testId:"input-languages"}),e.jsx("h3",{className:"text-lg font-semibold mt-6",children:"Payment & Insurance"}),e.jsx(i,{control:n.control,name:"admissionDeposit",render:({field:s})=>e.jsxs(l,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsx("div",{className:"space-y-0.5",children:e.jsx(t,{className:"text-base",children:"Requires Admission Deposit"})}),e.jsx(r,{children:e.jsx(d,{checked:s.value||!1,onCheckedChange:s.onChange})})]})}),e.jsx(i,{control:n.control,name:"depositBand",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Deposit Range"}),e.jsxs(re,{onValueChange:s.onChange,value:s.value||"",children:[e.jsx(r,{children:e.jsx(ie,{children:e.jsx(ce,{placeholder:"Select deposit range"})})}),e.jsxs(de,{children:[e.jsx(v,{value:"<5k",children:"< HK$5,000"}),e.jsx(v,{value:"5-10k",children:"HK$5,000 - 10,000"}),e.jsx(v,{value:"10-20k",children:"HK$10,000 - 20,000"}),e.jsx(v,{value:">20k",children:"> HK$20,000"})]})]}),e.jsx(c,{})]})}),e.jsx(i,{control:n.control,name:"refundPolicy",render:({field:s})=>e.jsxs(l,{children:[e.jsx(t,{children:"Refund Policy"}),e.jsx(r,{children:e.jsx(H,{...s,value:s.value||"",placeholder:"Describe refund policy",rows:3})}),e.jsx(c,{})]})}),e.jsx(le,{control:n.control,name:"payMethods",label:"Payment Methods Accepted",placeholder:"e.g., Cash, Credit Card, PayMe, FPS, Octopus",description:"Comma-separated list of accepted payment methods",testId:"input-pay-methods"}),e.jsx(le,{control:n.control,name:"insuranceSupport",label:"Insurance Providers Supported",placeholder:"e.g., Blue Cross, OneDegree, Petclaim, Pawpular",description:"Comma-separated list of insurance providers supported",testId:"input-insurance-support"})]})]}),e.jsx(Ze,{children:e.jsx(j,{type:"submit","data-testid":"button-submit",children:y})})]})})}function Ls(){const[n,g]=m.useState(!1),[y,f]=m.useState(!1),[A,p]=m.useState(!1),[N,E]=m.useState(!1),[s,x]=m.useState(null),[w,P]=m.useState(null),[O,xe]=m.useState(null),[W,he]=m.useState(""),[q,ue]=m.useState("all"),[D,K]=m.useState(1),X=20,{toast:b}=He(),{data:T,isLoading:we}=te({queryKey:["/api/regions"]}),{data:o,isLoading:ke}=te({queryKey:["/api/hospitals"]}),M={total:(o==null?void 0:o.length)??0,verified:((o==null?void 0:o.filter(a=>a.lastVerifiedAt))??[]).length,open247:((o==null?void 0:o.filter(a=>a.open247))??[]).length,withPhotos:((o==null?void 0:o.filter(a=>a.photos&&a.photos.length>0))??[]).length},Q=(o==null?void 0:o.filter(a=>{if(W){const u=W.toLowerCase(),C=a.nameEn.toLowerCase().includes(u)||a.nameZh.toLowerCase().includes(u),B=a.addressEn.toLowerCase().includes(u)||a.addressZh.toLowerCase().includes(u);if(!C&&!B)return!1}return!(q!=="all"&&a.regionId!==q)}))??[],V=Math.ceil(Q.length/X),me=Q.slice((D-1)*X,D*X),Se=()=>{he(""),ue("all"),K(1)},G=pe({resolver:ge(fe),defaultValues:{nameEn:"",nameZh:"",addressEn:"",addressZh:"",slug:"",regionId:"",phone:null,whatsapp:null,websiteUrl:null,open247:!0,isAvailable:!0,isPartner:!1,latitude:null,longitude:null,photos:null,liveStatus:null,onSiteVet247:null,triagePolicy:null,typicalWaitBand:null,isolationWard:null,ambulanceSupport:null,oxygenTank:null,icuLevel:null,nurse24h:null,ownerVisitPolicy:null,eolSupport:null,imagingXray:null,imagingUS:null,imagingCT:null,sameDayCT:null,inHouseLab:null,extLabCutoff:null,bloodBankAccess:null,sxEmergencySoft:null,sxEmergencyOrtho:null,anaesMonitoring:null,specialistAvail:null,whatsappTriage:null,parking:null,wheelchairAccess:null,admissionDeposit:null,depositBand:null,recheckWindow:null,refundPolicy:null,speciesAccepted:null,languages:null,payMethods:null,insuranceSupport:null}}),je=pe({resolver:ge(fe)}),Ae=()=>{G.reset(),g(!0)},Ee=a=>{x(a),je.reset({nameEn:a.nameEn,nameZh:a.nameZh,addressEn:a.addressEn,addressZh:a.addressZh,slug:a.slug,regionId:a.regionId,phone:a.phone||null,whatsapp:a.whatsapp||null,websiteUrl:a.websiteUrl||null,open247:a.open247,isAvailable:a.isAvailable,isPartner:a.isPartner,latitude:a.latitude?String(a.latitude):null,longitude:a.longitude?String(a.longitude):null,photos:a.photos||null,liveStatus:a.liveStatus||null,onSiteVet247:a.onSiteVet247||null,triagePolicy:a.triagePolicy||null,typicalWaitBand:a.typicalWaitBand||null,isolationWard:a.isolationWard||null,ambulanceSupport:a.ambulanceSupport||null,oxygenTank:a.oxygenTank||null,icuLevel:a.icuLevel||null,nurse24h:a.nurse24h||null,ownerVisitPolicy:a.ownerVisitPolicy||null,eolSupport:a.eolSupport||null,imagingXray:a.imagingXray||null,imagingUS:a.imagingUS||null,imagingCT:a.imagingCT||null,sameDayCT:a.sameDayCT||null,inHouseLab:a.inHouseLab||null,extLabCutoff:a.extLabCutoff||null,bloodBankAccess:a.bloodBankAccess||null,sxEmergencySoft:a.sxEmergencySoft||null,sxEmergencyOrtho:a.sxEmergencyOrtho||null,anaesMonitoring:a.anaesMonitoring||null,specialistAvail:a.specialistAvail||null,whatsappTriage:a.whatsappTriage||null,parking:a.parking||null,wheelchairAccess:a.wheelchairAccess||null,admissionDeposit:a.admissionDeposit||null,depositBand:a.depositBand||null,recheckWindow:a.recheckWindow||null,refundPolicy:a.refundPolicy||null,speciesAccepted:a.speciesAccepted||null,languages:a.languages||null,payMethods:a.payMethods||null,insuranceSupport:a.insuranceSupport||null}),f(!0)},Pe=a=>{x(a),p(!0)},De=async a=>{try{await R("POST","/api/hospitals",a),await J.invalidateQueries({queryKey:["/api/hospitals"]}),g(!1),G.reset(),b({title:"Success",description:"Hospital added successfully"})}catch(u){b({title:"Error",description:u.message||"Failed to add hospital",variant:"destructive"})}},Te=async a=>{if(s)try{await R("PATCH",`/api/hospitals/${s.id}`,a),await J.invalidateQueries({queryKey:["/api/hospitals"]}),f(!1),x(null),b({title:"Success",description:"Hospital updated successfully"})}catch(u){b({title:"Error",description:u.message||"Failed to update hospital",variant:"destructive"})}},Le=async()=>{if(s)try{await R("DELETE",`/api/hospitals/${s.id}`),await J.invalidateQueries({queryKey:["/api/hospitals"]}),p(!1),x(null),b({title:"Success",description:"Hospital deleted successfully"})}catch(a){b({title:"Error",description:a.message||"Failed to delete hospital",variant:"destructive"})}},_=Re({mutationFn:async a=>(await R("POST",`/api/hospitals/${a}/generate-code`,{})).code,onSuccess:a=>{xe(a),b({title:"Code generated successfully"})},onError:a=>{b({title:"Error generating code",description:a.message,variant:"destructive"})}});return ke||we?e.jsx("div",{className:"container mx-auto p-6 max-w-7xl",children:e.jsx("div",{className:"flex justify-center items-center h-96",children:e.jsx(be,{className:"h-8 w-8 animate-spin text-primary"})})}):e.jsxs("div",{className:"container mx-auto p-6 max-w-7xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx(Ie,{href:"/admin",children:e.jsxs(j,{variant:"ghost",size:"sm","data-testid":"button-back",children:[e.jsx(ss,{className:"h-4 w-4 mr-2"}),"Dashboard"]})}),e.jsx("h1",{className:"text-3xl font-bold","data-testid":"heading-admin-hospitals",children:"Admin: Hospital Management"})]}),e.jsx("p",{className:"text-muted-foreground",children:"Manage 24-hour animal hospital profiles with photos and facilities"})]}),e.jsxs(j,{onClick:Ae,"data-testid":"button-add-hospital",children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"Add Hospital"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs(k,{children:[e.jsxs(I,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(F,{className:"text-sm font-medium",children:"Total Hospitals"}),e.jsx(ns,{className:"h-4 w-4 text-blue-500"})]}),e.jsx(S,{children:e.jsx("div",{className:"text-2xl font-bold",children:M.total})})]}),e.jsxs(k,{children:[e.jsxs(I,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(F,{className:"text-sm font-medium",children:"Open 24/7"}),e.jsx(Fe,{className:"h-4 w-4 text-green-500"})]}),e.jsx(S,{children:e.jsx("div",{className:"text-2xl font-bold",children:M.open247})})]}),e.jsxs(k,{children:[e.jsxs(I,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(F,{className:"text-sm font-medium",children:"Verified"}),e.jsx(ve,{className:"h-4 w-4 text-emerald-500"})]}),e.jsx(S,{children:e.jsx("div",{className:"text-2xl font-bold",children:M.verified})})]}),e.jsxs(k,{children:[e.jsxs(I,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(F,{className:"text-sm font-medium",children:"With Photos"}),e.jsx(oe,{className:"h-4 w-4 text-purple-500"})]}),e.jsx(S,{children:e.jsx("div",{className:"text-2xl font-bold",children:M.withPhotos})})]})]}),e.jsx(k,{className:"mb-6",children:e.jsxs(S,{className:"pt-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ls,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(h,{placeholder:"Search by name or address...",value:W,onChange:a=>he(a.target.value),className:"pl-10","data-testid":"input-search"})]}),e.jsxs(re,{value:q,onValueChange:ue,children:[e.jsx(ie,{className:"w-full md:w-48",children:e.jsx(ce,{placeholder:"All Regions"})}),e.jsxs(de,{children:[e.jsx(v,{value:"all",children:"All Regions"}),T==null?void 0:T.map(a=>e.jsx(v,{value:a.id,children:a.nameEn},a.id))]})]}),(W||q!=="all")&&e.jsxs(j,{variant:"outline",onClick:Se,children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Clear"]})]}),e.jsxs("div",{className:"mt-4 text-sm text-muted-foreground",children:["Showing ",Q.length," of ",M.total," hospitals"]})]})}),e.jsxs(k,{children:[e.jsxs(I,{children:[e.jsx(F,{children:"Hospitals"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Page ",D," of ",V||1]})]}),e.jsxs(S,{children:[e.jsxs("div",{className:"space-y-4",children:[me.map(a=>{const u=T==null?void 0:T.find(B=>B.id===a.regionId),C=a.photos;return e.jsx("div",{className:"p-4 border rounded-lg hover:bg-accent/50 transition-colors","data-testid":`hospital-card-${a.id}`,children:e.jsxs("div",{className:"flex gap-4",children:[C&&C.length>0&&e.jsx("img",{src:C[0],alt:a.nameEn,className:"w-24 h-24 object-cover rounded-lg flex-shrink-0",onError:B=>{B.target.style.display="none"}}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:a.nameEn}),e.jsx(Z,{variant:"outline",children:(u==null?void 0:u.code)||"N/A"}),a.open247&&e.jsx(Z,{variant:"default",className:"bg-green-600",children:"24hrs"}),a.lastVerifiedAt&&e.jsxs(Z,{variant:"secondary",children:[e.jsx(ve,{className:"h-3 w-3 mr-1"}),"Verified"]}),C&&C.length>0&&e.jsxs(Z,{variant:"outline",children:[e.jsx(oe,{className:"h-3 w-3 mr-1"}),C.length," ",C.length===1?"photo":"photos"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:a.nameZh}),e.jsx("p",{className:"text-sm mb-1",children:a.addressEn}),e.jsxs("div",{className:"flex items-center gap-4 text-sm mt-2",children:[a.phone&&e.jsxs("span",{className:"text-muted-foreground",children:["ðŸ“ž ",a.phone]}),a.latitude&&a.longitude&&e.jsxs("span",{className:"text-muted-foreground flex items-center gap-1",children:[e.jsx(Me,{className:"h-3 w-3"}),Number(a.latitude).toFixed(4),", ",Number(a.longitude).toFixed(4)]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{variant:"outline",size:"sm",onClick:()=>{P(a),xe(null),_.mutate(a.id),E(!0)},"data-testid":`button-generate-code-${a.id}`,title:"Generate Access Code",disabled:_.isPending,children:_.isPending?e.jsx(be,{className:"h-4 w-4 animate-spin"}):e.jsx(Ve,{className:"h-4 w-4"})}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>Ee(a),"data-testid":`button-edit-${a.id}`,children:e.jsx(ts,{className:"h-4 w-4"})}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>Pe(a),"data-testid":`button-delete-${a.id}`,children:e.jsx(rs,{className:"h-4 w-4 text-destructive"})})]})]})},a.id)}),me.length===0&&e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"No hospitals found"})]}),V>1&&e.jsxs("div",{className:"flex justify-center gap-2 mt-6",children:[e.jsx(j,{variant:"outline",size:"sm",onClick:()=>K(a=>Math.max(1,a-1)),disabled:D===1,children:"Previous"}),e.jsxs("span",{className:"flex items-center px-4 text-sm text-muted-foreground",children:["Page ",D," of ",V]}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>K(a=>Math.min(V,a+1)),disabled:D===V,children:"Next"})]})]})]}),e.jsx(Y,{open:n,onOpenChange:g,children:e.jsxs(ee,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(se,{children:[e.jsx(ae,{children:"Add New Hospital"}),e.jsx(ne,{children:"Enter the hospital details including photos and facilities"})]}),e.jsx(Ne,{form:G,onSubmit:De,submitLabel:"Add Hospital"})]})}),e.jsx(Y,{open:y,onOpenChange:f,children:e.jsxs(ee,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(se,{children:[e.jsx(ae,{children:"Edit Hospital"}),e.jsx(ne,{children:"Update the hospital details"})]}),e.jsx(Ne,{form:je,onSubmit:Te,submitLabel:"Save Changes"})]})}),e.jsx(ze,{open:A,onOpenChange:p,children:e.jsxs(Ke,{children:[e.jsxs(Xe,{children:[e.jsx(Qe,{children:"Are you absolutely sure?"}),e.jsxs(Ge,{children:["This will permanently delete ",e.jsx("strong",{children:s==null?void 0:s.nameEn}),". This action cannot be undone."]})]}),e.jsxs(_e,{children:[e.jsx(Je,{children:"Cancel"}),e.jsx(Ye,{onClick:Le,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90","data-testid":"button-confirm-delete",children:"Delete"})]})]})}),e.jsx(Y,{open:N,onOpenChange:E,children:e.jsxs(ee,{className:"max-w-md",children:[e.jsxs(se,{children:[e.jsx(ae,{children:"Generated Code"}),e.jsx(ne,{children:"Share this code with the hospital owner to access their edit link"})]}),O&&w&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Access Code:"}),e.jsx("p",{className:"text-3xl font-mono font-bold text-red-600 dark:text-red-400 text-center tracking-widest",children:O})]}),e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Edit Link:"}),e.jsx("p",{className:"text-sm font-mono break-all text-blue-600 dark:text-blue-400",children:`${window.location.origin}/hospital/edit/${w.id}?code=${O}`})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(j,{variant:"outline",onClick:()=>{navigator.clipboard.writeText(O),b({title:"Code copied to clipboard"})},className:"flex-1","data-testid":"button-copy-code",children:[e.jsx(is,{className:"h-4 w-4 mr-2"}),"Copy Code"]}),e.jsxs(j,{variant:"outline",onClick:()=>{const a=`${window.location.origin}/hospital/edit/${w.id}?code=${O}`;navigator.clipboard.writeText(a),b({title:"Link copied to clipboard"})},className:"flex-1","data-testid":"button-copy-link",children:[e.jsx(cs,{className:"h-4 w-4 mr-2"}),"Copy Link"]})]})]})]})})]})}export{Ls as default};
