import{u as R,r as i,h as K,J as j,j as a,S as Z,_ as $,B as h,L as q,I as U,av as W,a1 as F,a2 as Q,a3 as V,a4 as G,a5 as y,ar as O,as as J,at as _,C as N,q as M,b as H,t as X,M as E,E as Y}from"./index-DwyYRZ5p.js";import{B as o}from"./badge-BMrQ0xDH.js";import{S as k}from"./skeleton-CM7Qf3A_.js";import{A as ee}from"./arrow-left-yEGhOFsb.js";import{B as ae}from"./building-2-BwwPf-yj.js";import{S as se}from"./search-DvVGx0W3.js";import{N as te}from"./navigation-DdTD2RUh.js";import{S as ne}from"./stethoscope-BFZ83afT.js";import{M as L}from"./message-circle-B_AwNgGu.js";function re(f,s,r,g){const x=(r-f)*Math.PI/180,l=(g-s)*Math.PI/180,u=Math.sin(x/2)*Math.sin(x/2)+Math.cos(f*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(l/2)*Math.sin(l/2);return 6371*(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)))}function pe(){const{t:f,language:s}=R(),[r,g]=i.useState(""),[m,x]=i.useState("all"),[l,u]=i.useState("distance"),[d,T]=i.useState(null),[ie,w]=i.useState(null),{data:C,isLoading:A}=K({queryKey:["/api/regions"]}),{data:b,isLoading:P}=K({queryKey:["/api/hospitals"]});i.useEffect(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{T({latitude:e.coords.latitude,longitude:e.coords.longitude}),w(null)},e=>{console.log("Geolocation error:",e.message),w(e.message)}):w("Geolocation not supported")},[]),i.useEffect(()=>{j.event("hospital_list_page_view",{event_category:"Hospital",language:s})},[s]);const z=i.useMemo(()=>b?b.map(e=>{let t;return d&&e.latitude&&e.longitude&&(t=re(d.latitude,d.longitude,parseFloat(e.latitude),parseFloat(e.longitude))),{...e,distance:t}}):[],[b,d]),c=i.useMemo(()=>{let e=z.filter(t=>{var p,S;const n=!r||t.nameEn.toLowerCase().includes(r.toLowerCase())||((p=t.nameZh)==null?void 0:p.includes(r))||t.addressEn.toLowerCase().includes(r.toLowerCase())||((S=t.addressZh)==null?void 0:S.includes(r)),v=m==="all"||t.regionId===m;return n&&v});return l==="distance"&&d?e.sort((t,n)=>t.distance===void 0?1:n.distance===void 0?-1:t.distance-n.distance):l==="name"?e.sort((t,n)=>{const v=s==="zh-HK"?t.nameZh:t.nameEn,p=s==="zh-HK"?n.nameZh:n.nameEn;return v.localeCompare(p)}):l==="newest"&&e.sort((t,n)=>new Date(n.createdAt).getTime()-new Date(t.createdAt).getTime()),e},[z,r,m,l,s,d]),I=e=>{e.phone&&(j.event("hospital_cta_click",{event_category:"Hospital",type:"call",hospital_id:e.id,hospital_slug:e.slug}),window.location.href=`tel:${e.phone}`)},B=e=>{if(e.whatsapp){j.event("hospital_cta_click",{event_category:"Hospital",type:"whatsapp",hospital_id:e.id,hospital_slug:e.slug});const t=e.whatsapp.replace(/[^\d]/g,"");window.open(`https://wa.me/${t}`,"_blank")}},D=e=>{if(j.event("hospital_cta_click",{event_category:"Hospital",type:"maps",hospital_id:e.id,hospital_slug:e.slug}),e.latitude&&e.longitude){const t=`https://www.google.com/maps?q=${e.latitude},${e.longitude}`;window.open(t,"_blank")}else{const t=s==="zh-HK"?e.addressZh:e.addressEn,n=`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(t)}`;window.open(n,"_blank")}};return a.jsxs(a.Fragment,{children:[a.jsx(Z,{title:s==="zh-HK"?"24å°æ™‚å‹•ç‰©é†«é™¢ - PetSOS":"24-Hour Animal Hospitals - PetSOS",description:s==="zh-HK"?"é¦™æ¸¯24å°æ™‚å‹•ç‰©é†«é™¢è©³ç´°è³‡æ–™ï¼ŒåŒ…æ‹¬è¨ºç—‡è²»ç”¨ã€æœå‹™è¨­æ–½ã€ICUã€CTæƒæç­‰è³‡è¨Šã€‚":"Detailed profiles of 24-hour animal hospitals in Hong Kong, including consultation fees, facilities, ICU, CT scan, and more.",canonical:"https://petsos.site/hospitals",language:s}),a.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[a.jsx("div",{className:"sticky top-0 z-10 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"container mx-auto px-4 py-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx($,{href:"/",children:a.jsx(h,{variant:"ghost",size:"icon","data-testid":"button-back",children:a.jsx(ee,{className:"h-5 w-5"})})}),a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2","data-testid":"text-page-title",children:[a.jsx(ae,{className:"h-6 w-6 text-red-500"}),s==="zh-HK"?"24å°æ™‚å‹•ç‰©é†«é™¢":"24-Hour Animal Hospitals"]}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:s==="zh-HK"?"è©³ç´°é†«é™¢è³‡æ–™åŠè¨ºç—‡è²»ç”¨åƒè€ƒ":"Detailed hospital information and consultation fees"})]})]}),a.jsx(q,{})]}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(se,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx(U,{type:"text",placeholder:s==="zh-HK"?"æœå°‹é†«é™¢åç¨±æˆ–åœ°å€...":"Search hospital name or address...",value:r,onChange:e=>g(e.target.value),className:"pl-9 pr-9","data-testid":"input-search"}),r&&a.jsx("button",{onClick:()=>g(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300","data-testid":"button-clear-search",children:a.jsx(W,{className:"h-4 w-4"})})]}),a.jsxs(F,{value:l,onValueChange:u,children:[a.jsx(Q,{className:"w-full md:w-[180px]","data-testid":"select-sort",children:a.jsx(V,{})}),a.jsxs(G,{children:[a.jsx(y,{value:"distance","data-testid":"sort-distance",children:s==="zh-HK"?"è·é›¢":"Distance"}),a.jsx(y,{value:"name","data-testid":"sort-name",children:s==="zh-HK"?"åç¨±":"Name"}),a.jsx(y,{value:"newest","data-testid":"sort-newest",children:s==="zh-HK"?"æœ€æ–°":"Newest"})]})]})]}),a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2 md:gap-4",children:[!A&&C&&a.jsx("div",{className:"overflow-x-auto flex-shrink-0",children:a.jsx(O,{value:m,onValueChange:x,children:a.jsxs(J,{"data-testid":"tabs-region",className:"w-max md:w-auto",children:[a.jsx(_,{value:"all","data-testid":"tab-all",children:s==="zh-HK"?"å…¨éƒ¨":"All"}),C.map(e=>a.jsx(_,{value:e.id,"data-testid":`tab-${e.code}`,children:s==="zh-HK"?e.nameZh:e.nameEn},e.id))]})})}),c&&a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 flex-shrink-0","data-testid":"text-results-count",children:s==="zh-HK"?`é¡¯ç¤º ${c.length} é–“é†«é™¢`:`Showing ${c.length} ${c.length===1?"hospital":"hospitals"}`})]})]})]})}),a.jsx("div",{className:"container mx-auto px-4 py-6",children:P?a.jsx("div",{className:"space-y-4",children:[1,2,3].map(e=>a.jsxs(N,{children:[a.jsxs(M,{children:[a.jsx(k,{className:"h-6 w-3/4"}),a.jsx(k,{className:"h-4 w-1/2"})]}),a.jsx(H,{children:a.jsx(k,{className:"h-20"})})]},e))}):c&&c.length>0?a.jsx("div",{className:"space-y-4",children:c.map(e=>{const t=e.open247,n=t?"hover:shadow-lg transition-shadow border-l-4 border-l-red-500":"hover:shadow-lg transition-shadow border-l-4 border-l-gray-200 dark:border-l-gray-700";return a.jsxs(N,{className:n,"data-testid":`card-hospital-${e.slug}`,children:[a.jsx(M,{children:a.jsx("div",{className:"flex items-start justify-between",children:a.jsxs("div",{className:"flex-1",children:[e.distance!==void 0&&a.jsxs("div",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg font-bold text-lg mb-2 ${t?"bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400":"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400"}`,"data-testid":`text-distance-${e.slug}`,children:[a.jsx(te,{className:"h-5 w-5"}),e.distance.toFixed(1)," km ",s==="zh-HK"?"è·é›¢":"away"]}),e.open247&&a.jsxs(o,{className:"bg-red-600 hover:bg-red-700 text-white font-bold px-3 py-1 text-sm mb-2 animate-pulse","data-testid":`badge-emergency-247-${e.slug}`,children:["ğŸš¨ ",s==="zh-HK"?"24å°æ™‚æ€¥ç—‡":"24/7 EMERGENCY"]}),a.jsx(X,{className:"text-lg font-bold mb-1","data-testid":`text-hospital-name-${e.slug}`,children:s==="zh-HK"?e.nameZh:e.nameEn}),a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400 mb-3",children:[a.jsx(E,{className:"h-4 w-4 flex-shrink-0"}),a.jsx("span",{"data-testid":`text-hospital-address-${e.slug}`,children:s==="zh-HK"?e.addressZh:e.addressEn})]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.isPartner&&a.jsxs(o,{className:"bg-gradient-to-r from-purple-600 to-blue-600 text-white font-semibold","data-testid":`badge-partner-${e.slug}`,children:["â­ ",s==="zh-HK"?"åˆä½œå¤¥ä¼´":"Partner"]}),e.icuLevel&&a.jsxs(o,{variant:"outline",className:"font-medium","data-testid":`badge-icu-${e.slug}`,children:[a.jsx(ne,{className:"h-3 w-3 mr-1"}),"ICU"]}),e.imagingCT&&a.jsx(o,{variant:"outline","data-testid":`badge-ct-${e.slug}`,children:"CT"}),e.whatsappTriage&&a.jsxs(o,{variant:"outline",className:"text-green-600 border-green-600","data-testid":`badge-whatsapp-triage-${e.slug}`,children:[a.jsx(L,{className:"h-3 w-3 mr-1"}),s==="zh-HK"?"WhatsAppåˆ†æµ":"WhatsApp Triage"]}),e.parking&&a.jsx(o,{variant:"outline","data-testid":`badge-parking-${e.slug}`,children:s==="zh-HK"?"åœè»Šå ´":"Parking"}),e.wheelchairAccess&&a.jsx(o,{variant:"outline","data-testid":`badge-wheelchair-${e.slug}`,children:"â™¿"})]})]})})}),a.jsx(H,{children:a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx($,{href:`/hospitals/${e.slug}`,children:a.jsx(h,{variant:"default",size:"sm","data-testid":`button-view-${e.slug}`,children:s==="zh-HK"?"æŸ¥çœ‹è©³æƒ…":"View Details"})}),e.phone&&a.jsxs(h,{variant:"outline",size:"sm",onClick:()=>I(e),"data-testid":`button-call-${e.slug}`,children:[a.jsx(Y,{className:"h-4 w-4 mr-1"}),s==="zh-HK"?"è‡´é›»":"Call"]}),e.whatsapp&&a.jsxs(h,{variant:"outline",size:"sm",onClick:()=>B(e),className:"text-green-600 border-green-600 hover:bg-green-50 dark:hover:bg-green-950","data-testid":`button-whatsapp-${e.slug}`,children:[a.jsx(L,{className:"h-4 w-4 mr-1"}),"WhatsApp"]}),a.jsxs(h,{variant:"outline",size:"sm",onClick:()=>D(e),"data-testid":`button-maps-${e.slug}`,children:[a.jsx(E,{className:"h-4 w-4 mr-1"}),s==="zh-HK"?"åœ°åœ–":"Maps"]})]})})]},e.id)})}):a.jsx(N,{children:a.jsx(H,{className:"py-12 text-center",children:a.jsx("p",{className:"text-gray-500 dark:text-gray-400","data-testid":"text-no-results",children:s==="zh-HK"?"æœªæ‰¾åˆ°ç¬¦åˆæ¢ä»¶çš„é†«é™¢":"No hospitals found matching your criteria"})})})})]})]})}export{pe as default};
